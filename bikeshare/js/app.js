/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/js";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 1);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return indicators; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return color; });\nlet color = {\r\n\t'white': 'white',\r\n\t'black': 'black',\r\n\t'grey': '#d7d7d7',\r\n\t'hot': '#e91e63',\r\n\t'middle': '#90A4AE',\r\n\t'cold':'#455A64'\r\n\t// 'middle': '#c8c8c8',\r\n\t// 'middle': '#969696',\r\n\t// 'cold':'#607d8b'\r\n}\r\nd3.formatDefaultLocale({\r\n  'decimal': ',',\r\n  'thousands': '\\u00a0',\r\n  'grouping': [3],\r\n  'currency': ['', '\\u00a0руб.']\r\n});\r\n\r\nlet indicators = {\r\n\t'sum_all': {\r\n\t\t'title': 'Сумма прибытий и отправлений',\r\n\t\t'format': d3.format('d'),\r\n\t\t'alternative': [\r\n\t\t\t{\r\n\t\t\t\t'key': 'sum_all',\r\n\t\t\t\t'title': 'все дни'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'key': 'sum_workday',\r\n\t\t\t\t'title': 'будни'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'key': 'sum_weekend',\r\n\t\t\t\t'title': 'выходные'\r\n\t\t\t}\r\n\t\t],\r\n\t\t'generate': true\r\n\t},\r\n\t'sum_workday': {\r\n\t\t'title': '..... на буднях',\r\n\t\t'format': d3.format('d')\r\n\t},\r\n\t'sum_weekend': {\r\n\t\t'title': '..... на выходных',\r\n\t\t'format': d3.format('d')\r\n\t},\r\n\t'mean_all_departures': {\r\n\t\t'title': 'Количество отправлений',\r\n\t\t'format': d3.format('d')\r\n\t},\r\n\t'mean_workday_departures': {\r\n\t\t'title': '..... на буднях',\r\n\t\t'format': d3.format('d')\r\n\t},\r\n\t'mean_weekend_departures': {\r\n\t\t'title': '..... на выходных',\r\n\t\t'format': d3.format('d')\r\n\t},\r\n\t'mean_all_returns': {\r\n\t\t'title': 'Количество прибытий',\r\n\t\t'format': d3.format('d')\r\n\t},\r\n\t'mean_workday_returns': {\r\n\t\t'title':  '..... на буднях',\r\n\t\t'format': d3.format('d')\r\n\t},\r\n\t'mean_weekend_returns': {\r\n\t\t'title': '..... на выходных',\r\n\t\t'format': d3.format('d')\r\n\t},\r\n\t'balance_all': {\r\n\t\t'title': 'Баланс прибытий и отправлений',\r\n\t\t'format': d3.format('+d'),\r\n\t\t'legend': ['велосипеды убывают', 'прибывают'],\r\n\t\t'generate': true\r\n\t},\r\n\t'balance_workday': {\r\n\t\t'title': '..... на буднях',\r\n\t\t'format': d3.format('+d')\r\n\t},\r\n\t'balance_weekend': {\r\n\t\t'title': '..... на выходных',\r\n\t\t'format': d3.format('+d')\r\n\t},\r\n\t'mean_all_interval': {\r\n\t\t'title': 'Простой станции без поездок',\r\n\t\t'format': (n) => d3.format('d')(n) + '\\'',\r\n\t\t'legend': ['велосипеды отправляются реже', 'чаще'],\r\n\t\t'generate': true\r\n\t},\r\n\t'mean_workday_interval': {\r\n\t\t'title': '..... на буднях',\r\n\t\t'format': (n) => d3.format('d')(n) + '\\''\r\n\t},\r\n\t'mean_weekend_interval': {\r\n\t\t'title': '..... на выходных',\r\n\t\t'format': (n) => d3.format('d')(n) + '\\''\r\n\t},\r\n\t'subscribers_casual_ratio': {\r\n\t\t'title': 'Casual riders vs subscribers',\r\n\t\t'format': (n) => d3.format('.0%')(n) + ' | ' + d3.format('.0%')(1 - n),\r\n\t\t'legend': ['сезонные абонименты', 'суточные'],\r\n\t\t'generate': true\r\n\t},\r\n\t'workday_weekend_ratio': {\r\n\t\t'title': 'Соотношение выходных к будням',\r\n\t\t'format': (n) => n < 0.5 ? '←' + d3.format('.1f')((1 - n) / n) + 'x' : d3.format('.1f')(n / (1 - n)) + 'x→',\r\n\t\t'legend': ['чаще пользуются на выходных', 'на буднях'],\r\n\t\t'generate': true\r\n\t},\r\n\t'percent_same_return': {\r\n\t\t'title': 'Доля возвратов на ту же станцию',\r\n\t\t'format': d3.format('.1%'),\r\n\t\t'generate': true\r\n\t},\r\n\t'directions_out': {\r\n\t\t'title': 'Количество направлений',\r\n\t\t'format': d3.format('d')\r\n\t},\r\n\t'total_slots': {\r\n\t\t'title': 'Количество слотов',\r\n\t\t'format': d3.format('d'),\r\n\t\t'generate': true\r\n\t},\r\n\t'nearest_3km': {\r\n\t\t'title': 'Станций в радиусе 3 км',\r\n\t\t'format': d3.format('d'),\r\n\t\t'generate': true\r\n\t},\r\n\tget array() {\r\n\t\treturn Object.keys(this).filter(key => key != 'array').map(key => this[key])\r\n\t}\r\n};\r\nObject.keys(indicators).forEach(key => indicators[key].key = key)\r\nObject.keys(indicators).forEach(key => indicators[key].format_short = indicators[key].format)\r\nindicators.subscribers_casual_ratio.format_short = d3.format('.0%')\r\nindicators.workday_weekend_ratio.format_short = (n) => n < 0.5 ? d3.format('.1f')((1 - n) / n) + 'x' : d3.format('.1f')(n / (1 - n)) + 'x'\r\nindicators.array.filter(object => object.generate).forEach(object => {\r\n\tobject.init = function (container) {\r\n\t\treturn container.append('g')\r\n\t\t\t.attr('class', 'bar-container')\r\n\t\t\t.selectAll('g')\r\n\t\t\t.data(this.color.domain.map(n => ({\r\n\t\t\t\t'domain': this.color.domain,\r\n\t\t\t\t'range': this.color.range,\r\n\t\t\t\t'color': this.color.scale,\r\n\t\t\t\t'size': this.color.size\r\n\t\t\t})))\r\n\t\t\t.enter()\r\n\t\t\t.append('g')\r\n\t\t\t.style('transform', (d, i) => `translateX(${i * 4 + 2.5}px)`)\r\n\t}\r\n\tobject.generate = function (container) {\r\n\t\tthis.color.size.range([0, -89]);\r\n\t\treturn this.init(container).append('line')\r\n\t}\r\n\tobject.unfold = function (bars) {\r\n\t\tbars.transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t\t.attr('y2', (d, i) => Math.min(-1, d.size(d.domain[i])))\r\n\t}\r\n\tobject.fold = function (bars) {\r\n\t\tbars.transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t\t.attr('y1', 0)\r\n\t\t\t.attr('y2', -4)\r\n\t\td3.select(bars.node().parentNode.parentNode).transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t\t.style('transform', 'translateY(0)')\r\n\t}\r\n})\r\n\r\nindicators.balance_all.generate = function (container) {\r\n\tthis.color.size.range([0, -44]);\r\n\treturn this.init(container).append('line')\r\n}\r\nindicators.balance_all.unfold = function (bars) {\r\n\td3.select(bars.node().parentNode.parentNode).transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.style('transform', 'translateY(-44px)')\r\n\tbars.transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.attr('y1', (d, i) => {\r\n\t\t\tlet n = d.domain[i];\r\n\t\t\tlet length = d.size(n);\r\n\t\t\treturn n < 0 ? Math.round(length) : 0\r\n\t\t})\r\n\t\t.attr('y2', (d, i) => {\r\n\t\t\tlet n = d.domain[i];\r\n\t\t\tlet length = d.size(n);\r\n\t\t\treturn n > 0 ? Math.round(length) : -1\r\n\t\t})\r\n}\r\n\r\nindicators.workday_weekend_ratio.generate = function (container) {\r\n\tthis.color.size.range([44, -44]).domain([0.25, 0.75]);\r\n\treturn this.init(container).append('line')\r\n}\r\nindicators.workday_weekend_ratio.unfold = function (bars) {\r\n\td3.select(bars.node().parentNode.parentNode).transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.style('transform', 'translateY(-44px)')\r\n\tbars.transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.attr('y1', (d, i) => {\r\n\t\t\tlet n = d.domain[i];\r\n\t\t\tlet length = d.size(n);\r\n\t\t\treturn n < 0 ? Math.round(length) : 0\r\n\t\t})\r\n\t\t.attr('y2', (d, i) => {\r\n\t\t\tlet n = d.domain[i];\r\n\t\t\tlet length = d.size(n);\r\n\t\t\treturn n > 0 ? Math.round(length) : -1\r\n\t\t})\r\n}\r\n\r\nindicators.subscribers_casual_ratio.generate = function (container) {\r\n\tthis.color.size.range([0, -87]).domain([0, 1]);\r\n\tlet parent = this.init(container)\r\n\tparent.append('line');\r\n\tparent.append('line');\r\n\treturn parent;\r\n}\r\nindicators.subscribers_casual_ratio.fold = function (bars) {\r\n\tbars.select(':nth-child(1)').transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.attr('y1', 0)\r\n\t\t.attr('y2', -4)\r\n\t\t.style('stroke', (d, i) => d.range[i])\r\n\r\n\tbars.select(':nth-child(2)').transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.attr('y1', -4)\r\n\t\t.attr('y2', -4)\r\n\t\t.style('stroke', (d, i) => d.range[i])\r\n}\r\nindicators.subscribers_casual_ratio.unfold = function (bars) {\r\n\tbars.select(':nth-child(1)').transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.attr('y2', (d, i) => d.size(d.domain[i]) + 1)\r\n\t\t.style('stroke', color.cold)\r\n\r\n\tbars.select(':nth-child(2)').transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.style('stroke', color.hot)\r\n\t\t.attr('y1', -89)\r\n\t\t.attr('y2', (d, i) => {\r\n\t\t\t// console.log(d.);\r\n\t\t\tlet n = d.domain[i]\r\n\t\t\treturn d.size(n) - 1;\r\n\t\t})\r\n}\r\n\r\nindicators.mean_all_interval.generate = function (container) {\r\n\tthis.color.scale.range(this.color.scale.range().reverse())\r\n\tthis.color.domain.reverse();\r\n\t// this.color.scale.domain(this.color.scale.domain().reverse())\r\n\t// this.color.size.range([0, -87]).domain([0, 1]);\r\n\tlet parent = this.init(container)\r\n\tparent.append('line');\r\n\tparent.append('line');\r\n\treturn parent;\r\n}\r\nindicators.mean_all_interval.fold = function (bars) {\r\n\td3.select(bars.node().parentNode).transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.style('transform', 'translateY(0)')\r\n\tbars.select(':nth-child(1)').transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.attr('y1', 0)\r\n\t\t.attr('y2', -4)\r\n\t\t.style('stroke-dasharray', `1, 0`)\r\n\t\t.style('stroke', (d, i) => d.range[i])\r\n\r\n\tbars.select(':nth-child(2)').transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.attr('y1', -4)\r\n\t\t.attr('y2', -4)\r\n\t\t.style('stroke-dasharray', `1, 0`)\r\n\t\t.style('stroke', (d, i) => d.range[i])\r\n}\r\nindicators.mean_all_interval.unfold = function (bars) {\r\n\td3.select(bars.node().parentNode).transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.style('transform', 'translateY(-44px)')\r\n\tbars.select(':nth-child(1)').transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.attr('y2', -45)\r\n\t\t.style('stroke-dasharray', (d, i) => `1 , ${Math.round(d.domain[i] / 8)}`)\r\n\tbars.select(':nth-child(2)').transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t.attr('y1', -1)\r\n\t\t.attr('y2', 44)\r\n\t\t.style('stroke-dasharray', (d, i) => `1 , ${Math.round(d.domain[i] / 8)}`)\r\n}\r\n\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9nbG9iYWwuanM/ZGNiNyJdLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgY29sb3IgPSB7XHJcblx0J3doaXRlJzogJ3doaXRlJyxcclxuXHQnYmxhY2snOiAnYmxhY2snLFxyXG5cdCdncmV5JzogJyNkN2Q3ZDcnLFxyXG5cdCdob3QnOiAnI2U5MWU2MycsXHJcblx0J21pZGRsZSc6ICcjOTBBNEFFJyxcclxuXHQnY29sZCc6JyM0NTVBNjQnXHJcblx0Ly8gJ21pZGRsZSc6ICcjYzhjOGM4JyxcclxuXHQvLyAnbWlkZGxlJzogJyM5Njk2OTYnLFxyXG5cdC8vICdjb2xkJzonIzYwN2Q4YidcclxufVxyXG5kMy5mb3JtYXREZWZhdWx0TG9jYWxlKHtcclxuICAnZGVjaW1hbCc6ICcsJyxcclxuICAndGhvdXNhbmRzJzogJ1xcdTAwYTAnLFxyXG4gICdncm91cGluZyc6IFszXSxcclxuICAnY3VycmVuY3knOiBbJycsICdcXHUwMGEw0YDRg9CxLiddXHJcbn0pO1xyXG5cclxubGV0IGluZGljYXRvcnMgPSB7XHJcblx0J3N1bV9hbGwnOiB7XHJcblx0XHQndGl0bGUnOiAn0KHRg9C80LzQsCDQv9GA0LjQsdGL0YLQuNC5INC4INC+0YLQv9GA0LDQstC70LXQvdC40LknLFxyXG5cdFx0J2Zvcm1hdCc6IGQzLmZvcm1hdCgnZCcpLFxyXG5cdFx0J2FsdGVybmF0aXZlJzogW1xyXG5cdFx0XHR7XHJcblx0XHRcdFx0J2tleSc6ICdzdW1fYWxsJyxcclxuXHRcdFx0XHQndGl0bGUnOiAn0LLRgdC1INC00L3QuCdcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdCdrZXknOiAnc3VtX3dvcmtkYXknLFxyXG5cdFx0XHRcdCd0aXRsZSc6ICfQsdGD0LTQvdC4J1xyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0J2tleSc6ICdzdW1fd2Vla2VuZCcsXHJcblx0XHRcdFx0J3RpdGxlJzogJ9Cy0YvRhdC+0LTQvdGL0LUnXHJcblx0XHRcdH1cclxuXHRcdF0sXHJcblx0XHQnZ2VuZXJhdGUnOiB0cnVlXHJcblx0fSxcclxuXHQnc3VtX3dvcmtkYXknOiB7XHJcblx0XHQndGl0bGUnOiAnLi4uLi4g0L3QsCDQsdGD0LTQvdGP0YUnLFxyXG5cdFx0J2Zvcm1hdCc6IGQzLmZvcm1hdCgnZCcpXHJcblx0fSxcclxuXHQnc3VtX3dlZWtlbmQnOiB7XHJcblx0XHQndGl0bGUnOiAnLi4uLi4g0L3QsCDQstGL0YXQvtC00L3Ri9GFJyxcclxuXHRcdCdmb3JtYXQnOiBkMy5mb3JtYXQoJ2QnKVxyXG5cdH0sXHJcblx0J21lYW5fYWxsX2RlcGFydHVyZXMnOiB7XHJcblx0XHQndGl0bGUnOiAn0JrQvtC70LjRh9C10YHRgtCy0L4g0L7RgtC/0YDQsNCy0LvQtdC90LjQuScsXHJcblx0XHQnZm9ybWF0JzogZDMuZm9ybWF0KCdkJylcclxuXHR9LFxyXG5cdCdtZWFuX3dvcmtkYXlfZGVwYXJ0dXJlcyc6IHtcclxuXHRcdCd0aXRsZSc6ICcuLi4uLiDQvdCwINCx0YPQtNC90Y/RhScsXHJcblx0XHQnZm9ybWF0JzogZDMuZm9ybWF0KCdkJylcclxuXHR9LFxyXG5cdCdtZWFuX3dlZWtlbmRfZGVwYXJ0dXJlcyc6IHtcclxuXHRcdCd0aXRsZSc6ICcuLi4uLiDQvdCwINCy0YvRhdC+0LTQvdGL0YUnLFxyXG5cdFx0J2Zvcm1hdCc6IGQzLmZvcm1hdCgnZCcpXHJcblx0fSxcclxuXHQnbWVhbl9hbGxfcmV0dXJucyc6IHtcclxuXHRcdCd0aXRsZSc6ICfQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9GA0LjQsdGL0YLQuNC5JyxcclxuXHRcdCdmb3JtYXQnOiBkMy5mb3JtYXQoJ2QnKVxyXG5cdH0sXHJcblx0J21lYW5fd29ya2RheV9yZXR1cm5zJzoge1xyXG5cdFx0J3RpdGxlJzogICcuLi4uLiDQvdCwINCx0YPQtNC90Y/RhScsXHJcblx0XHQnZm9ybWF0JzogZDMuZm9ybWF0KCdkJylcclxuXHR9LFxyXG5cdCdtZWFuX3dlZWtlbmRfcmV0dXJucyc6IHtcclxuXHRcdCd0aXRsZSc6ICcuLi4uLiDQvdCwINCy0YvRhdC+0LTQvdGL0YUnLFxyXG5cdFx0J2Zvcm1hdCc6IGQzLmZvcm1hdCgnZCcpXHJcblx0fSxcclxuXHQnYmFsYW5jZV9hbGwnOiB7XHJcblx0XHQndGl0bGUnOiAn0JHQsNC70LDQvdGBINC/0YDQuNCx0YvRgtC40Lkg0Lgg0L7RgtC/0YDQsNCy0LvQtdC90LjQuScsXHJcblx0XHQnZm9ybWF0JzogZDMuZm9ybWF0KCcrZCcpLFxyXG5cdFx0J2xlZ2VuZCc6IFsn0LLQtdC70L7RgdC40L/QtdC00Ysg0YPQsdGL0LLQsNGO0YInLCAn0L/RgNC40LHRi9Cy0LDRjtGCJ10sXHJcblx0XHQnZ2VuZXJhdGUnOiB0cnVlXHJcblx0fSxcclxuXHQnYmFsYW5jZV93b3JrZGF5Jzoge1xyXG5cdFx0J3RpdGxlJzogJy4uLi4uINC90LAg0LHRg9C00L3Rj9GFJyxcclxuXHRcdCdmb3JtYXQnOiBkMy5mb3JtYXQoJytkJylcclxuXHR9LFxyXG5cdCdiYWxhbmNlX3dlZWtlbmQnOiB7XHJcblx0XHQndGl0bGUnOiAnLi4uLi4g0L3QsCDQstGL0YXQvtC00L3Ri9GFJyxcclxuXHRcdCdmb3JtYXQnOiBkMy5mb3JtYXQoJytkJylcclxuXHR9LFxyXG5cdCdtZWFuX2FsbF9pbnRlcnZhbCc6IHtcclxuXHRcdCd0aXRsZSc6ICfQn9GA0L7RgdGC0L7QuSDRgdGC0LDQvdGG0LjQuCDQsdC10Lcg0L/QvtC10LfQtNC+0LonLFxyXG5cdFx0J2Zvcm1hdCc6IChuKSA9PiBkMy5mb3JtYXQoJ2QnKShuKSArICdcXCcnLFxyXG5cdFx0J2xlZ2VuZCc6IFsn0LLQtdC70L7RgdC40L/QtdC00Ysg0L7RgtC/0YDQsNCy0LvRj9GO0YLRgdGPINGA0LXQttC1JywgJ9GH0LDRidC1J10sXHJcblx0XHQnZ2VuZXJhdGUnOiB0cnVlXHJcblx0fSxcclxuXHQnbWVhbl93b3JrZGF5X2ludGVydmFsJzoge1xyXG5cdFx0J3RpdGxlJzogJy4uLi4uINC90LAg0LHRg9C00L3Rj9GFJyxcclxuXHRcdCdmb3JtYXQnOiAobikgPT4gZDMuZm9ybWF0KCdkJykobikgKyAnXFwnJ1xyXG5cdH0sXHJcblx0J21lYW5fd2Vla2VuZF9pbnRlcnZhbCc6IHtcclxuXHRcdCd0aXRsZSc6ICcuLi4uLiDQvdCwINCy0YvRhdC+0LTQvdGL0YUnLFxyXG5cdFx0J2Zvcm1hdCc6IChuKSA9PiBkMy5mb3JtYXQoJ2QnKShuKSArICdcXCcnXHJcblx0fSxcclxuXHQnc3Vic2NyaWJlcnNfY2FzdWFsX3JhdGlvJzoge1xyXG5cdFx0J3RpdGxlJzogJ0Nhc3VhbCByaWRlcnMgdnMgc3Vic2NyaWJlcnMnLFxyXG5cdFx0J2Zvcm1hdCc6IChuKSA9PiBkMy5mb3JtYXQoJy4wJScpKG4pICsgJyB8ICcgKyBkMy5mb3JtYXQoJy4wJScpKDEgLSBuKSxcclxuXHRcdCdsZWdlbmQnOiBbJ9GB0LXQt9C+0L3QvdGL0LUg0LDQsdC+0L3QuNC80LXQvdGC0YsnLCAn0YHRg9GC0L7Rh9C90YvQtSddLFxyXG5cdFx0J2dlbmVyYXRlJzogdHJ1ZVxyXG5cdH0sXHJcblx0J3dvcmtkYXlfd2Vla2VuZF9yYXRpbyc6IHtcclxuXHRcdCd0aXRsZSc6ICfQodC+0L7RgtC90L7RiNC10L3QuNC1INCy0YvRhdC+0LTQvdGL0YUg0Log0LHRg9C00L3Rj9C8JyxcclxuXHRcdCdmb3JtYXQnOiAobikgPT4gbiA8IDAuNSA/ICfihpAnICsgZDMuZm9ybWF0KCcuMWYnKSgoMSAtIG4pIC8gbikgKyAneCcgOiBkMy5mb3JtYXQoJy4xZicpKG4gLyAoMSAtIG4pKSArICd44oaSJyxcclxuXHRcdCdsZWdlbmQnOiBbJ9GH0LDRidC1INC/0L7Qu9GM0LfRg9GO0YLRgdGPINC90LAg0LLRi9GF0L7QtNC90YvRhScsICfQvdCwINCx0YPQtNC90Y/RhSddLFxyXG5cdFx0J2dlbmVyYXRlJzogdHJ1ZVxyXG5cdH0sXHJcblx0J3BlcmNlbnRfc2FtZV9yZXR1cm4nOiB7XHJcblx0XHQndGl0bGUnOiAn0JTQvtC70Y8g0LLQvtC30LLRgNCw0YLQvtCyINC90LAg0YLRgyDQttC1INGB0YLQsNC90YbQuNGOJyxcclxuXHRcdCdmb3JtYXQnOiBkMy5mb3JtYXQoJy4xJScpLFxyXG5cdFx0J2dlbmVyYXRlJzogdHJ1ZVxyXG5cdH0sXHJcblx0J2RpcmVjdGlvbnNfb3V0Jzoge1xyXG5cdFx0J3RpdGxlJzogJ9Ca0L7Qu9C40YfQtdGB0YLQstC+INC90LDQv9GA0LDQstC70LXQvdC40LknLFxyXG5cdFx0J2Zvcm1hdCc6IGQzLmZvcm1hdCgnZCcpXHJcblx0fSxcclxuXHQndG90YWxfc2xvdHMnOiB7XHJcblx0XHQndGl0bGUnOiAn0JrQvtC70LjRh9C10YHRgtCy0L4g0YHQu9C+0YLQvtCyJyxcclxuXHRcdCdmb3JtYXQnOiBkMy5mb3JtYXQoJ2QnKSxcclxuXHRcdCdnZW5lcmF0ZSc6IHRydWVcclxuXHR9LFxyXG5cdCduZWFyZXN0XzNrbSc6IHtcclxuXHRcdCd0aXRsZSc6ICfQodGC0LDQvdGG0LjQuSDQsiDRgNCw0LTQuNGD0YHQtSAzINC60LwnLFxyXG5cdFx0J2Zvcm1hdCc6IGQzLmZvcm1hdCgnZCcpLFxyXG5cdFx0J2dlbmVyYXRlJzogdHJ1ZVxyXG5cdH0sXHJcblx0Z2V0IGFycmF5KCkge1xyXG5cdFx0cmV0dXJuIE9iamVjdC5rZXlzKHRoaXMpLmZpbHRlcihrZXkgPT4ga2V5ICE9ICdhcnJheScpLm1hcChrZXkgPT4gdGhpc1trZXldKVxyXG5cdH1cclxufTtcclxuT2JqZWN0LmtleXMoaW5kaWNhdG9ycykuZm9yRWFjaChrZXkgPT4gaW5kaWNhdG9yc1trZXldLmtleSA9IGtleSlcclxuT2JqZWN0LmtleXMoaW5kaWNhdG9ycykuZm9yRWFjaChrZXkgPT4gaW5kaWNhdG9yc1trZXldLmZvcm1hdF9zaG9ydCA9IGluZGljYXRvcnNba2V5XS5mb3JtYXQpXHJcbmluZGljYXRvcnMuc3Vic2NyaWJlcnNfY2FzdWFsX3JhdGlvLmZvcm1hdF9zaG9ydCA9IGQzLmZvcm1hdCgnLjAlJylcclxuaW5kaWNhdG9ycy53b3JrZGF5X3dlZWtlbmRfcmF0aW8uZm9ybWF0X3Nob3J0ID0gKG4pID0+IG4gPCAwLjUgPyBkMy5mb3JtYXQoJy4xZicpKCgxIC0gbikgLyBuKSArICd4JyA6IGQzLmZvcm1hdCgnLjFmJykobiAvICgxIC0gbikpICsgJ3gnXHJcbmluZGljYXRvcnMuYXJyYXkuZmlsdGVyKG9iamVjdCA9PiBvYmplY3QuZ2VuZXJhdGUpLmZvckVhY2gob2JqZWN0ID0+IHtcclxuXHRvYmplY3QuaW5pdCA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuXHRcdHJldHVybiBjb250YWluZXIuYXBwZW5kKCdnJylcclxuXHRcdFx0LmF0dHIoJ2NsYXNzJywgJ2Jhci1jb250YWluZXInKVxyXG5cdFx0XHQuc2VsZWN0QWxsKCdnJylcclxuXHRcdFx0LmRhdGEodGhpcy5jb2xvci5kb21haW4ubWFwKG4gPT4gKHtcclxuXHRcdFx0XHQnZG9tYWluJzogdGhpcy5jb2xvci5kb21haW4sXHJcblx0XHRcdFx0J3JhbmdlJzogdGhpcy5jb2xvci5yYW5nZSxcclxuXHRcdFx0XHQnY29sb3InOiB0aGlzLmNvbG9yLnNjYWxlLFxyXG5cdFx0XHRcdCdzaXplJzogdGhpcy5jb2xvci5zaXplXHJcblx0XHRcdH0pKSlcclxuXHRcdFx0LmVudGVyKClcclxuXHRcdFx0LmFwcGVuZCgnZycpXHJcblx0XHRcdC5zdHlsZSgndHJhbnNmb3JtJywgKGQsIGkpID0+IGB0cmFuc2xhdGVYKCR7aSAqIDQgKyAyLjV9cHgpYClcclxuXHR9XHJcblx0b2JqZWN0LmdlbmVyYXRlID0gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xyXG5cdFx0dGhpcy5jb2xvci5zaXplLnJhbmdlKFswLCAtODldKTtcclxuXHRcdHJldHVybiB0aGlzLmluaXQoY29udGFpbmVyKS5hcHBlbmQoJ2xpbmUnKVxyXG5cdH1cclxuXHRvYmplY3QudW5mb2xkID0gZnVuY3Rpb24gKGJhcnMpIHtcclxuXHRcdGJhcnMudHJhbnNpdGlvbigpLmRlbGF5KDEwMCkuZHVyYXRpb24oMjAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxyXG5cdFx0XHQuYXR0cigneTInLCAoZCwgaSkgPT4gTWF0aC5taW4oLTEsIGQuc2l6ZShkLmRvbWFpbltpXSkpKVxyXG5cdH1cclxuXHRvYmplY3QuZm9sZCA9IGZ1bmN0aW9uIChiYXJzKSB7XHJcblx0XHRiYXJzLnRyYW5zaXRpb24oKS5kZWxheSgxMDApLmR1cmF0aW9uKDIwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcclxuXHRcdFx0LmF0dHIoJ3kxJywgMClcclxuXHRcdFx0LmF0dHIoJ3kyJywgLTQpXHJcblx0XHRkMy5zZWxlY3QoYmFycy5ub2RlKCkucGFyZW50Tm9kZS5wYXJlbnROb2RlKS50cmFuc2l0aW9uKCkuZGVsYXkoMTAwKS5kdXJhdGlvbigyMDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHRcdC5zdHlsZSgndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZVkoMCknKVxyXG5cdH1cclxufSlcclxuXHJcbmluZGljYXRvcnMuYmFsYW5jZV9hbGwuZ2VuZXJhdGUgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XHJcblx0dGhpcy5jb2xvci5zaXplLnJhbmdlKFswLCAtNDRdKTtcclxuXHRyZXR1cm4gdGhpcy5pbml0KGNvbnRhaW5lcikuYXBwZW5kKCdsaW5lJylcclxufVxyXG5pbmRpY2F0b3JzLmJhbGFuY2VfYWxsLnVuZm9sZCA9IGZ1bmN0aW9uIChiYXJzKSB7XHJcblx0ZDMuc2VsZWN0KGJhcnMubm9kZSgpLnBhcmVudE5vZGUucGFyZW50Tm9kZSkudHJhbnNpdGlvbigpLmRlbGF5KDEwMCkuZHVyYXRpb24oMjAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxyXG5cdFx0LnN0eWxlKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlWSgtNDRweCknKVxyXG5cdGJhcnMudHJhbnNpdGlvbigpLmRlbGF5KDEwMCkuZHVyYXRpb24oMjAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxyXG5cdFx0LmF0dHIoJ3kxJywgKGQsIGkpID0+IHtcclxuXHRcdFx0bGV0IG4gPSBkLmRvbWFpbltpXTtcclxuXHRcdFx0bGV0IGxlbmd0aCA9IGQuc2l6ZShuKTtcclxuXHRcdFx0cmV0dXJuIG4gPCAwID8gTWF0aC5yb3VuZChsZW5ndGgpIDogMFxyXG5cdFx0fSlcclxuXHRcdC5hdHRyKCd5MicsIChkLCBpKSA9PiB7XHJcblx0XHRcdGxldCBuID0gZC5kb21haW5baV07XHJcblx0XHRcdGxldCBsZW5ndGggPSBkLnNpemUobik7XHJcblx0XHRcdHJldHVybiBuID4gMCA/IE1hdGgucm91bmQobGVuZ3RoKSA6IC0xXHJcblx0XHR9KVxyXG59XHJcblxyXG5pbmRpY2F0b3JzLndvcmtkYXlfd2Vla2VuZF9yYXRpby5nZW5lcmF0ZSA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuXHR0aGlzLmNvbG9yLnNpemUucmFuZ2UoWzQ0LCAtNDRdKS5kb21haW4oWzAuMjUsIDAuNzVdKTtcclxuXHRyZXR1cm4gdGhpcy5pbml0KGNvbnRhaW5lcikuYXBwZW5kKCdsaW5lJylcclxufVxyXG5pbmRpY2F0b3JzLndvcmtkYXlfd2Vla2VuZF9yYXRpby51bmZvbGQgPSBmdW5jdGlvbiAoYmFycykge1xyXG5cdGQzLnNlbGVjdChiYXJzLm5vZGUoKS5wYXJlbnROb2RlLnBhcmVudE5vZGUpLnRyYW5zaXRpb24oKS5kZWxheSgxMDApLmR1cmF0aW9uKDIwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcclxuXHRcdC5zdHlsZSgndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZVkoLTQ0cHgpJylcclxuXHRiYXJzLnRyYW5zaXRpb24oKS5kZWxheSgxMDApLmR1cmF0aW9uKDIwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcclxuXHRcdC5hdHRyKCd5MScsIChkLCBpKSA9PiB7XHJcblx0XHRcdGxldCBuID0gZC5kb21haW5baV07XHJcblx0XHRcdGxldCBsZW5ndGggPSBkLnNpemUobik7XHJcblx0XHRcdHJldHVybiBuIDwgMCA/IE1hdGgucm91bmQobGVuZ3RoKSA6IDBcclxuXHRcdH0pXHJcblx0XHQuYXR0cigneTInLCAoZCwgaSkgPT4ge1xyXG5cdFx0XHRsZXQgbiA9IGQuZG9tYWluW2ldO1xyXG5cdFx0XHRsZXQgbGVuZ3RoID0gZC5zaXplKG4pO1xyXG5cdFx0XHRyZXR1cm4gbiA+IDAgPyBNYXRoLnJvdW5kKGxlbmd0aCkgOiAtMVxyXG5cdFx0fSlcclxufVxyXG5cclxuaW5kaWNhdG9ycy5zdWJzY3JpYmVyc19jYXN1YWxfcmF0aW8uZ2VuZXJhdGUgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XHJcblx0dGhpcy5jb2xvci5zaXplLnJhbmdlKFswLCAtODddKS5kb21haW4oWzAsIDFdKTtcclxuXHRsZXQgcGFyZW50ID0gdGhpcy5pbml0KGNvbnRhaW5lcilcclxuXHRwYXJlbnQuYXBwZW5kKCdsaW5lJyk7XHJcblx0cGFyZW50LmFwcGVuZCgnbGluZScpO1xyXG5cdHJldHVybiBwYXJlbnQ7XHJcbn1cclxuaW5kaWNhdG9ycy5zdWJzY3JpYmVyc19jYXN1YWxfcmF0aW8uZm9sZCA9IGZ1bmN0aW9uIChiYXJzKSB7XHJcblx0YmFycy5zZWxlY3QoJzpudGgtY2hpbGQoMSknKS50cmFuc2l0aW9uKCkuZGVsYXkoMTAwKS5kdXJhdGlvbigyMDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHQuYXR0cigneTEnLCAwKVxyXG5cdFx0LmF0dHIoJ3kyJywgLTQpXHJcblx0XHQuc3R5bGUoJ3N0cm9rZScsIChkLCBpKSA9PiBkLnJhbmdlW2ldKVxyXG5cclxuXHRiYXJzLnNlbGVjdCgnOm50aC1jaGlsZCgyKScpLnRyYW5zaXRpb24oKS5kZWxheSgxMDApLmR1cmF0aW9uKDIwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcclxuXHRcdC5hdHRyKCd5MScsIC00KVxyXG5cdFx0LmF0dHIoJ3kyJywgLTQpXHJcblx0XHQuc3R5bGUoJ3N0cm9rZScsIChkLCBpKSA9PiBkLnJhbmdlW2ldKVxyXG59XHJcbmluZGljYXRvcnMuc3Vic2NyaWJlcnNfY2FzdWFsX3JhdGlvLnVuZm9sZCA9IGZ1bmN0aW9uIChiYXJzKSB7XHJcblx0YmFycy5zZWxlY3QoJzpudGgtY2hpbGQoMSknKS50cmFuc2l0aW9uKCkuZGVsYXkoMTAwKS5kdXJhdGlvbigyMDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHQuYXR0cigneTInLCAoZCwgaSkgPT4gZC5zaXplKGQuZG9tYWluW2ldKSArIDEpXHJcblx0XHQuc3R5bGUoJ3N0cm9rZScsIGNvbG9yLmNvbGQpXHJcblxyXG5cdGJhcnMuc2VsZWN0KCc6bnRoLWNoaWxkKDIpJykudHJhbnNpdGlvbigpLmRlbGF5KDEwMCkuZHVyYXRpb24oMjAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxyXG5cdFx0LnN0eWxlKCdzdHJva2UnLCBjb2xvci5ob3QpXHJcblx0XHQuYXR0cigneTEnLCAtODkpXHJcblx0XHQuYXR0cigneTInLCAoZCwgaSkgPT4ge1xyXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhkLik7XHJcblx0XHRcdGxldCBuID0gZC5kb21haW5baV1cclxuXHRcdFx0cmV0dXJuIGQuc2l6ZShuKSAtIDE7XHJcblx0XHR9KVxyXG59XHJcblxyXG5pbmRpY2F0b3JzLm1lYW5fYWxsX2ludGVydmFsLmdlbmVyYXRlID0gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xyXG5cdHRoaXMuY29sb3Iuc2NhbGUucmFuZ2UodGhpcy5jb2xvci5zY2FsZS5yYW5nZSgpLnJldmVyc2UoKSlcclxuXHR0aGlzLmNvbG9yLmRvbWFpbi5yZXZlcnNlKCk7XHJcblx0Ly8gdGhpcy5jb2xvci5zY2FsZS5kb21haW4odGhpcy5jb2xvci5zY2FsZS5kb21haW4oKS5yZXZlcnNlKCkpXHJcblx0Ly8gdGhpcy5jb2xvci5zaXplLnJhbmdlKFswLCAtODddKS5kb21haW4oWzAsIDFdKTtcclxuXHRsZXQgcGFyZW50ID0gdGhpcy5pbml0KGNvbnRhaW5lcilcclxuXHRwYXJlbnQuYXBwZW5kKCdsaW5lJyk7XHJcblx0cGFyZW50LmFwcGVuZCgnbGluZScpO1xyXG5cdHJldHVybiBwYXJlbnQ7XHJcbn1cclxuaW5kaWNhdG9ycy5tZWFuX2FsbF9pbnRlcnZhbC5mb2xkID0gZnVuY3Rpb24gKGJhcnMpIHtcclxuXHRkMy5zZWxlY3QoYmFycy5ub2RlKCkucGFyZW50Tm9kZSkudHJhbnNpdGlvbigpLmRlbGF5KDEwMCkuZHVyYXRpb24oMjAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxyXG5cdFx0LnN0eWxlKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlWSgwKScpXHJcblx0YmFycy5zZWxlY3QoJzpudGgtY2hpbGQoMSknKS50cmFuc2l0aW9uKCkuZGVsYXkoMTAwKS5kdXJhdGlvbigyMDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHQuYXR0cigneTEnLCAwKVxyXG5cdFx0LmF0dHIoJ3kyJywgLTQpXHJcblx0XHQuc3R5bGUoJ3N0cm9rZS1kYXNoYXJyYXknLCBgMSwgMGApXHJcblx0XHQuc3R5bGUoJ3N0cm9rZScsIChkLCBpKSA9PiBkLnJhbmdlW2ldKVxyXG5cclxuXHRiYXJzLnNlbGVjdCgnOm50aC1jaGlsZCgyKScpLnRyYW5zaXRpb24oKS5kZWxheSgxMDApLmR1cmF0aW9uKDIwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcclxuXHRcdC5hdHRyKCd5MScsIC00KVxyXG5cdFx0LmF0dHIoJ3kyJywgLTQpXHJcblx0XHQuc3R5bGUoJ3N0cm9rZS1kYXNoYXJyYXknLCBgMSwgMGApXHJcblx0XHQuc3R5bGUoJ3N0cm9rZScsIChkLCBpKSA9PiBkLnJhbmdlW2ldKVxyXG59XHJcbmluZGljYXRvcnMubWVhbl9hbGxfaW50ZXJ2YWwudW5mb2xkID0gZnVuY3Rpb24gKGJhcnMpIHtcclxuXHRkMy5zZWxlY3QoYmFycy5ub2RlKCkucGFyZW50Tm9kZSkudHJhbnNpdGlvbigpLmRlbGF5KDEwMCkuZHVyYXRpb24oMjAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxyXG5cdFx0LnN0eWxlKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlWSgtNDRweCknKVxyXG5cdGJhcnMuc2VsZWN0KCc6bnRoLWNoaWxkKDEpJykudHJhbnNpdGlvbigpLmRlbGF5KDEwMCkuZHVyYXRpb24oMjAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxyXG5cdFx0LmF0dHIoJ3kyJywgLTQ1KVxyXG5cdFx0LnN0eWxlKCdzdHJva2UtZGFzaGFycmF5JywgKGQsIGkpID0+IGAxICwgJHtNYXRoLnJvdW5kKGQuZG9tYWluW2ldIC8gOCl9YClcclxuXHRiYXJzLnNlbGVjdCgnOm50aC1jaGlsZCgyKScpLnRyYW5zaXRpb24oKS5kZWxheSgxMDApLmR1cmF0aW9uKDIwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcclxuXHRcdC5hdHRyKCd5MScsIC0xKVxyXG5cdFx0LmF0dHIoJ3kyJywgNDQpXHJcblx0XHQuc3R5bGUoJ3N0cm9rZS1kYXNoYXJyYXknLCAoZCwgaSkgPT4gYDEgLCAke01hdGgucm91bmQoZC5kb21haW5baV0gLyA4KX1gKVxyXG59XHJcbmV4cG9ydCB7IGluZGljYXRvcnMsIGNvbG9yIH07XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2dsb2JhbC5qc1xuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///0\n");

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(2);
(function webpackMissingModule() { throw new Error("Cannot find module \"./index.js\""); }());
(function webpackMissingModule() { throw new Error("Cannot find module \"bundle.js\""); }());


/***/ }),
/* 2 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("Object.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__global__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__elements__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__controller__ = __webpack_require__(4);\n\n\n\n\n\n\nd3.queue()\n\t.defer(d3.json, 'data/stations.geojson')\n\t.defer(d3.xml, 'data/map.svg')\n\t.defer(d3.json, 'data/routes.topojson')\n\t.await(function(error, ...incoming) {\n\t\tif (error) throw error;\n\t\t//Map initialization\n\t\tlet map = new __WEBPACK_IMPORTED_MODULE_1__elements__[\"b\" /* Map */](incoming[1]);\n\t\tconst projection = d3.geoMercator()\n\t\t\t.center([37.470245, 55.85831])\n\t\t\t.scale((512) * 0.5 / Math.PI * Math.pow(2, map.basemap.getZoom()))\n\t\t\t.translate([0, 0])\n\t\tconst geoPath = d3.geoPath().projection(projection);\n\n\t\t//Editing data\n\t\tlet data = incoming[0];\n\t\t// let routes = turf.featureCollection(Object.keys(incoming[2].objects).map(key => {\n\t\t// \treturn topojson.feature(incoming[2], incoming[2].objects[key])\n\t\t// }));\n\t\t// console.log(routes);\n\t\tdata.attributes = new Object();\n\t\tdata.features.forEach(feature => {\n\t\t\tfeature.attributes = new Object();\n\t\t\tfeature.attributes.circle_coordinates = projection(feature.geometry.coordinates);\n\t\t\tfeature.properties.trips.forEach(year => {\n\t\t\t\tyear.forEach((trip, i) => {\n\t\t\t\t\tyear[i] = turf.lineString(\n\t\t\t\t\t\ttopojson.feature(incoming[2], incoming[2].objects[trip.id]).geometry.coordinates,\n\t\t\t\t\t\ttrip\n\t\t\t\t\t);\n\t\t\t\t})\n\t\t\t})\n\t\t});\n\n\t\t//Setting margins\n\t\t['balance_all', 'balance_workday', 'balance_weekend'].forEach(key => {\n\t\t\tlet margin = d3.max([\n\t\t\t\tMath.abs(data.properties.balance_all.max_abs), Math.abs(data.properties.balance_all.min_abs),\n\t\t\t\tMath.abs(data.properties.balance_workday.max_abs), Math.abs(data.properties.balance_workday.min_abs),\n\t\t\t\tMath.abs(data.properties.balance_weekend.max_abs), Math.abs(data.properties.balance_weekend.min_abs)\n\t\t\t]);\n\t\t\tdata.properties[key].min_abs = -margin;\n\t\t\tdata.properties[key].max_abs = margin;\n\t\t});\n\n\t\t[\n\t\t\t'subscribers_casual_ratio',\n\t\t\t'workday_weekend_ratio', 'percent_same_return'\n\t\t].forEach(key => {\n\t\t\tdata.properties[key].min_abs = 0;\n\t\t\tdata.properties[key].max_abs = 1;\n\t\t});\n\t\t[\n\t\t\t'sum_all', 'sum_workday', 'sum_weekend'\n\t\t\t// 'mean_all_departures', 'mean_workday_departures', 'mean_weekend_departures',\n\t\t\t// 'mean_all_returns', 'mean_workday_returns', 'mean_weekend_returns'\n\t\t].forEach((key, i, a) => {\n\t\t\tdata.properties[key].min_abs = 0;\n\t\t\tdata.properties[key].max_abs = d3.max(a.map(key => d3.max(data.properties[key].max)));\n\t\t});\n\t\t['mean_all_departures', 'mean_workday_departures', 'mean_weekend_departures'].forEach((key, i, a) => {\n\t\t\tdata.properties[key].min_abs = 0;\n\t\t\tdata.properties[key].max_abs = d3.max(a.map(key => d3.max(data.properties[key].max)));\n\t\t});\n\t\t['mean_all_returns', 'mean_workday_returns', 'mean_weekend_returns'].forEach((key, i, a) => {\n\t\t\tdata.properties[key].min_abs = 0;\n\t\t\tdata.properties[key].max_abs = d3.max(a.map(key => d3.max(data.properties[key].max)));\n\t\t});\n\t\t['mean_all_interval', 'mean_all_interval', 'mean_all_interval'].forEach((key, i, a) => {\n\t\t\tdata.properties[key].min_abs = 0;\n\t\t\tdata.properties[key].max_abs = d3.max(a.map(key => d3.max(data.properties[key].max)));\n\t\t});\n\t\t['total_slots', 'nearest_3km'].forEach(key => {\n\t\t\tdata.properties[key].min_abs = 0;\n\t\t});\n\n\t\t//Scales\n\t\tlet global = {\n\t\t\t'i': 2,\n\t\t\t'z': map.basemap.getZoom(),\n\t\t\t'key': 'sum_all',\n\t\t\t'x': 'nearest_3km',\n\t\t\t'y': 'sum_all',\n\t\t\tget year() {\n\t\t\t\treturn this.i + 2014;\n\t\t\t}\n\t\t}\n\n\t\t//Update initialization\n\t\tlet controller = new __WEBPACK_IMPORTED_MODULE_2__controller__[\"a\" /* default */](data, global);\n\n\t\t//Elements initialization\n\t\tlet elements = new __WEBPACK_IMPORTED_MODULE_1__elements__[\"a\" /* Elements */](data, global, map, geoPath);\n\n\t\tmap.moveMap();\n\t\tredrawMapZones(controller.unfilter());\n\n\t\t//-------------------\n\t\t//-------Chart-------\n\t\t//-------------------\n\t\telements.chart_selectors.selectAll('option')\n\t\t\t.property('selected', function (d) {\n\t\t\t\treturn global[this.parentNode.name.split('-')[0]] === this.value\n\t\t})\n\t\telements.chart_selectors.on('change', function (d) {\n\t\t\tglobal[d] = this.value;\n\t\t\tcontroller.evaluateChartElements(d);\n\t\t\telements.redrawChartElements();\n\t\t})\n\t\telements.chart.on('mouseover', () => {\n\t\t\telements.chart_background.style('opacity', 1);\n\t\t\telements.chart_area.style('opacity', 1);\n\t\t}).on('mouseleave', (d) => {\n\t\t\tif(!d.pinned) {\n\t\t\t\telements.chart_background.style('opacity', 0);\n\t\t\t\telements.chart_area.style('opacity', 0);\n\t\t\t\tredrawMapZones(controller.unfilter());\n\t\t\t\telements.chartFilter();\n\t\t\t\telements.chart_labels.style('opacity', 0);\n\t\t\t}\n\t\t}).on('mousemove', (d) => {\n\t\t\tif(!d.pinned) {\n\t\t\t\tlet coordinates = new Object();\n\t\t\t\tif(d3.event.offsetX >= 0) {\n\t\t\t\t\tcoordinates.x = d3.event.offsetX\n\t\t\t\t}\n\t\t\t\tif(d3.event.offsetY <= 256) {\n\t\t\t\t\tcoordinates.y = d3.event.offsetY\n\t\t\t\t}\n\t\t\t\tredrawMapZones(\n\t\t\t\t\tcontroller.modifyChartElements(coordinates)\n\t\t\t\t);\n\t\t\t\telements.chartFilter();\n\t\t\t}\n\t\t}).on('click', (d) => {\n\t\t\td.pinned = !d.pinned;\n\t\t\tif(!d.pinned) {\n\t\t\t\tlet coordinates = new Object();\n\t\t\t\tif(d3.event.offsetX >= 0) {\n\t\t\t\t\tcoordinates.x = d3.event.offsetX\n\t\t\t\t}\n\t\t\t\tif(d3.event.offsetY <= 256) {\n\t\t\t\t\tcoordinates.y = d3.event.offsetY\n\t\t\t\t}\n\t\t\t\tredrawMapZones(\n\t\t\t\t\tcontroller.modifyChartElements(coordinates)\n\t\t\t\t);\n\t\t\t\telements.chartFilter();\n\t\t\t}\n\t\t})\n\t\td3.select('input')\n\t\t\t.classed('checked', true)\n\t\t\t.property('checked', true)\n\t\t\t.each(d => d.unfold());\n\t\td3.selectAll('input').on('change', function (d, i) {\n\t\t\td3.selectAll('.checked').each(d => d.fold());\n\t\t\td3.selectAll('input:checked').each(d => d.unfold());\n\t\t\tglobal.key = this.value;\n\t\t\tcontroller.evaluateMapElements();\n\t\t\tcontroller.evaluateChartElements();\n\t\t\telements.redrawMapElements();\n\t\t\telements.redrawChartElements();\n\t\t})\n\n\t\td3.selectAll('label').on('mousemove', function () {\n\t\t\t// console.log(d3.event.path);\n\t\t\tlet shift = d3.event.target.tagName == 'LABEL' ? 16 : 0\n\t\t\tlet n = Math.max(0, Math.min(63, Math.round((d3.event.offsetX - 2 - shift) / 4)))\n\t\t\tlet key;\n\t\t\tlet bottom = n - 4;\n\t\t\tlet top = n + 4;\n\t\t\tif(bottom < 0) {\n\t\t\t\ttop -= bottom\n\t\t\t\tbottom = 0;\n\t\t\t}\n\t\t\tif(top > 63) {\n\t\t\t\tbottom -= (top - 63)\n\t\t\t\ttop = 63;\n\t\t\t}\n\t\t\td3.select(this).select('.bar-container').selectAll('text')\n\t\t\t\t.text(d => d.indicator.format(d.indicator.color.domain[n]))\n\t\t\t\t.attr('x', n * 4 + 3)\n\t\t\td3.select(this).select('.bar-container').select('text')\n\t\t\t\t.each(d => {\n\t\t\t\t\tkey = d.key\n\t\t\t\t\tbottom = d.indicator.color.domain[bottom];\n\t\t\t\t\ttop = d.indicator.color.domain[top];\n\t\t\t\t})\n\t\t\t// redrawMapZones(\n\t\t\t// \tcontroller.filter(\n\t\t\t// \t\tfeature => feature.attributes.visible &&\n\t\t\t// \t\tfeature.properties[key][global.i] >= bottom &&\n\t\t\t// \t\tfeature.properties[key][global.i] <= top\n\t\t\t// \t)\n\t\t\t// );\n\t\t\t// elements.chart_dots.classed('filtred', d => d.attributes.filtred)\n\t\t\t// elements.chart_crowns.classed('filtred', d => d.attributes.filtred)\n\t\t\t// elements.circles.classed('filtred', d => d.attributes.filtred)\n\t\t})\n\t\td3.selectAll('label').on('mouseleave', function () {\n\t\t\td3.select(this).select('.bar-container').selectAll('text')\n\t\t\t\t.transition().duration(300).ease(d3.easeQuadOut)\n\t\t\t\t.style('opacity', 0)\n\t\t\t\t// .attr('x', 128)\n\t\t\t\t// .text(d => d.indicator.format(d.indicator.color.median))\n\t\t\t\t// redrawMapZones(controller.unfilter());\n\t\t\t\t// elements.chart_dots.classed('filtred', false);\n\t\t\t\t// elements.chart_crowns.classed('filtred', false);\n\t\t\t\t// elements.circles.classed('filtred', false);\n\t\t\t\t// destinations = d3.range(0, data.features.length, 1);\n\t\t})\n\t\td3.selectAll('label').on('mouseenter', function () {\n\t\t\td3.select(this).select('.bar-container').selectAll('text')\n\t\t\t\t.transition().duration(300).ease(d3.easeQuadOut)\n\t\t\t\t.style('opacity', 1)\n\t\t})\n\t\t// console.log();\n\t\t/*\n\t\telements.layer.append('g')\n\t\t\t.selectAll('path')\n\t\t\t.data(turf.voronoi(data, {\n\t\t\t  bbox: [37.470245, 55.629062, 37.717931, 55.85831]\n\t\t\t}).features)\n\t\t\t.enter()\n\t\t\t.append('path')\n\t\t\t.attr('d', geoPath)\n\t\t\t.style('opacity', 0)\n\t\t\t// .style('fill', 'rgba(0, 0, 0, 0.1)')\n\t\t\t// .style('stroke', 'black')\n\t\t\t.on('mouseover', function (d, i) {\n\t\t\t// let a = d.properties.directions[global.i].reduce((prev, route) => {\n\t\t\t// \treturn prev.concat(routes.objects[route].arcs.map(id => id < 0 ? -id - 1 : id))\n\t\t\t// }, new Array()).unique();\n\t\t\t// console.log(a);\n\t\t\t// elements.routes.classed('filtred', d => a.every(n => d.properties.id != n))\n\t\t\t// d3.selectAll('.routes').remove();\n\t\t\tlet left = data.features[i].properties.directions[global.i].map(id => turf.lineOffset(turf.lineString(incoming[3].features[id].geometry.coordinates, {'side': true}), 0.02))\n\t\t\tlet right = data.features[i].properties.directions[global.i].map(id => turf.lineOffset(turf.lineString(incoming[3].features[id].geometry.coordinates, {'side': false}), -0.02))\n\t\t\tleft.forEach(feature => {\n\t\t\t\tfeature.properties.left = true;\n\t\t\t})\n\t\t\tright.forEach(feature => {\n\t\t\t\tfeature.properties.right = true;\n\t\t\t})\n\t\t\t// console.log(income);\n\t\t\td3.select('#basemap').on('mousemove', function () {\n\t\t\t\tconsole.log(d3.event);\n\t\t\t})\n\t\t\tlet paths = elements.routes\n\t\t\t\t.selectAll(null)\n\t\t\t\t.data(data.features[i].properties.directions[global.i].map(id => incoming[3].features[id]))\n\t\t\t\t.enter()\n\t\t\t\t.append('path')\n\t\t\t\t.attr('d', geoPath)\n\t\t\t\t.each(function (d) {\n\t\t\t\t\td.properties.length = this.getTotalLength();\n\t\t\t\t})\n\t\t\t\t.attr('class', 'routes')\n\t\t\t\t// .style('stroke', d => d.properties.side ? color.hot : color.cold)\n\t\t\t\t.style('fill', 'none')\n\t\t\t\t.style('stroke-dasharray', d => d.properties.length)\n\t\t\t\t.style('stroke-dashoffset', d => d.properties.length);\n\t\t\tpaths.transition().duration(d => d.properties.length * 5).ease(d3.easeQuadOut)\n\t\t\t\t.style('stroke-dashoffset', 0)\n\t\t\td3.select(this).on('mouseleave', function () {\n\t\t\t\tpaths.transition().delay(1000).duration(d => d.properties.length * 5).ease(d3.easeQuadOut)\n\t\t\t\t\t.style('stroke-dashoffset', d => d.properties.length)\n\t\t\t\t\t.on('end', function () {\n\t\t\t\t\t\td3.select(this).remove();\n\t\t\t\t\t})\n\t\t\t})\n\t\t})\n\t\t*/\n\t\t/*\n\t\telements.circles.on('mouseover', function (d) {\n\t\t\tObject.keys(d.attributes.circle_indicators).forEach(key => {\n\t\t\t\tlet n = d.attributes.circle_indicators[key].n;\n\t\t\t\tlet value = d.attributes.circle_indicators[key].value;\n\t\t\t\td3.select('[for=\"select_' + key + '\"]').select('.bar-container').selectAll('text')\n\t\t\t\t\t\t.text(d => d.indicator.format(value))\n\t\t\t\t\t\t.transition().duration(300).ease(d3.easeQuadOut)\n\t\t\t\t\t\t.attr('x', n * 4 + 3)\n\t\t\t\t\t\t.style('opacity', 1)\n\t\t\t})\n\t\t\telements.buttons.text((n, i) => indicators[global.key].format_short(d.properties[global.key][i]))\n\t\t})\n\t\telements.circles.on('mouseleave', function (d) {\n\t\t\tObject.keys(d.attributes.circle_indicators).forEach(key => {\n\t\t\t\td3.select('[for=\"select_' + key + '\"]').select('.bar-container').selectAll('text')\n\t\t\t\t\t\t.transition().delay(1000).duration(300).ease(d3.easeQuadOut)\n\t\t\t\t\t\t// .attr('x', n * 4 + 3)\n\t\t\t\t\t\t.style('opacity', 0)\n\t\t\t})\n\t\t\tsetTimeout(function () {\n\t\t\t\telements.buttons.transition().delay(1000).duration(300).ease(d3.easeQuadOut)\n\t\t\t\t.text((n, i) => indicators[global.key].format_short(data.properties[global.key].median[i]))\n\t\t\t}, 1000)\n\t\t})\n\t\t*/\n\t\tlet pinned = false;\n\t\tlet destinations = d3.range(0, data.features.length, 1);\n\t\tmap.basemap.on('mousemove', function (event) {\n\t\t\tif(!pinned) {\n\t\t\t\tlet center = turf.point(event.lngLat.toArray());\n\t\t\t\telements.routes\n\t\t\t\t\t//.filter((d, i) => destinations.some(id => id == i))\n\t\t\t\t\t.each(function (feature) {\n\t\t\t\t\tfeature.attributes.distance = turf.distance(center, feature);\n\t\t\t\t\tlet b = feature.attributes.distance < 1;\n\t\t\t\t\tif(!feature.attributes.unfolded && b) feature.attributes.paths = unfold(this);\n\t\t\t\t\tif(feature.attributes.unfolded && !b) fold(this);\n\t\t\t\t\tfeature.attributes.unfolded = b;\n\t\t\t\t\tfunction unfold(node) {\n\t\t\t\t\t\tlet paths = d3.select(node).selectAll(null)\n\t\t\t\t\t\t.style('stroke-width', data.attributes.zoom * 1)\n\t\t\t\t\t\t.data(feature.properties.trips[global.i])\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append('path')\n\t\t\t\t\t\t.attr('d', geoPath)\n\t\t\t\t\t\t.each(function (d) {\n\t\t\t\t\t\t\td.properties.length = this.getTotalLength();\n\t\t\t\t\t\t}).attr('class', 'route')\n\t\t\t\t\t\t.style('stroke-dasharray', d => d.properties.length)\n\t\t\t\t\t\t.style('stroke-dashoffset', d => d.properties.length)\n\t\t\t\t\t\t.style('opacity', d => Math.min(1, d.properties.trips_sum / 2500));\n\n\t\t\t\t\t\tpaths.transition().duration(d => d.properties.length * 5).ease(d3.easeQuadOut)\n\t\t\t\t\t\t.style('stroke-dashoffset', 0)\n\t\t\t\t\t\treturn paths;\n\t\t\t\t\t}\n\t\t\t\t\tfunction fold(node) {\n\t\t\t\t\t\tfeature.attributes.paths.transition().duration(d => d.properties.length * 5).ease(d3.easeQuadOut)\n\t\t\t\t\t\t.style('stroke-dashoffset', d => d.properties.length)\n\t\t\t\t\t\t.on('end', function () {\n\t\t\t\t\t\t\td3.select(this).remove();\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t\telements.circles.on('click', function (feature, i) {\n\t\t\tif(!pinned) {\n\t\t\t\telements.routes\n\t\t\t\t\t.filter((d, j) => j != i)\n\t\t\t\t\t.selectAll('.route')\n\t\t\t\t\t.transition().duration(500).ease(d3.easeQuadOut)\n\t\t\t\t\t.style('opacity', 0)\n\t\t\t\t\t.on('end', function () {\n\t\t\t\t\t\td3.select(this).remove();\n\t\t\t\t\t})\n\t\t\t\tdestinations = new Array();\n\t\t\t\tfeature.attributes.paths\n\t\t\t\t\t.each(d => destinations.push(d.properties.out))\n\t\t\t\t\t.on('click', d => console.log(d.properties))\n\t\t\t\t\t.transition().duration(500).ease(d3.easeQuadOut)\n\t\t\t\t\t.style('stroke', __WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].hot)\n\t\t\t\t\t.style('opacity', 1)\n\n\t\t\t\tlet node = feature.attributes.paths.node().parentNode;\n\t\t\t\tnode.parentNode.appendChild(node);\n\t\t\t\tlet a = destinations.concat([feature.properties.id]);\n\t\t\t\telements.circles\n\t\t\t\t\t.filter((d, i) => a.some(id => id == i))\n\t\t\t\t\t.each(function () {\n\t\t\t\t\t\tthis.parentNode.appendChild(this)\n\t\t\t\t\t})\n\t\t\t\tredrawMapZones(\n\t\t\t\t\tcontroller.filter(\n\t\t\t\t\t\tfeature => a.some(id => id == feature.properties.id)\n\t\t\t\t\t),\n\t\t\t\t\tfeature.properties.trips[global.i]\n\t\t\t\t);\n\t\t\t\telements.chart_dots.classed('filtred', d => d.attributes.filtred)\n\t\t\t\telements.chart_crowns.classed('filtred', d => d.attributes.filtred)\n\t\t\t\telements.circles.classed('filtred', d => d.attributes.filtred)\n\t\t\t\t// elements.circles.classed('filtred-radius', d => d.attributes.filtred)\n\t\t\t}\telse {\n\t\t\t\tredrawMapZones(controller.unfilter());\n\t\t\t\telements.chart_dots.classed('filtred', false);\n\t\t\t\telements.chart_crowns.classed('filtred', false);\n\t\t\t\telements.circles.classed('filtred', false);\n\t\t\t\tdestinations = d3.range(0, data.features.length, 1);\n\t\t\t}\n\t\t\tpinned = !pinned;\n\t\t})\n\n\t\td3.select('#overlay').on('click', function () {\n\t\t\tif(pinned) {\n\t\t\t\tredrawMapZones(controller.unfilter());\n\t\t\t\telements.chart_dots.classed('filtred', false);\n\t\t\t\telements.chart_crowns.classed('filtred', false);\n\t\t\t\telements.circles.classed('filtred', false);\n\t\t\t\tdestinations = d3.range(0, data.features.length, 1);\n\t\t\t\tpinned = false;\n\t\t\t}\n\t\t})\n\n\t\td3.select('#timeline-container').selectAll('button').on('click', function () {\n\t\t\tglobal.i = parseInt(this.name) - 2014;\n\t\t\tcontroller.initialization();\n\t\t\telements.initialization();\n\t\t\tredrawMapZones(controller.unfilter());\n\t\t\td3.select('button:disabled').node().disabled = false;\n\t\t\td3.selectAll('input:checked').each(d => d.unfold());\n\t\t\tthis.disabled = true;\n\t\t})\n\t\td3.select('#main-container').node().addEventListener('scroll', function() {\n\t\t\td3.select('#timeline-container').classed('extended', this.scrollHeight - this.clientHeight == this.scrollTop)\n\t\t});\n\n\t\t//------------------\n\t\t//-------Zoom-------\n\t\t//------------------\n\t\tlet delayedId;\n\t\td3.select('div#basemap').on('mousewheel', event => {\n\t\t\tglobal.z = Math.max(10.5, Math.min(16.5, global.z - d3.event.deltaY / 100));\n\t\t\tdelayedId = Math.random();\n\t\t\tif(global.z == 10.5) {\n\t\t\t\tmap.basemap.easeTo({\n\t\t\t\t\tzoom: global.z,\n\t\t\t\t\teasing: d3.easeQuadOut\n\t\t\t\t});\n\t\t\t}\telse {\n\t\t\t\tmap.basemap.easeTo({\n\t\t\t\t\teasing: d3.easeQuadOut,\n\t\t\t\t\tduration: 300,\n\t\t\t\t\tcenter: [map.basemap.mouse.lng, map.basemap.mouse.lat],\n\t\t\t\t\tzoom: global.z\n\t\t\t\t});\n\t\t\t}\n\t\t\tlet temp = delayedId;\n\t\t\tsetTimeout(() => {\n\t\t\t\tif(delayedId == temp) {\n\t\t\t\t\tcontroller.evaluateMapElements();\n\t\t\t\t\telements.redrawMapElements();\n\t\t\t\t\tconsole.log(global.z);\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t})\n\n\t\tfunction redrawMapZones(features, lines = new Array()) {\n\t\t\tlet clusteredPoints = turf.clustersDbscan(\n\t\t\t\tturf.featureCollection(features.map(feature => turf.point(feature.geometry.coordinates))),\n\t\t\t\t1.5,\n\t\t\t\t{ minPoints: 1 }\n\t\t\t)\n\t\t\tlet clusters = new Array();\n\t\t\tclusteredPoints.features.forEach(station => {\n\t\t\t\tlet cluster = station.properties.cluster;\n\t\t\t\tclusters[cluster] ? clusters[cluster].push(station) : clusters[cluster] = [station];\n\t\t\t})\n\t\t\tlet coverage_area = new Array();\n\t\t\tlet coverage_line = new Array();\n\t\t\tlet coverage_point = new Array();\n\t\t\tclusters.forEach(cluster => {\n\t\t\t\tlet points = turf.featureCollection(\n\t\t\t\t\tcluster.map(station => turf.point(station.geometry.coordinates))\n\t\t\t\t);\n\t\t\t\tif(points.features.length > 2) {\n\t\t\t\t\tcoverage_area.push(turf.concave(points, {'maxEdge': 2}))\n\t\t\t\t\t// coverage_area.push(turf.convex(points, {'concavity': 2}))\n\t\t\t\t}\telse if(points.features.length == 2) {\n\t\t\t\t\tcoverage_line.push(turf.lineString(\n\t\t\t\t\t\tpoints.features.map(point => point.geometry.coordinates)\n\t\t\t\t\t));\n\t\t\t\t}\telse {\n\t\t\t\t\tcoverage_point.push(points.features[0]);\n\t\t\t\t}\n\t\t\t})\n\t\t\tcoverage_area = coverage_area.concat(coverage_line).concat(lines).concat(coverage_point).map(feature => {\n\t\t\t\tif(feature) {\n\t\t\t\t\tlet buffer = turf.buffer(feature, 0.8, {steps: 0});\n\t\t\t\t\treturn buffer;\n\t\t\t\t}\telse {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t});\n\t\t\tcoverage_area = coverage_area.filter(feature => feature);\n\t\t\telements.zones.selectAll('path').remove()\n\t\t\telements.zones.selectAll('path')\n\t\t\t\t.data(coverage_area)\n\t\t\t\t.enter()\n\t\t\t\t.append('path')\n\t\t\t\t.attr('class', 'coverage')\n\t\t\t\t.attr('d', d => geoPath(d).split('Z')[0] + 'Z')\n\t\t\t\t.style('opacity', 1)\n\t\t}\n\n\t\t//Print Some Values\n\t\t// console.log('{' + Object.keys(data.features[0].properties).join(\n\t\t// \t`','title': ''},{'key': '`\n\t\t// ) + '}');\n})\n\nArray.prototype.unique = function() {\n    var a = [];\n    for (let i = 0; i < this.length; i++ ) {\n        var current = this[i];\n        if (a.indexOf(current) < 0) a.push(current);\n    }\n    return a;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9pbmRleC5qcz85NTUyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluZGljYXRvcnMsIGNvbG9yIH0gZnJvbSAnLi9nbG9iYWwnO1xuaW1wb3J0IHsgTWFwLCBFbGVtZW50cyB9IGZyb20gJy4vZWxlbWVudHMnO1xuaW1wb3J0IENvbnRyb2xsZXIgZnJvbSAnLi9jb250cm9sbGVyJztcblxuXG5cbmQzLnF1ZXVlKClcblx0LmRlZmVyKGQzLmpzb24sICdkYXRhL3N0YXRpb25zLmdlb2pzb24nKVxuXHQuZGVmZXIoZDMueG1sLCAnZGF0YS9tYXAuc3ZnJylcblx0LmRlZmVyKGQzLmpzb24sICdkYXRhL3JvdXRlcy50b3BvanNvbicpXG5cdC5hd2FpdChmdW5jdGlvbihlcnJvciwgLi4uaW5jb21pbmcpIHtcblx0XHRpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuXHRcdC8vTWFwIGluaXRpYWxpemF0aW9uXG5cdFx0bGV0IG1hcCA9IG5ldyBNYXAoaW5jb21pbmdbMV0pO1xuXHRcdGNvbnN0IHByb2plY3Rpb24gPSBkMy5nZW9NZXJjYXRvcigpXG5cdFx0XHQuY2VudGVyKFszNy40NzAyNDUsIDU1Ljg1ODMxXSlcblx0XHRcdC5zY2FsZSgoNTEyKSAqIDAuNSAvIE1hdGguUEkgKiBNYXRoLnBvdygyLCBtYXAuYmFzZW1hcC5nZXRab29tKCkpKVxuXHRcdFx0LnRyYW5zbGF0ZShbMCwgMF0pXG5cdFx0Y29uc3QgZ2VvUGF0aCA9IGQzLmdlb1BhdGgoKS5wcm9qZWN0aW9uKHByb2plY3Rpb24pO1xuXG5cdFx0Ly9FZGl0aW5nIGRhdGFcblx0XHRsZXQgZGF0YSA9IGluY29taW5nWzBdO1xuXHRcdC8vIGxldCByb3V0ZXMgPSB0dXJmLmZlYXR1cmVDb2xsZWN0aW9uKE9iamVjdC5rZXlzKGluY29taW5nWzJdLm9iamVjdHMpLm1hcChrZXkgPT4ge1xuXHRcdC8vIFx0cmV0dXJuIHRvcG9qc29uLmZlYXR1cmUoaW5jb21pbmdbMl0sIGluY29taW5nWzJdLm9iamVjdHNba2V5XSlcblx0XHQvLyB9KSk7XG5cdFx0Ly8gY29uc29sZS5sb2cocm91dGVzKTtcblx0XHRkYXRhLmF0dHJpYnV0ZXMgPSBuZXcgT2JqZWN0KCk7XG5cdFx0ZGF0YS5mZWF0dXJlcy5mb3JFYWNoKGZlYXR1cmUgPT4ge1xuXHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzID0gbmV3IE9iamVjdCgpO1xuXHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLmNpcmNsZV9jb29yZGluYXRlcyA9IHByb2plY3Rpb24oZmVhdHVyZS5nZW9tZXRyeS5jb29yZGluYXRlcyk7XG5cdFx0XHRmZWF0dXJlLnByb3BlcnRpZXMudHJpcHMuZm9yRWFjaCh5ZWFyID0+IHtcblx0XHRcdFx0eWVhci5mb3JFYWNoKCh0cmlwLCBpKSA9PiB7XG5cdFx0XHRcdFx0eWVhcltpXSA9IHR1cmYubGluZVN0cmluZyhcblx0XHRcdFx0XHRcdHRvcG9qc29uLmZlYXR1cmUoaW5jb21pbmdbMl0sIGluY29taW5nWzJdLm9iamVjdHNbdHJpcC5pZF0pLmdlb21ldHJ5LmNvb3JkaW5hdGVzLFxuXHRcdFx0XHRcdFx0dHJpcFxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0Ly9TZXR0aW5nIG1hcmdpbnNcblx0XHRbJ2JhbGFuY2VfYWxsJywgJ2JhbGFuY2Vfd29ya2RheScsICdiYWxhbmNlX3dlZWtlbmQnXS5mb3JFYWNoKGtleSA9PiB7XG5cdFx0XHRsZXQgbWFyZ2luID0gZDMubWF4KFtcblx0XHRcdFx0TWF0aC5hYnMoZGF0YS5wcm9wZXJ0aWVzLmJhbGFuY2VfYWxsLm1heF9hYnMpLCBNYXRoLmFicyhkYXRhLnByb3BlcnRpZXMuYmFsYW5jZV9hbGwubWluX2FicyksXG5cdFx0XHRcdE1hdGguYWJzKGRhdGEucHJvcGVydGllcy5iYWxhbmNlX3dvcmtkYXkubWF4X2FicyksIE1hdGguYWJzKGRhdGEucHJvcGVydGllcy5iYWxhbmNlX3dvcmtkYXkubWluX2FicyksXG5cdFx0XHRcdE1hdGguYWJzKGRhdGEucHJvcGVydGllcy5iYWxhbmNlX3dlZWtlbmQubWF4X2FicyksIE1hdGguYWJzKGRhdGEucHJvcGVydGllcy5iYWxhbmNlX3dlZWtlbmQubWluX2Ficylcblx0XHRcdF0pO1xuXHRcdFx0ZGF0YS5wcm9wZXJ0aWVzW2tleV0ubWluX2FicyA9IC1tYXJnaW47XG5cdFx0XHRkYXRhLnByb3BlcnRpZXNba2V5XS5tYXhfYWJzID0gbWFyZ2luO1xuXHRcdH0pO1xuXG5cdFx0W1xuXHRcdFx0J3N1YnNjcmliZXJzX2Nhc3VhbF9yYXRpbycsXG5cdFx0XHQnd29ya2RheV93ZWVrZW5kX3JhdGlvJywgJ3BlcmNlbnRfc2FtZV9yZXR1cm4nXG5cdFx0XS5mb3JFYWNoKGtleSA9PiB7XG5cdFx0XHRkYXRhLnByb3BlcnRpZXNba2V5XS5taW5fYWJzID0gMDtcblx0XHRcdGRhdGEucHJvcGVydGllc1trZXldLm1heF9hYnMgPSAxO1xuXHRcdH0pO1xuXHRcdFtcblx0XHRcdCdzdW1fYWxsJywgJ3N1bV93b3JrZGF5JywgJ3N1bV93ZWVrZW5kJ1xuXHRcdFx0Ly8gJ21lYW5fYWxsX2RlcGFydHVyZXMnLCAnbWVhbl93b3JrZGF5X2RlcGFydHVyZXMnLCAnbWVhbl93ZWVrZW5kX2RlcGFydHVyZXMnLFxuXHRcdFx0Ly8gJ21lYW5fYWxsX3JldHVybnMnLCAnbWVhbl93b3JrZGF5X3JldHVybnMnLCAnbWVhbl93ZWVrZW5kX3JldHVybnMnXG5cdFx0XS5mb3JFYWNoKChrZXksIGksIGEpID0+IHtcblx0XHRcdGRhdGEucHJvcGVydGllc1trZXldLm1pbl9hYnMgPSAwO1xuXHRcdFx0ZGF0YS5wcm9wZXJ0aWVzW2tleV0ubWF4X2FicyA9IGQzLm1heChhLm1hcChrZXkgPT4gZDMubWF4KGRhdGEucHJvcGVydGllc1trZXldLm1heCkpKTtcblx0XHR9KTtcblx0XHRbJ21lYW5fYWxsX2RlcGFydHVyZXMnLCAnbWVhbl93b3JrZGF5X2RlcGFydHVyZXMnLCAnbWVhbl93ZWVrZW5kX2RlcGFydHVyZXMnXS5mb3JFYWNoKChrZXksIGksIGEpID0+IHtcblx0XHRcdGRhdGEucHJvcGVydGllc1trZXldLm1pbl9hYnMgPSAwO1xuXHRcdFx0ZGF0YS5wcm9wZXJ0aWVzW2tleV0ubWF4X2FicyA9IGQzLm1heChhLm1hcChrZXkgPT4gZDMubWF4KGRhdGEucHJvcGVydGllc1trZXldLm1heCkpKTtcblx0XHR9KTtcblx0XHRbJ21lYW5fYWxsX3JldHVybnMnLCAnbWVhbl93b3JrZGF5X3JldHVybnMnLCAnbWVhbl93ZWVrZW5kX3JldHVybnMnXS5mb3JFYWNoKChrZXksIGksIGEpID0+IHtcblx0XHRcdGRhdGEucHJvcGVydGllc1trZXldLm1pbl9hYnMgPSAwO1xuXHRcdFx0ZGF0YS5wcm9wZXJ0aWVzW2tleV0ubWF4X2FicyA9IGQzLm1heChhLm1hcChrZXkgPT4gZDMubWF4KGRhdGEucHJvcGVydGllc1trZXldLm1heCkpKTtcblx0XHR9KTtcblx0XHRbJ21lYW5fYWxsX2ludGVydmFsJywgJ21lYW5fYWxsX2ludGVydmFsJywgJ21lYW5fYWxsX2ludGVydmFsJ10uZm9yRWFjaCgoa2V5LCBpLCBhKSA9PiB7XG5cdFx0XHRkYXRhLnByb3BlcnRpZXNba2V5XS5taW5fYWJzID0gMDtcblx0XHRcdGRhdGEucHJvcGVydGllc1trZXldLm1heF9hYnMgPSBkMy5tYXgoYS5tYXAoa2V5ID0+IGQzLm1heChkYXRhLnByb3BlcnRpZXNba2V5XS5tYXgpKSk7XG5cdFx0fSk7XG5cdFx0Wyd0b3RhbF9zbG90cycsICduZWFyZXN0XzNrbSddLmZvckVhY2goa2V5ID0+IHtcblx0XHRcdGRhdGEucHJvcGVydGllc1trZXldLm1pbl9hYnMgPSAwO1xuXHRcdH0pO1xuXG5cdFx0Ly9TY2FsZXNcblx0XHRsZXQgZ2xvYmFsID0ge1xuXHRcdFx0J2knOiAyLFxuXHRcdFx0J3onOiBtYXAuYmFzZW1hcC5nZXRab29tKCksXG5cdFx0XHQna2V5JzogJ3N1bV9hbGwnLFxuXHRcdFx0J3gnOiAnbmVhcmVzdF8za20nLFxuXHRcdFx0J3knOiAnc3VtX2FsbCcsXG5cdFx0XHRnZXQgeWVhcigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuaSArIDIwMTQ7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly9VcGRhdGUgaW5pdGlhbGl6YXRpb25cblx0XHRsZXQgY29udHJvbGxlciA9IG5ldyBDb250cm9sbGVyKGRhdGEsIGdsb2JhbCk7XG5cblx0XHQvL0VsZW1lbnRzIGluaXRpYWxpemF0aW9uXG5cdFx0bGV0IGVsZW1lbnRzID0gbmV3IEVsZW1lbnRzKGRhdGEsIGdsb2JhbCwgbWFwLCBnZW9QYXRoKTtcblxuXHRcdG1hcC5tb3ZlTWFwKCk7XG5cdFx0cmVkcmF3TWFwWm9uZXMoY29udHJvbGxlci51bmZpbHRlcigpKTtcblxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vLS0tLS0tLUNoYXJ0LS0tLS0tLVxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdGVsZW1lbnRzLmNoYXJ0X3NlbGVjdG9ycy5zZWxlY3RBbGwoJ29wdGlvbicpXG5cdFx0XHQucHJvcGVydHkoJ3NlbGVjdGVkJywgZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0cmV0dXJuIGdsb2JhbFt0aGlzLnBhcmVudE5vZGUubmFtZS5zcGxpdCgnLScpWzBdXSA9PT0gdGhpcy52YWx1ZVxuXHRcdH0pXG5cdFx0ZWxlbWVudHMuY2hhcnRfc2VsZWN0b3JzLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0Z2xvYmFsW2RdID0gdGhpcy52YWx1ZTtcblx0XHRcdGNvbnRyb2xsZXIuZXZhbHVhdGVDaGFydEVsZW1lbnRzKGQpO1xuXHRcdFx0ZWxlbWVudHMucmVkcmF3Q2hhcnRFbGVtZW50cygpO1xuXHRcdH0pXG5cdFx0ZWxlbWVudHMuY2hhcnQub24oJ21vdXNlb3ZlcicsICgpID0+IHtcblx0XHRcdGVsZW1lbnRzLmNoYXJ0X2JhY2tncm91bmQuc3R5bGUoJ29wYWNpdHknLCAxKTtcblx0XHRcdGVsZW1lbnRzLmNoYXJ0X2FyZWEuc3R5bGUoJ29wYWNpdHknLCAxKTtcblx0XHR9KS5vbignbW91c2VsZWF2ZScsIChkKSA9PiB7XG5cdFx0XHRpZighZC5waW5uZWQpIHtcblx0XHRcdFx0ZWxlbWVudHMuY2hhcnRfYmFja2dyb3VuZC5zdHlsZSgnb3BhY2l0eScsIDApO1xuXHRcdFx0XHRlbGVtZW50cy5jaGFydF9hcmVhLnN0eWxlKCdvcGFjaXR5JywgMCk7XG5cdFx0XHRcdHJlZHJhd01hcFpvbmVzKGNvbnRyb2xsZXIudW5maWx0ZXIoKSk7XG5cdFx0XHRcdGVsZW1lbnRzLmNoYXJ0RmlsdGVyKCk7XG5cdFx0XHRcdGVsZW1lbnRzLmNoYXJ0X2xhYmVscy5zdHlsZSgnb3BhY2l0eScsIDApO1xuXHRcdFx0fVxuXHRcdH0pLm9uKCdtb3VzZW1vdmUnLCAoZCkgPT4ge1xuXHRcdFx0aWYoIWQucGlubmVkKSB7XG5cdFx0XHRcdGxldCBjb29yZGluYXRlcyA9IG5ldyBPYmplY3QoKTtcblx0XHRcdFx0aWYoZDMuZXZlbnQub2Zmc2V0WCA+PSAwKSB7XG5cdFx0XHRcdFx0Y29vcmRpbmF0ZXMueCA9IGQzLmV2ZW50Lm9mZnNldFhcblx0XHRcdFx0fVxuXHRcdFx0XHRpZihkMy5ldmVudC5vZmZzZXRZIDw9IDI1Nikge1xuXHRcdFx0XHRcdGNvb3JkaW5hdGVzLnkgPSBkMy5ldmVudC5vZmZzZXRZXG5cdFx0XHRcdH1cblx0XHRcdFx0cmVkcmF3TWFwWm9uZXMoXG5cdFx0XHRcdFx0Y29udHJvbGxlci5tb2RpZnlDaGFydEVsZW1lbnRzKGNvb3JkaW5hdGVzKVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRlbGVtZW50cy5jaGFydEZpbHRlcigpO1xuXHRcdFx0fVxuXHRcdH0pLm9uKCdjbGljaycsIChkKSA9PiB7XG5cdFx0XHRkLnBpbm5lZCA9ICFkLnBpbm5lZDtcblx0XHRcdGlmKCFkLnBpbm5lZCkge1xuXHRcdFx0XHRsZXQgY29vcmRpbmF0ZXMgPSBuZXcgT2JqZWN0KCk7XG5cdFx0XHRcdGlmKGQzLmV2ZW50Lm9mZnNldFggPj0gMCkge1xuXHRcdFx0XHRcdGNvb3JkaW5hdGVzLnggPSBkMy5ldmVudC5vZmZzZXRYXG5cdFx0XHRcdH1cblx0XHRcdFx0aWYoZDMuZXZlbnQub2Zmc2V0WSA8PSAyNTYpIHtcblx0XHRcdFx0XHRjb29yZGluYXRlcy55ID0gZDMuZXZlbnQub2Zmc2V0WVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJlZHJhd01hcFpvbmVzKFxuXHRcdFx0XHRcdGNvbnRyb2xsZXIubW9kaWZ5Q2hhcnRFbGVtZW50cyhjb29yZGluYXRlcylcblx0XHRcdFx0KTtcblx0XHRcdFx0ZWxlbWVudHMuY2hhcnRGaWx0ZXIoKTtcblx0XHRcdH1cblx0XHR9KVxuXHRcdGQzLnNlbGVjdCgnaW5wdXQnKVxuXHRcdFx0LmNsYXNzZWQoJ2NoZWNrZWQnLCB0cnVlKVxuXHRcdFx0LnByb3BlcnR5KCdjaGVja2VkJywgdHJ1ZSlcblx0XHRcdC5lYWNoKGQgPT4gZC51bmZvbGQoKSk7XG5cdFx0ZDMuc2VsZWN0QWxsKCdpbnB1dCcpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZCwgaSkge1xuXHRcdFx0ZDMuc2VsZWN0QWxsKCcuY2hlY2tlZCcpLmVhY2goZCA9PiBkLmZvbGQoKSk7XG5cdFx0XHRkMy5zZWxlY3RBbGwoJ2lucHV0OmNoZWNrZWQnKS5lYWNoKGQgPT4gZC51bmZvbGQoKSk7XG5cdFx0XHRnbG9iYWwua2V5ID0gdGhpcy52YWx1ZTtcblx0XHRcdGNvbnRyb2xsZXIuZXZhbHVhdGVNYXBFbGVtZW50cygpO1xuXHRcdFx0Y29udHJvbGxlci5ldmFsdWF0ZUNoYXJ0RWxlbWVudHMoKTtcblx0XHRcdGVsZW1lbnRzLnJlZHJhd01hcEVsZW1lbnRzKCk7XG5cdFx0XHRlbGVtZW50cy5yZWRyYXdDaGFydEVsZW1lbnRzKCk7XG5cdFx0fSlcblxuXHRcdGQzLnNlbGVjdEFsbCgnbGFiZWwnKS5vbignbW91c2Vtb3ZlJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coZDMuZXZlbnQucGF0aCk7XG5cdFx0XHRsZXQgc2hpZnQgPSBkMy5ldmVudC50YXJnZXQudGFnTmFtZSA9PSAnTEFCRUwnID8gMTYgOiAwXG5cdFx0XHRsZXQgbiA9IE1hdGgubWF4KDAsIE1hdGgubWluKDYzLCBNYXRoLnJvdW5kKChkMy5ldmVudC5vZmZzZXRYIC0gMiAtIHNoaWZ0KSAvIDQpKSlcblx0XHRcdGxldCBrZXk7XG5cdFx0XHRsZXQgYm90dG9tID0gbiAtIDQ7XG5cdFx0XHRsZXQgdG9wID0gbiArIDQ7XG5cdFx0XHRpZihib3R0b20gPCAwKSB7XG5cdFx0XHRcdHRvcCAtPSBib3R0b21cblx0XHRcdFx0Ym90dG9tID0gMDtcblx0XHRcdH1cblx0XHRcdGlmKHRvcCA+IDYzKSB7XG5cdFx0XHRcdGJvdHRvbSAtPSAodG9wIC0gNjMpXG5cdFx0XHRcdHRvcCA9IDYzO1xuXHRcdFx0fVxuXHRcdFx0ZDMuc2VsZWN0KHRoaXMpLnNlbGVjdCgnLmJhci1jb250YWluZXInKS5zZWxlY3RBbGwoJ3RleHQnKVxuXHRcdFx0XHQudGV4dChkID0+IGQuaW5kaWNhdG9yLmZvcm1hdChkLmluZGljYXRvci5jb2xvci5kb21haW5bbl0pKVxuXHRcdFx0XHQuYXR0cigneCcsIG4gKiA0ICsgMylcblx0XHRcdGQzLnNlbGVjdCh0aGlzKS5zZWxlY3QoJy5iYXItY29udGFpbmVyJykuc2VsZWN0KCd0ZXh0Jylcblx0XHRcdFx0LmVhY2goZCA9PiB7XG5cdFx0XHRcdFx0a2V5ID0gZC5rZXlcblx0XHRcdFx0XHRib3R0b20gPSBkLmluZGljYXRvci5jb2xvci5kb21haW5bYm90dG9tXTtcblx0XHRcdFx0XHR0b3AgPSBkLmluZGljYXRvci5jb2xvci5kb21haW5bdG9wXTtcblx0XHRcdFx0fSlcblx0XHRcdC8vIHJlZHJhd01hcFpvbmVzKFxuXHRcdFx0Ly8gXHRjb250cm9sbGVyLmZpbHRlcihcblx0XHRcdC8vIFx0XHRmZWF0dXJlID0+IGZlYXR1cmUuYXR0cmlidXRlcy52aXNpYmxlICYmXG5cdFx0XHQvLyBcdFx0ZmVhdHVyZS5wcm9wZXJ0aWVzW2tleV1bZ2xvYmFsLmldID49IGJvdHRvbSAmJlxuXHRcdFx0Ly8gXHRcdGZlYXR1cmUucHJvcGVydGllc1trZXldW2dsb2JhbC5pXSA8PSB0b3Bcblx0XHRcdC8vIFx0KVxuXHRcdFx0Ly8gKTtcblx0XHRcdC8vIGVsZW1lbnRzLmNoYXJ0X2RvdHMuY2xhc3NlZCgnZmlsdHJlZCcsIGQgPT4gZC5hdHRyaWJ1dGVzLmZpbHRyZWQpXG5cdFx0XHQvLyBlbGVtZW50cy5jaGFydF9jcm93bnMuY2xhc3NlZCgnZmlsdHJlZCcsIGQgPT4gZC5hdHRyaWJ1dGVzLmZpbHRyZWQpXG5cdFx0XHQvLyBlbGVtZW50cy5jaXJjbGVzLmNsYXNzZWQoJ2ZpbHRyZWQnLCBkID0+IGQuYXR0cmlidXRlcy5maWx0cmVkKVxuXHRcdH0pXG5cdFx0ZDMuc2VsZWN0QWxsKCdsYWJlbCcpLm9uKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0ZDMuc2VsZWN0KHRoaXMpLnNlbGVjdCgnLmJhci1jb250YWluZXInKS5zZWxlY3RBbGwoJ3RleHQnKVxuXHRcdFx0XHQudHJhbnNpdGlvbigpLmR1cmF0aW9uKDMwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcblx0XHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcblx0XHRcdFx0Ly8gLmF0dHIoJ3gnLCAxMjgpXG5cdFx0XHRcdC8vIC50ZXh0KGQgPT4gZC5pbmRpY2F0b3IuZm9ybWF0KGQuaW5kaWNhdG9yLmNvbG9yLm1lZGlhbikpXG5cdFx0XHRcdC8vIHJlZHJhd01hcFpvbmVzKGNvbnRyb2xsZXIudW5maWx0ZXIoKSk7XG5cdFx0XHRcdC8vIGVsZW1lbnRzLmNoYXJ0X2RvdHMuY2xhc3NlZCgnZmlsdHJlZCcsIGZhbHNlKTtcblx0XHRcdFx0Ly8gZWxlbWVudHMuY2hhcnRfY3Jvd25zLmNsYXNzZWQoJ2ZpbHRyZWQnLCBmYWxzZSk7XG5cdFx0XHRcdC8vIGVsZW1lbnRzLmNpcmNsZXMuY2xhc3NlZCgnZmlsdHJlZCcsIGZhbHNlKTtcblx0XHRcdFx0Ly8gZGVzdGluYXRpb25zID0gZDMucmFuZ2UoMCwgZGF0YS5mZWF0dXJlcy5sZW5ndGgsIDEpO1xuXHRcdH0pXG5cdFx0ZDMuc2VsZWN0QWxsKCdsYWJlbCcpLm9uKCdtb3VzZWVudGVyJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0ZDMuc2VsZWN0KHRoaXMpLnNlbGVjdCgnLmJhci1jb250YWluZXInKS5zZWxlY3RBbGwoJ3RleHQnKVxuXHRcdFx0XHQudHJhbnNpdGlvbigpLmR1cmF0aW9uKDMwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcblx0XHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMSlcblx0XHR9KVxuXHRcdC8vIGNvbnNvbGUubG9nKCk7XG5cdFx0Lypcblx0XHRlbGVtZW50cy5sYXllci5hcHBlbmQoJ2cnKVxuXHRcdFx0LnNlbGVjdEFsbCgncGF0aCcpXG5cdFx0XHQuZGF0YSh0dXJmLnZvcm9ub2koZGF0YSwge1xuXHRcdFx0ICBiYm94OiBbMzcuNDcwMjQ1LCA1NS42MjkwNjIsIDM3LjcxNzkzMSwgNTUuODU4MzFdXG5cdFx0XHR9KS5mZWF0dXJlcylcblx0XHRcdC5lbnRlcigpXG5cdFx0XHQuYXBwZW5kKCdwYXRoJylcblx0XHRcdC5hdHRyKCdkJywgZ2VvUGF0aClcblx0XHRcdC5zdHlsZSgnb3BhY2l0eScsIDApXG5cdFx0XHQvLyAuc3R5bGUoJ2ZpbGwnLCAncmdiYSgwLCAwLCAwLCAwLjEpJylcblx0XHRcdC8vIC5zdHlsZSgnc3Ryb2tlJywgJ2JsYWNrJylcblx0XHRcdC5vbignbW91c2VvdmVyJywgZnVuY3Rpb24gKGQsIGkpIHtcblx0XHRcdC8vIGxldCBhID0gZC5wcm9wZXJ0aWVzLmRpcmVjdGlvbnNbZ2xvYmFsLmldLnJlZHVjZSgocHJldiwgcm91dGUpID0+IHtcblx0XHRcdC8vIFx0cmV0dXJuIHByZXYuY29uY2F0KHJvdXRlcy5vYmplY3RzW3JvdXRlXS5hcmNzLm1hcChpZCA9PiBpZCA8IDAgPyAtaWQgLSAxIDogaWQpKVxuXHRcdFx0Ly8gfSwgbmV3IEFycmF5KCkpLnVuaXF1ZSgpO1xuXHRcdFx0Ly8gY29uc29sZS5sb2coYSk7XG5cdFx0XHQvLyBlbGVtZW50cy5yb3V0ZXMuY2xhc3NlZCgnZmlsdHJlZCcsIGQgPT4gYS5ldmVyeShuID0+IGQucHJvcGVydGllcy5pZCAhPSBuKSlcblx0XHRcdC8vIGQzLnNlbGVjdEFsbCgnLnJvdXRlcycpLnJlbW92ZSgpO1xuXHRcdFx0bGV0IGxlZnQgPSBkYXRhLmZlYXR1cmVzW2ldLnByb3BlcnRpZXMuZGlyZWN0aW9uc1tnbG9iYWwuaV0ubWFwKGlkID0+IHR1cmYubGluZU9mZnNldCh0dXJmLmxpbmVTdHJpbmcoaW5jb21pbmdbM10uZmVhdHVyZXNbaWRdLmdlb21ldHJ5LmNvb3JkaW5hdGVzLCB7J3NpZGUnOiB0cnVlfSksIDAuMDIpKVxuXHRcdFx0bGV0IHJpZ2h0ID0gZGF0YS5mZWF0dXJlc1tpXS5wcm9wZXJ0aWVzLmRpcmVjdGlvbnNbZ2xvYmFsLmldLm1hcChpZCA9PiB0dXJmLmxpbmVPZmZzZXQodHVyZi5saW5lU3RyaW5nKGluY29taW5nWzNdLmZlYXR1cmVzW2lkXS5nZW9tZXRyeS5jb29yZGluYXRlcywgeydzaWRlJzogZmFsc2V9KSwgLTAuMDIpKVxuXHRcdFx0bGVmdC5mb3JFYWNoKGZlYXR1cmUgPT4ge1xuXHRcdFx0XHRmZWF0dXJlLnByb3BlcnRpZXMubGVmdCA9IHRydWU7XG5cdFx0XHR9KVxuXHRcdFx0cmlnaHQuZm9yRWFjaChmZWF0dXJlID0+IHtcblx0XHRcdFx0ZmVhdHVyZS5wcm9wZXJ0aWVzLnJpZ2h0ID0gdHJ1ZTtcblx0XHRcdH0pXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhpbmNvbWUpO1xuXHRcdFx0ZDMuc2VsZWN0KCcjYmFzZW1hcCcpLm9uKCdtb3VzZW1vdmUnLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGQzLmV2ZW50KTtcblx0XHRcdH0pXG5cdFx0XHRsZXQgcGF0aHMgPSBlbGVtZW50cy5yb3V0ZXNcblx0XHRcdFx0LnNlbGVjdEFsbChudWxsKVxuXHRcdFx0XHQuZGF0YShkYXRhLmZlYXR1cmVzW2ldLnByb3BlcnRpZXMuZGlyZWN0aW9uc1tnbG9iYWwuaV0ubWFwKGlkID0+IGluY29taW5nWzNdLmZlYXR1cmVzW2lkXSkpXG5cdFx0XHRcdC5lbnRlcigpXG5cdFx0XHRcdC5hcHBlbmQoJ3BhdGgnKVxuXHRcdFx0XHQuYXR0cignZCcsIGdlb1BhdGgpXG5cdFx0XHRcdC5lYWNoKGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRcdFx0ZC5wcm9wZXJ0aWVzLmxlbmd0aCA9IHRoaXMuZ2V0VG90YWxMZW5ndGgoKTtcblx0XHRcdFx0fSlcblx0XHRcdFx0LmF0dHIoJ2NsYXNzJywgJ3JvdXRlcycpXG5cdFx0XHRcdC8vIC5zdHlsZSgnc3Ryb2tlJywgZCA9PiBkLnByb3BlcnRpZXMuc2lkZSA/IGNvbG9yLmhvdCA6IGNvbG9yLmNvbGQpXG5cdFx0XHRcdC5zdHlsZSgnZmlsbCcsICdub25lJylcblx0XHRcdFx0LnN0eWxlKCdzdHJva2UtZGFzaGFycmF5JywgZCA9PiBkLnByb3BlcnRpZXMubGVuZ3RoKVxuXHRcdFx0XHQuc3R5bGUoJ3N0cm9rZS1kYXNob2Zmc2V0JywgZCA9PiBkLnByb3BlcnRpZXMubGVuZ3RoKTtcblx0XHRcdHBhdGhzLnRyYW5zaXRpb24oKS5kdXJhdGlvbihkID0+IGQucHJvcGVydGllcy5sZW5ndGggKiA1KS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxuXHRcdFx0XHQuc3R5bGUoJ3N0cm9rZS1kYXNob2Zmc2V0JywgMClcblx0XHRcdGQzLnNlbGVjdCh0aGlzKS5vbignbW91c2VsZWF2ZScsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cGF0aHMudHJhbnNpdGlvbigpLmRlbGF5KDEwMDApLmR1cmF0aW9uKGQgPT4gZC5wcm9wZXJ0aWVzLmxlbmd0aCAqIDUpLmVhc2UoZDMuZWFzZVF1YWRPdXQpXG5cdFx0XHRcdFx0LnN0eWxlKCdzdHJva2UtZGFzaG9mZnNldCcsIGQgPT4gZC5wcm9wZXJ0aWVzLmxlbmd0aClcblx0XHRcdFx0XHQub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGQzLnNlbGVjdCh0aGlzKS5yZW1vdmUoKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0fSlcblx0XHR9KVxuXHRcdCovXG5cdFx0Lypcblx0XHRlbGVtZW50cy5jaXJjbGVzLm9uKCdtb3VzZW92ZXInLCBmdW5jdGlvbiAoZCkge1xuXHRcdFx0T2JqZWN0LmtleXMoZC5hdHRyaWJ1dGVzLmNpcmNsZV9pbmRpY2F0b3JzKS5mb3JFYWNoKGtleSA9PiB7XG5cdFx0XHRcdGxldCBuID0gZC5hdHRyaWJ1dGVzLmNpcmNsZV9pbmRpY2F0b3JzW2tleV0ubjtcblx0XHRcdFx0bGV0IHZhbHVlID0gZC5hdHRyaWJ1dGVzLmNpcmNsZV9pbmRpY2F0b3JzW2tleV0udmFsdWU7XG5cdFx0XHRcdGQzLnNlbGVjdCgnW2Zvcj1cInNlbGVjdF8nICsga2V5ICsgJ1wiXScpLnNlbGVjdCgnLmJhci1jb250YWluZXInKS5zZWxlY3RBbGwoJ3RleHQnKVxuXHRcdFx0XHRcdFx0LnRleHQoZCA9PiBkLmluZGljYXRvci5mb3JtYXQodmFsdWUpKVxuXHRcdFx0XHRcdFx0LnRyYW5zaXRpb24oKS5kdXJhdGlvbigzMDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXG5cdFx0XHRcdFx0XHQuYXR0cigneCcsIG4gKiA0ICsgMylcblx0XHRcdFx0XHRcdC5zdHlsZSgnb3BhY2l0eScsIDEpXG5cdFx0XHR9KVxuXHRcdFx0ZWxlbWVudHMuYnV0dG9ucy50ZXh0KChuLCBpKSA9PiBpbmRpY2F0b3JzW2dsb2JhbC5rZXldLmZvcm1hdF9zaG9ydChkLnByb3BlcnRpZXNbZ2xvYmFsLmtleV1baV0pKVxuXHRcdH0pXG5cdFx0ZWxlbWVudHMuY2lyY2xlcy5vbignbW91c2VsZWF2ZScsIGZ1bmN0aW9uIChkKSB7XG5cdFx0XHRPYmplY3Qua2V5cyhkLmF0dHJpYnV0ZXMuY2lyY2xlX2luZGljYXRvcnMpLmZvckVhY2goa2V5ID0+IHtcblx0XHRcdFx0ZDMuc2VsZWN0KCdbZm9yPVwic2VsZWN0XycgKyBrZXkgKyAnXCJdJykuc2VsZWN0KCcuYmFyLWNvbnRhaW5lcicpLnNlbGVjdEFsbCgndGV4dCcpXG5cdFx0XHRcdFx0XHQudHJhbnNpdGlvbigpLmRlbGF5KDEwMDApLmR1cmF0aW9uKDMwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcblx0XHRcdFx0XHRcdC8vIC5hdHRyKCd4JywgbiAqIDQgKyAzKVxuXHRcdFx0XHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcblx0XHRcdH0pXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0ZWxlbWVudHMuYnV0dG9ucy50cmFuc2l0aW9uKCkuZGVsYXkoMTAwMCkuZHVyYXRpb24oMzAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxuXHRcdFx0XHQudGV4dCgobiwgaSkgPT4gaW5kaWNhdG9yc1tnbG9iYWwua2V5XS5mb3JtYXRfc2hvcnQoZGF0YS5wcm9wZXJ0aWVzW2dsb2JhbC5rZXldLm1lZGlhbltpXSkpXG5cdFx0XHR9LCAxMDAwKVxuXHRcdH0pXG5cdFx0Ki9cblx0XHRsZXQgcGlubmVkID0gZmFsc2U7XG5cdFx0bGV0IGRlc3RpbmF0aW9ucyA9IGQzLnJhbmdlKDAsIGRhdGEuZmVhdHVyZXMubGVuZ3RoLCAxKTtcblx0XHRtYXAuYmFzZW1hcC5vbignbW91c2Vtb3ZlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRpZighcGlubmVkKSB7XG5cdFx0XHRcdGxldCBjZW50ZXIgPSB0dXJmLnBvaW50KGV2ZW50LmxuZ0xhdC50b0FycmF5KCkpO1xuXHRcdFx0XHRlbGVtZW50cy5yb3V0ZXNcblx0XHRcdFx0XHQvLy5maWx0ZXIoKGQsIGkpID0+IGRlc3RpbmF0aW9ucy5zb21lKGlkID0+IGlkID09IGkpKVxuXHRcdFx0XHRcdC5lYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7XG5cdFx0XHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLmRpc3RhbmNlID0gdHVyZi5kaXN0YW5jZShjZW50ZXIsIGZlYXR1cmUpO1xuXHRcdFx0XHRcdGxldCBiID0gZmVhdHVyZS5hdHRyaWJ1dGVzLmRpc3RhbmNlIDwgMTtcblx0XHRcdFx0XHRpZighZmVhdHVyZS5hdHRyaWJ1dGVzLnVuZm9sZGVkICYmIGIpIGZlYXR1cmUuYXR0cmlidXRlcy5wYXRocyA9IHVuZm9sZCh0aGlzKTtcblx0XHRcdFx0XHRpZihmZWF0dXJlLmF0dHJpYnV0ZXMudW5mb2xkZWQgJiYgIWIpIGZvbGQodGhpcyk7XG5cdFx0XHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLnVuZm9sZGVkID0gYjtcblx0XHRcdFx0XHRmdW5jdGlvbiB1bmZvbGQobm9kZSkge1xuXHRcdFx0XHRcdFx0bGV0IHBhdGhzID0gZDMuc2VsZWN0KG5vZGUpLnNlbGVjdEFsbChudWxsKVxuXHRcdFx0XHRcdFx0LnN0eWxlKCdzdHJva2Utd2lkdGgnLCBkYXRhLmF0dHJpYnV0ZXMuem9vbSAqIDEpXG5cdFx0XHRcdFx0XHQuZGF0YShmZWF0dXJlLnByb3BlcnRpZXMudHJpcHNbZ2xvYmFsLmldKVxuXHRcdFx0XHRcdFx0LmVudGVyKClcblx0XHRcdFx0XHRcdC5hcHBlbmQoJ3BhdGgnKVxuXHRcdFx0XHRcdFx0LmF0dHIoJ2QnLCBnZW9QYXRoKVxuXHRcdFx0XHRcdFx0LmVhY2goZnVuY3Rpb24gKGQpIHtcblx0XHRcdFx0XHRcdFx0ZC5wcm9wZXJ0aWVzLmxlbmd0aCA9IHRoaXMuZ2V0VG90YWxMZW5ndGgoKTtcblx0XHRcdFx0XHRcdH0pLmF0dHIoJ2NsYXNzJywgJ3JvdXRlJylcblx0XHRcdFx0XHRcdC5zdHlsZSgnc3Ryb2tlLWRhc2hhcnJheScsIGQgPT4gZC5wcm9wZXJ0aWVzLmxlbmd0aClcblx0XHRcdFx0XHRcdC5zdHlsZSgnc3Ryb2tlLWRhc2hvZmZzZXQnLCBkID0+IGQucHJvcGVydGllcy5sZW5ndGgpXG5cdFx0XHRcdFx0XHQuc3R5bGUoJ29wYWNpdHknLCBkID0+IE1hdGgubWluKDEsIGQucHJvcGVydGllcy50cmlwc19zdW0gLyAyNTAwKSk7XG5cblx0XHRcdFx0XHRcdHBhdGhzLnRyYW5zaXRpb24oKS5kdXJhdGlvbihkID0+IGQucHJvcGVydGllcy5sZW5ndGggKiA1KS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxuXHRcdFx0XHRcdFx0LnN0eWxlKCdzdHJva2UtZGFzaG9mZnNldCcsIDApXG5cdFx0XHRcdFx0XHRyZXR1cm4gcGF0aHM7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGZ1bmN0aW9uIGZvbGQobm9kZSkge1xuXHRcdFx0XHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLnBhdGhzLnRyYW5zaXRpb24oKS5kdXJhdGlvbihkID0+IGQucHJvcGVydGllcy5sZW5ndGggKiA1KS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxuXHRcdFx0XHRcdFx0LnN0eWxlKCdzdHJva2UtZGFzaG9mZnNldCcsIGQgPT4gZC5wcm9wZXJ0aWVzLmxlbmd0aClcblx0XHRcdFx0XHRcdC5vbignZW5kJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRkMy5zZWxlY3QodGhpcykucmVtb3ZlKCk7XG5cdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9KVxuXHRcdGVsZW1lbnRzLmNpcmNsZXMub24oJ2NsaWNrJywgZnVuY3Rpb24gKGZlYXR1cmUsIGkpIHtcblx0XHRcdGlmKCFwaW5uZWQpIHtcblx0XHRcdFx0ZWxlbWVudHMucm91dGVzXG5cdFx0XHRcdFx0LmZpbHRlcigoZCwgaikgPT4gaiAhPSBpKVxuXHRcdFx0XHRcdC5zZWxlY3RBbGwoJy5yb3V0ZScpXG5cdFx0XHRcdFx0LnRyYW5zaXRpb24oKS5kdXJhdGlvbig1MDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXG5cdFx0XHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcblx0XHRcdFx0XHQub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGQzLnNlbGVjdCh0aGlzKS5yZW1vdmUoKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHRkZXN0aW5hdGlvbnMgPSBuZXcgQXJyYXkoKTtcblx0XHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLnBhdGhzXG5cdFx0XHRcdFx0LmVhY2goZCA9PiBkZXN0aW5hdGlvbnMucHVzaChkLnByb3BlcnRpZXMub3V0KSlcblx0XHRcdFx0XHQub24oJ2NsaWNrJywgZCA9PiBjb25zb2xlLmxvZyhkLnByb3BlcnRpZXMpKVxuXHRcdFx0XHRcdC50cmFuc2l0aW9uKCkuZHVyYXRpb24oNTAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxuXHRcdFx0XHRcdC5zdHlsZSgnc3Ryb2tlJywgY29sb3IuaG90KVxuXHRcdFx0XHRcdC5zdHlsZSgnb3BhY2l0eScsIDEpXG5cblx0XHRcdFx0bGV0IG5vZGUgPSBmZWF0dXJlLmF0dHJpYnV0ZXMucGF0aHMubm9kZSgpLnBhcmVudE5vZGU7XG5cdFx0XHRcdG5vZGUucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChub2RlKTtcblx0XHRcdFx0bGV0IGEgPSBkZXN0aW5hdGlvbnMuY29uY2F0KFtmZWF0dXJlLnByb3BlcnRpZXMuaWRdKTtcblx0XHRcdFx0ZWxlbWVudHMuY2lyY2xlc1xuXHRcdFx0XHRcdC5maWx0ZXIoKGQsIGkpID0+IGEuc29tZShpZCA9PiBpZCA9PSBpKSlcblx0XHRcdFx0XHQuZWFjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQodGhpcylcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHRyZWRyYXdNYXBab25lcyhcblx0XHRcdFx0XHRjb250cm9sbGVyLmZpbHRlcihcblx0XHRcdFx0XHRcdGZlYXR1cmUgPT4gYS5zb21lKGlkID0+IGlkID09IGZlYXR1cmUucHJvcGVydGllcy5pZClcblx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdGZlYXR1cmUucHJvcGVydGllcy50cmlwc1tnbG9iYWwuaV1cblx0XHRcdFx0KTtcblx0XHRcdFx0ZWxlbWVudHMuY2hhcnRfZG90cy5jbGFzc2VkKCdmaWx0cmVkJywgZCA9PiBkLmF0dHJpYnV0ZXMuZmlsdHJlZClcblx0XHRcdFx0ZWxlbWVudHMuY2hhcnRfY3Jvd25zLmNsYXNzZWQoJ2ZpbHRyZWQnLCBkID0+IGQuYXR0cmlidXRlcy5maWx0cmVkKVxuXHRcdFx0XHRlbGVtZW50cy5jaXJjbGVzLmNsYXNzZWQoJ2ZpbHRyZWQnLCBkID0+IGQuYXR0cmlidXRlcy5maWx0cmVkKVxuXHRcdFx0XHQvLyBlbGVtZW50cy5jaXJjbGVzLmNsYXNzZWQoJ2ZpbHRyZWQtcmFkaXVzJywgZCA9PiBkLmF0dHJpYnV0ZXMuZmlsdHJlZClcblx0XHRcdH1cdGVsc2Uge1xuXHRcdFx0XHRyZWRyYXdNYXBab25lcyhjb250cm9sbGVyLnVuZmlsdGVyKCkpO1xuXHRcdFx0XHRlbGVtZW50cy5jaGFydF9kb3RzLmNsYXNzZWQoJ2ZpbHRyZWQnLCBmYWxzZSk7XG5cdFx0XHRcdGVsZW1lbnRzLmNoYXJ0X2Nyb3ducy5jbGFzc2VkKCdmaWx0cmVkJywgZmFsc2UpO1xuXHRcdFx0XHRlbGVtZW50cy5jaXJjbGVzLmNsYXNzZWQoJ2ZpbHRyZWQnLCBmYWxzZSk7XG5cdFx0XHRcdGRlc3RpbmF0aW9ucyA9IGQzLnJhbmdlKDAsIGRhdGEuZmVhdHVyZXMubGVuZ3RoLCAxKTtcblx0XHRcdH1cblx0XHRcdHBpbm5lZCA9ICFwaW5uZWQ7XG5cdFx0fSlcblxuXHRcdGQzLnNlbGVjdCgnI292ZXJsYXknKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRpZihwaW5uZWQpIHtcblx0XHRcdFx0cmVkcmF3TWFwWm9uZXMoY29udHJvbGxlci51bmZpbHRlcigpKTtcblx0XHRcdFx0ZWxlbWVudHMuY2hhcnRfZG90cy5jbGFzc2VkKCdmaWx0cmVkJywgZmFsc2UpO1xuXHRcdFx0XHRlbGVtZW50cy5jaGFydF9jcm93bnMuY2xhc3NlZCgnZmlsdHJlZCcsIGZhbHNlKTtcblx0XHRcdFx0ZWxlbWVudHMuY2lyY2xlcy5jbGFzc2VkKCdmaWx0cmVkJywgZmFsc2UpO1xuXHRcdFx0XHRkZXN0aW5hdGlvbnMgPSBkMy5yYW5nZSgwLCBkYXRhLmZlYXR1cmVzLmxlbmd0aCwgMSk7XG5cdFx0XHRcdHBpbm5lZCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH0pXG5cblx0XHRkMy5zZWxlY3QoJyN0aW1lbGluZS1jb250YWluZXInKS5zZWxlY3RBbGwoJ2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcblx0XHRcdGdsb2JhbC5pID0gcGFyc2VJbnQodGhpcy5uYW1lKSAtIDIwMTQ7XG5cdFx0XHRjb250cm9sbGVyLmluaXRpYWxpemF0aW9uKCk7XG5cdFx0XHRlbGVtZW50cy5pbml0aWFsaXphdGlvbigpO1xuXHRcdFx0cmVkcmF3TWFwWm9uZXMoY29udHJvbGxlci51bmZpbHRlcigpKTtcblx0XHRcdGQzLnNlbGVjdCgnYnV0dG9uOmRpc2FibGVkJykubm9kZSgpLmRpc2FibGVkID0gZmFsc2U7XG5cdFx0XHRkMy5zZWxlY3RBbGwoJ2lucHV0OmNoZWNrZWQnKS5lYWNoKGQgPT4gZC51bmZvbGQoKSk7XG5cdFx0XHR0aGlzLmRpc2FibGVkID0gdHJ1ZTtcblx0XHR9KVxuXHRcdGQzLnNlbGVjdCgnI21haW4tY29udGFpbmVyJykubm9kZSgpLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0ZDMuc2VsZWN0KCcjdGltZWxpbmUtY29udGFpbmVyJykuY2xhc3NlZCgnZXh0ZW5kZWQnLCB0aGlzLnNjcm9sbEhlaWdodCAtIHRoaXMuY2xpZW50SGVpZ2h0ID09IHRoaXMuc2Nyb2xsVG9wKVxuXHRcdH0pO1xuXG5cdFx0Ly8tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvLy0tLS0tLS1ab29tLS0tLS0tLVxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0bGV0IGRlbGF5ZWRJZDtcblx0XHRkMy5zZWxlY3QoJ2RpdiNiYXNlbWFwJykub24oJ21vdXNld2hlZWwnLCBldmVudCA9PiB7XG5cdFx0XHRnbG9iYWwueiA9IE1hdGgubWF4KDEwLjUsIE1hdGgubWluKDE2LjUsIGdsb2JhbC56IC0gZDMuZXZlbnQuZGVsdGFZIC8gMTAwKSk7XG5cdFx0XHRkZWxheWVkSWQgPSBNYXRoLnJhbmRvbSgpO1xuXHRcdFx0aWYoZ2xvYmFsLnogPT0gMTAuNSkge1xuXHRcdFx0XHRtYXAuYmFzZW1hcC5lYXNlVG8oe1xuXHRcdFx0XHRcdHpvb206IGdsb2JhbC56LFxuXHRcdFx0XHRcdGVhc2luZzogZDMuZWFzZVF1YWRPdXRcblx0XHRcdFx0fSk7XG5cdFx0XHR9XHRlbHNlIHtcblx0XHRcdFx0bWFwLmJhc2VtYXAuZWFzZVRvKHtcblx0XHRcdFx0XHRlYXNpbmc6IGQzLmVhc2VRdWFkT3V0LFxuXHRcdFx0XHRcdGR1cmF0aW9uOiAzMDAsXG5cdFx0XHRcdFx0Y2VudGVyOiBbbWFwLmJhc2VtYXAubW91c2UubG5nLCBtYXAuYmFzZW1hcC5tb3VzZS5sYXRdLFxuXHRcdFx0XHRcdHpvb206IGdsb2JhbC56XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0bGV0IHRlbXAgPSBkZWxheWVkSWQ7XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0aWYoZGVsYXllZElkID09IHRlbXApIHtcblx0XHRcdFx0XHRjb250cm9sbGVyLmV2YWx1YXRlTWFwRWxlbWVudHMoKTtcblx0XHRcdFx0XHRlbGVtZW50cy5yZWRyYXdNYXBFbGVtZW50cygpO1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKGdsb2JhbC56KTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgMTAwKTtcblx0XHR9KVxuXG5cdFx0ZnVuY3Rpb24gcmVkcmF3TWFwWm9uZXMoZmVhdHVyZXMsIGxpbmVzID0gbmV3IEFycmF5KCkpIHtcblx0XHRcdGxldCBjbHVzdGVyZWRQb2ludHMgPSB0dXJmLmNsdXN0ZXJzRGJzY2FuKFxuXHRcdFx0XHR0dXJmLmZlYXR1cmVDb2xsZWN0aW9uKGZlYXR1cmVzLm1hcChmZWF0dXJlID0+IHR1cmYucG9pbnQoZmVhdHVyZS5nZW9tZXRyeS5jb29yZGluYXRlcykpKSxcblx0XHRcdFx0MS41LFxuXHRcdFx0XHR7IG1pblBvaW50czogMSB9XG5cdFx0XHQpXG5cdFx0XHRsZXQgY2x1c3RlcnMgPSBuZXcgQXJyYXkoKTtcblx0XHRcdGNsdXN0ZXJlZFBvaW50cy5mZWF0dXJlcy5mb3JFYWNoKHN0YXRpb24gPT4ge1xuXHRcdFx0XHRsZXQgY2x1c3RlciA9IHN0YXRpb24ucHJvcGVydGllcy5jbHVzdGVyO1xuXHRcdFx0XHRjbHVzdGVyc1tjbHVzdGVyXSA/IGNsdXN0ZXJzW2NsdXN0ZXJdLnB1c2goc3RhdGlvbikgOiBjbHVzdGVyc1tjbHVzdGVyXSA9IFtzdGF0aW9uXTtcblx0XHRcdH0pXG5cdFx0XHRsZXQgY292ZXJhZ2VfYXJlYSA9IG5ldyBBcnJheSgpO1xuXHRcdFx0bGV0IGNvdmVyYWdlX2xpbmUgPSBuZXcgQXJyYXkoKTtcblx0XHRcdGxldCBjb3ZlcmFnZV9wb2ludCA9IG5ldyBBcnJheSgpO1xuXHRcdFx0Y2x1c3RlcnMuZm9yRWFjaChjbHVzdGVyID0+IHtcblx0XHRcdFx0bGV0IHBvaW50cyA9IHR1cmYuZmVhdHVyZUNvbGxlY3Rpb24oXG5cdFx0XHRcdFx0Y2x1c3Rlci5tYXAoc3RhdGlvbiA9PiB0dXJmLnBvaW50KHN0YXRpb24uZ2VvbWV0cnkuY29vcmRpbmF0ZXMpKVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRpZihwb2ludHMuZmVhdHVyZXMubGVuZ3RoID4gMikge1xuXHRcdFx0XHRcdGNvdmVyYWdlX2FyZWEucHVzaCh0dXJmLmNvbmNhdmUocG9pbnRzLCB7J21heEVkZ2UnOiAyfSkpXG5cdFx0XHRcdFx0Ly8gY292ZXJhZ2VfYXJlYS5wdXNoKHR1cmYuY29udmV4KHBvaW50cywgeydjb25jYXZpdHknOiAyfSkpXG5cdFx0XHRcdH1cdGVsc2UgaWYocG9pbnRzLmZlYXR1cmVzLmxlbmd0aCA9PSAyKSB7XG5cdFx0XHRcdFx0Y292ZXJhZ2VfbGluZS5wdXNoKHR1cmYubGluZVN0cmluZyhcblx0XHRcdFx0XHRcdHBvaW50cy5mZWF0dXJlcy5tYXAocG9pbnQgPT4gcG9pbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpXG5cdFx0XHRcdFx0KSk7XG5cdFx0XHRcdH1cdGVsc2Uge1xuXHRcdFx0XHRcdGNvdmVyYWdlX3BvaW50LnB1c2gocG9pbnRzLmZlYXR1cmVzWzBdKTtcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHRcdGNvdmVyYWdlX2FyZWEgPSBjb3ZlcmFnZV9hcmVhLmNvbmNhdChjb3ZlcmFnZV9saW5lKS5jb25jYXQobGluZXMpLmNvbmNhdChjb3ZlcmFnZV9wb2ludCkubWFwKGZlYXR1cmUgPT4ge1xuXHRcdFx0XHRpZihmZWF0dXJlKSB7XG5cdFx0XHRcdFx0bGV0IGJ1ZmZlciA9IHR1cmYuYnVmZmVyKGZlYXR1cmUsIDAuOCwge3N0ZXBzOiAwfSk7XG5cdFx0XHRcdFx0cmV0dXJuIGJ1ZmZlcjtcblx0XHRcdFx0fVx0ZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlXG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0Y292ZXJhZ2VfYXJlYSA9IGNvdmVyYWdlX2FyZWEuZmlsdGVyKGZlYXR1cmUgPT4gZmVhdHVyZSk7XG5cdFx0XHRlbGVtZW50cy56b25lcy5zZWxlY3RBbGwoJ3BhdGgnKS5yZW1vdmUoKVxuXHRcdFx0ZWxlbWVudHMuem9uZXMuc2VsZWN0QWxsKCdwYXRoJylcblx0XHRcdFx0LmRhdGEoY292ZXJhZ2VfYXJlYSlcblx0XHRcdFx0LmVudGVyKClcblx0XHRcdFx0LmFwcGVuZCgncGF0aCcpXG5cdFx0XHRcdC5hdHRyKCdjbGFzcycsICdjb3ZlcmFnZScpXG5cdFx0XHRcdC5hdHRyKCdkJywgZCA9PiBnZW9QYXRoKGQpLnNwbGl0KCdaJylbMF0gKyAnWicpXG5cdFx0XHRcdC5zdHlsZSgnb3BhY2l0eScsIDEpXG5cdFx0fVxuXG5cdFx0Ly9QcmludCBTb21lIFZhbHVlc1xuXHRcdC8vIGNvbnNvbGUubG9nKCd7JyArIE9iamVjdC5rZXlzKGRhdGEuZmVhdHVyZXNbMF0ucHJvcGVydGllcykuam9pbihcblx0XHQvLyBcdGAnLCd0aXRsZSc6ICcnfSx7J2tleSc6ICdgXG5cdFx0Ly8gKSArICd9Jyk7XG59KVxuXG5BcnJheS5wcm90b3R5cGUudW5pcXVlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGEgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgIHZhciBjdXJyZW50ID0gdGhpc1tpXTtcbiAgICAgICAgaWYgKGEuaW5kZXhPZihjdXJyZW50KSA8IDApIGEucHVzaChjdXJyZW50KTtcbiAgICB9XG4gICAgcmV0dXJuIGE7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///2\n");

/***/ }),
/* 3 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Map; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Elements; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__global__ = __webpack_require__(0);\n\r\nlet data, routes, global;\r\n\r\nclass SvgMap {\r\n\tconstructor(basemapProps, svgMap, svgOrigin) {\r\n\t\tmapboxgl.accessToken = 'pk.eyJ1IjoidzJlayIsImEiOiI4M2ZLOEVJIn0.g0A0zBZy5rJz00A1fVgDTg';\r\n\t\tthis.basemap = new mapboxgl.Map(basemapProps);\r\n\t\tthis.svg = d3.select(this.basemap.getCanvasContainer().appendChild(svgMap.documentElement))\r\n\t\t\t.attr('id', 'map');\r\n\t\tthis.container = this.svg.append('g');\r\n\t\tthis.container.lon = svgOrigin.lon;\r\n\t\tthis.container.lat = svgOrigin.lat;\r\n\t\tthis.container.z = svgOrigin.z;\r\n\t\tthis.basemap.on('move', () => {\r\n\t\t\tthis.moveMap();\r\n\t\t});\r\n\t\tthis.basemap.on('mousemove', (e) => {\r\n\t\t\tthis.basemap.mouse = e.lngLat;\r\n\t\t})\r\n\t}\r\n\tmoveMap() {\r\n\t\tthis.width = window.innerWidth;\r\n\t\tthis.height = window.innerHeight;\r\n\t\tthis.z = Math.pow(2, this.basemap.getZoom() - this.container.z);\r\n\t\tthis.offset = new Object();\r\n\t\tthis.offset.x = (this.project(this.container.lon, this.container.lat)).x;\r\n\t\tthis.offset.y = (this.project(this.container.lon, this.container.lat)).y;\r\n\t\tthis.container.attr('transform', `translate(${this.offset.x}, ${this.offset.y}) scale(${this.z})`);\r\n\t\td3.select('#zone_mask').select('g').attr('transform', `translate(${this.offset.x}, ${this.offset.y}) scale(${this.z})`);\r\n\t}\r\n\tproject(lon, lat) {\r\n\t\treturn this.basemap.project(function getLL() {\r\n\t\t\treturn new mapboxgl.LngLat(lon, lat)\r\n\t\t}());\r\n\t}\r\n}\r\n\r\nclass Map extends SvgMap {\r\n\tconstructor(incoming) {\r\n\t\tsuper(\r\n\t\t\t{\r\n\t\t\t\tcontainer: 'basemap',\r\n\t\t\t\tstyle: 'mapbox://styles/w2ek/cjacj3ytj4csa2rpkka04pefa',\r\n\t\t\t\tcenter: [37.62, 55.73],\r\n\t\t\t\tzoom: 10.5,\r\n\t\t\t\tscrollZoom: false\r\n\t\t\t}, incoming, {\t'lon': 37.470245, 'lat': 55.85831, 'z': 10.5}\r\n\t\t);\r\n\t\tthis.moveMap();\r\n\t}\r\n}\r\nclass Selector {\r\n\tconstructor(args) {\r\n\t\tthis.title = args.title;\r\n\t\tthis.key = args.key;\r\n\t\tthis.indicator = args;\r\n\t\tthis.container = d3.select('#graphs').append('div')\r\n\t\tthis.input = this.container.append('input')\r\n\t\t\t.datum(this)\r\n\t\t\t.attr('type', 'radio')\r\n\t\t\t.attr('name', 'mode')\r\n\t\t\t.attr('value', this.key)\r\n\t\t\t.attr('id', 'select_' + this.key)\r\n\t\t\t.style('display', 'none')\r\n\r\n\t\tthis.container = this.container.append('label')\r\n\t\t\t.attr('for', 'select_' + this.key)\r\n\r\n\t\tthis.container.append('div')\r\n\t\t\t.attr('class', 'selector-header')\r\n\t\t\t.append('span')\r\n\t\t\t.text(this.title)\r\n\r\n\t\tthis.svg = this.container.append('div')\r\n\t\t\t.attr('class', 'selector-content')\r\n\t\t\t.append('svg')\r\n\t\t\t.append('g')\r\n\t\t\t.attr('class', 'selector-container')\r\n\r\n\t\tthis.guides = this.svg\r\n\t\t\t.append('g')\r\n\t\t\t.selectAll('g')\r\n\t\t\t.data([\r\n\t\t\t\t{'x': 2.5, 'type': 'min'},\r\n\t\t\t\t{'x': 64.5, 'type': 'Q1'},\r\n\t\t\t\t{'x': 128.5, 'type': 'median'},\r\n\t\t\t\t{'x': 192.5, 'type': 'Q3'},\r\n\t\t\t\t{'x': 254.5, 'type': 'max'}\r\n\t\t\t])\r\n\t\t\t.enter()\r\n\t\t\t.append('g')\r\n\t\t\t.attr('class', 'selector-guide')\r\n\t\t\t.style('transform', d => `translateX(${d.x}px)`)\r\n\r\n\t\tthis.guides.append('line')\r\n\r\n\t\tthis.guides.append('text')\r\n\t\t\t.text(d => d.type)\r\n\t\t\t.attr('y', 16)\r\n\r\n\t\tthis.bars = args.generate(this.svg);\r\n\t\tthis.num_halo = this.svg.select('.bar-container')\r\n\t\t\t.append('text')\r\n\t\t\t.datum(this)\r\n\t\t\t.attr('class', 'selector-num-halo')\r\n\t\t\t.attr('y', 2)\r\n\t\t\t.attr('x', 128)\r\n\t\t\t.style('opacity', 0)\r\n\r\n\t\tthis.num = this.svg.select('.bar-container')\r\n\t\t\t.append('text')\r\n\t\t\t.datum(this)\r\n\t\t\t.attr('class', 'selector-num')\r\n\t\t\t.attr('y', 2)\r\n\t\t\t.attr('x', 128)\r\n\t\t\t.style('opacity', 0)\r\n\t\tthis.legend = this.svg.append('g')\r\n\t\t\t.attr('class', 'selector-legend')\r\n\r\n\t\tif(this.indicator.legend) {\r\n\t\t\tlet node = this.legend.selectAll('g')\r\n\t\t\t\t.data(this.indicator.legend)\r\n\t\t\t\t.enter()\r\n\t\t\t\t.append('g')\r\n\t\t\t\t.style('transform', (d, i) => `translateX(${i ? 254.5 : 2.5 }px)`)\r\n\t\t\tnode.append('line')\r\n\t\t\t\t.attr('y2', -7)\r\n\t\t\t\t.style('stroke', (d, i) => i ? __WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].cold : __WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].hot)\r\n\r\n\t\t\tnode.append('text')\r\n\t\t\t\t.text(d => d)\r\n\r\n\t\t}\r\n\t\tthis.zone = this.svg.append('rect')\r\n\t\t.attr('class', 'svg-area')\r\n\t\t.attr('width', 256)\r\n\t\t// if(this.indicator.alternative) {\r\n\t\t// \tthis.legend.append('text')\r\n\t\t// \t\t.selectAll('tspan')\r\n\t\t// \t\t.data(this.indicator.alternative)\r\n\t\t// \t\t.enter()\r\n\t\t// \t\t.append('tspan')\r\n\t\t// \t\t.text((d, i) => i ? ' | ' + d.title : d.title)\r\n\t\t// }\r\n\r\n\r\n\t\tthis.redraw();\r\n\t\tthis.fold();\r\n\t}\r\n\tredraw() {\r\n\t\tthis.bars.transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t\t.style('stroke', (d, i) => d.range[i])\r\n\t}\r\n\tunfold() {\r\n\t\tthis.input.classed('checked', true)\r\n\t\tthis.guides.transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t\t.selectAll('line')\r\n\t\t\t.attr('y2', -89)\r\n\t\tthis.legend.style('transform', 'translateY(-100px)')\r\n\t\t\t.transition().delay(300).duration(200).ease(d3.easeQuadOut)\r\n\t\t\t.style('opacity', 1)\r\n\r\n\t\tthis.bars.call(this.indicator.unfold)\r\n\t}\r\n\tfold() {\r\n\t\tthis.input.classed('checked', false)\r\n\t\tthis.guides.transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t\t.selectAll('line')\r\n\t\t\t.attr('y2', -4)\r\n\t\tthis.legend.transition().delay(100).duration(200).ease(d3.easeQuadOut)\r\n\t\t\t.style('opacity', 0)\r\n\t\t\t.on('end', function () {\r\n\t\t\t\td3.select(this).style('transform', 'translateY(0)')\r\n\t\t\t})\r\n\r\n\t\tthis.bars.call(this.indicator.fold)\r\n\t}\r\n}\r\nclass Elements {\r\n\tconstructor(...incoming) {\r\n\t\t[data, global, this.map, this.geoPath] = incoming;\r\n\r\n\t\tthis.layer = this.map.container\r\n\t\tthis.defs = this.layer.append('defs');\r\n\r\n\t\t//-----------------------\r\n\t\t//-------Zone Mask-------\r\n\t\t//-----------------------\r\n\t\tthis.defs.append('mask')\r\n\t\t\t.attr('id', 'zone_mask')\r\n\t\t\t.append('rect')\r\n\t\t\t.attr('x', -4000)\r\n\t\t\t.attr('y', -4000)\r\n\t\t\t.attr('width', 510.13 + 8000)\r\n\t\t\t.attr('height', 838.81 + 8000)\r\n\t\t\t.style('fill', 'white')\r\n\r\n\t\tthis.zones = this.defs.select('mask')\r\n\t\t\t.append('g')\r\n\r\n\t\tthis.pattern = this.map.svg.insert('defs', 'g')\r\n\t\t\t.append('pattern')\r\n\t\t\t.attr('id', 'pattern-map')\r\n\t\t\t.attr('width', 6)\r\n\t\t\t.attr('height', 6)\r\n\t\t\t.attr('patternUnits', 'userSpaceOnUse')\r\n\t\t\t.attr('viewBox', '0 0 6 6')\r\n\t\t\t// .attr('patternTransform', `rotate(45) scale(0)`);\r\n\t\t\t.attr('patternTransform', 'rotate(45)');\r\n\r\n\t\tthis.pattern.append('line')\r\n\t\t\t.attr('x1', 0)\r\n\t\t\t.attr('y1', 0.5)\r\n\t\t\t.attr('x2', 8)\r\n\t\t\t.attr('y2', 0.5)\r\n\t\t\t.attr('style', `opacity: 0; stroke-width: 1px; stroke: ${__WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].grey}; stroke-linecap: square; shape-rendering: crispEdges`)\r\n\r\n\t\tthis.map.svg.insert('rect', 'g')\r\n\t\t\t.attr('x', -4000)\r\n\t\t\t.attr('y', -4000)\r\n\t\t\t.attr('width', 510.13 + 8000)\r\n\t\t\t.attr('height', 838.81 + 8000)\r\n\t\t\t.attr('fill', 'url(#pattern-map)')\r\n\t\t\t.attr('mask', 'url(#zone_mask)')\r\n\t\t\t.attr('id', 'overlay')\r\n\r\n\t\t//---------------------\r\n\t\t//-------Routes-------\r\n\t\t//---------------------\r\n\r\n\t\t// console.log(routes.arcs);\r\n\t\tthis.routes = this.layer.append('g')\r\n\t\t\t.attr('id', 'circles-container')\r\n\t\t\t.selectAll('g')\r\n\t\t\t.data(data.features)\r\n\t\t\t.enter()\r\n\t\t\t.append('g')\r\n\t\t\t// .selectAll('path')\r\n\t\t\t// .data(routes.arcs.map((coordinates, i) => turf.lineString(coordinates, {\t'id': i\t})))\r\n\t\t\t// .enter()\r\n\t\t\t// .append('path')\r\n\t\t\t// .attr('class', 'route filtred')\r\n\t\t\t// .attr('d', this.geoPath)\r\n\t\t\t// .style('display', 'none')\r\n\r\n\t\t//---------------------\r\n\t\t//-------Circles-------\r\n\t\t//---------------------\r\n\t\tthis.circles = this.layer.select('#circles-container')\r\n\t\t\t.selectAll(null)\r\n\t\t\t.data(data.features)\r\n\t\t\t.enter()\r\n\t\t\t.append('g')\r\n\t\t\t.attr('id', d => 'station_' + d.properties.id)\r\n\t\t\t.attr('class', 'circle-container')\r\n\t\t\t.attr('transform', d => `translate(${d.attributes.circle_coordinates.join(', ')})`);\r\n\r\n\t\tthis.circles_fill = this.circles\r\n\t\t\t.append('circle')\r\n\t\t\t.attr('class', 'circle-fill')\r\n\t\t\t.attr('r', 0);\r\n\r\n\t\tthis.circles_crown = this.circles.filter(d => d.properties.transit)\r\n\t\t\t.append('circle')\r\n\t\t\t.attr('class', 'circle-crown')\r\n\t\t\t.attr('r', 0);\r\n\r\n\t\tthis.circles_halo = this.zones.append('g')\r\n\t\t\t.selectAll('circle')\r\n\t\t\t.data(data.features)\r\n\t\t\t.enter()\r\n\t\t\t.append('circle')\r\n\t\t\t.attr('class', 'circle-halo')\r\n\t\t\t.attr('cx', d => d.attributes.circle_coordinates[0])\r\n\t\t\t.attr('cy', d => d.attributes.circle_coordinates[1])\r\n\t\t\t.attr('r', 0);\r\n\r\n\t\tthis.circles.sort(d => d.properties.transit)\r\n\r\n\t\t//-----------------------\r\n\t\t//-------Chartplot-------\r\n\t\t//-----------------------\r\n\t\tthis.chart = d3.select('#chartplot')\r\n\t\tthis.chart.append('defs').node()\r\n\t\t\t.appendChild(d3.select('#pattern-map').node().cloneNode(true))\r\n\r\n\t\tthis.chart.select('#pattern-map')\r\n\t\t\t.attr('id', 'pattern-chart')\r\n\t\t\t.select('line').style('opacity', null);\r\n\r\n\t\tthis.chart = this.chart.append('g')\r\n\t\t\t.datum({'pinned': false})\r\n\t\t\t.attr('transform', 'translate(0, 256)');\r\n\r\n\t\tthis.chart.append('rect')\r\n\t\t\t.attr('x', -32)\r\n\t\t\t.attr('y', -256)\r\n\t\t\t.attr('width', 256 + 32)\r\n\t\t\t.attr('height', 256)\r\n\t\t\t.style('opacity', 0)\r\n\r\n\t\tthis.chart.append('rect')\r\n\t\t\t.attr('y', -256)\r\n\t\t\t.attr('width', 256)\r\n\t\t\t.attr('height', 256 + 32)\r\n\t\t\t.style('opacity', 0)\r\n\r\n\t\tthis.chart_background = this.chart\r\n\t\t\t.append('rect')\r\n\t\t\t.attr('id', 'chart-background')\r\n\t\t\t.attr('y', -256)\r\n\t\t\t.attr('width', 256)\r\n\t\t\t.attr('height', 256)\r\n\t\t\t.attr('fill', 'url(#pattern-chart)')\r\n\t\t\t.style('opacity', 0)\r\n\r\n\t\tthis.chart_area = this.chart\r\n\t\t\t.append('rect')\r\n\t\t\t.attr('id', 'chart-area')\r\n\t\t\t.attr('width', 64)\r\n\t\t\t.attr('height', 64)\r\n\t\t\t.style('opacity', 0)\r\n\t\t\t.style('fill', __WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].grey)\r\n\r\n\t\tthis.chart_dots = this.chart\r\n\t\t\t.append('g')\r\n\t\t\t.selectAll('circle')\r\n\t\t\t.data(data.features.filter(feature => !feature.properties.transit))\r\n\t\t\t.enter()\r\n\t\t\t.append('circle')\r\n\t\t\t.attr('class', 'chart-dot')\r\n\t\t\t.style('pointer-events', 'none')\r\n\r\n\t\tthis.chart_crowns = this.chart\r\n\t\t\t.append('g')\r\n\t\t\t.selectAll('circle')\r\n\t\t\t.data(data.features.filter(feature => feature.properties.transit))\r\n\t\t\t.enter()\r\n\t\t\t.append('circle')\r\n\t\t\t.attr('class', 'chart-crown')\r\n\t\t\t.style('pointer-events', 'none')\r\n\r\n\t\t//--------------------------\r\n\t\t//-------Chart Labels-------\r\n\t\t//--------------------------\r\n\t\tthis.chart_labels = this.chart\r\n\t\t\t.selectAll(null)\r\n\t\t\t.data(['x', 'y'])\r\n\t\t\t.enter()\r\n\t\t\t.append('g')\r\n\t\t\t.attr('class', 'chart-ticks')\r\n\t\t\t.attr('data-axis', d => d)\r\n\t\t\t.style('opacity', 0)\r\n\r\n\t\tthis.chart_labels.selectAll('g')\r\n\t\t\t.data(d => {\r\n\t\t\t\tlet a = ['min', 'max'];\r\n\t\t\t\tif(d == 'y') a.reverse();\r\n\t\t\t\treturn a;\r\n\t\t\t}).enter()\r\n\t\t\t.append('g');\r\n\t\tthis.chart_labels.selectAll('g').append('line')\r\n\t\t\t.attr('class', 'chart-axis')\r\n\t\t\t.each(function (d, i) {\r\n\t\t\t\tlet line = d3.select(this);\r\n\t\t\t\tlet type = this.parentNode.parentNode.dataset.axis;\r\n\t\t\t\tline.attr([type + '1'], 0.5)\r\n\t\t\t\tline.attr([type + '2'], 0.5)\r\n\t\t\t\tlet dir = type == 'x' ? 1 : -1\r\n\t\t\t\ttype = type == 'x' ? 'y' : 'x'\r\n\t\t\t\tline.attr([type + '2'], 4 * dir)\r\n\t\t\t})\r\n\r\n\t\tthis.chart_labels.selectAll('g')\r\n\t\t\t.append('text')\r\n\t\t\t.text(0)\r\n\t\t\t.each(function (d, i) {\r\n\t\t\t\tlet text = d3.select(this);\r\n\t\t\t\tlet type = this.parentNode.parentNode.dataset.axis;\r\n\t\t\t\tlet dir = type == 'x' ? 1 : -1\r\n\t\t\t\ttype = type == 'x' ? 'y' : 'x'\r\n\t\t\t\ttext.attr(type, 6 * dir)\r\n\t\t\t})\r\n\r\n\r\n\t\tthis.chart_line_x = this.chart.append('line')\r\n\t\t\t.attr('class', 'chart-axis')\r\n\t\t\t.attr('y1', 0.5)\r\n\t\t\t.attr('y2', 0.5)\r\n\t\t\t.attr('x2', 256)\r\n\t\t\t.style('pointer-events', 'none')\r\n\r\n\t\tthis.chart_line_y = this.chart.append('line')\r\n\t\t\t.attr('class', 'chart-axis')\r\n\t\t\t.attr('x1', 0.5)\r\n\t\t\t.attr('x2', 0.5)\r\n\t\t\t.attr('y2', -256)\r\n\t\t\t.style('pointer-events', 'none')\r\n\r\n\t\tthis.chart_selectors = d3.selectAll('.axis-list').data(['x', 'y'])\r\n\t\tthis.chart_selectors.selectAll('option')\r\n\t\t\t.data(__WEBPACK_IMPORTED_MODULE_0__global__[\"b\" /* indicators */].array)\r\n\t\t\t.enter()\r\n\t\t\t.append('option')\r\n\t\t\t.attr('value', d => d.key)\r\n\t\t\t.text(d => d.title)\r\n\r\n\t\t//-----------------------\r\n\t\t//-------Selectors-------\r\n\t\t//-----------------------\r\n\t\tthis.selectors = __WEBPACK_IMPORTED_MODULE_0__global__[\"b\" /* indicators */].array.filter(object => object.generate).map(object => new Selector(object))\r\n\r\n\t\tthis.buttons = d3.select('#timeline-container').selectAll('span')\r\n\t\t\t.data([2014, 2015, 2016, 2017])\r\n\r\n\t\tthis.initialization();\r\n\t}\r\n\tinitialization() {\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.redrawMapElements();\r\n\t\t\tthis.redrawChartElements();\r\n\t\t\tthis.pattern.select('line').transition().duration(1500).ease(d3.easeQuadOut)\r\n\t\t\t\t.style('opacity', 1)\r\n\r\n\t\t}, 1500)\r\n\t}\r\n\tredrawMapElements() {\r\n\t\tthis.routes.transition().duration(600).ease(d3.easeQuadOut)\r\n\t\t\t.style('stroke-width', data.attributes.zoom * 1)\r\n\t\tthis.buttons.text((d, i) => {\r\n\t\t\treturn __WEBPACK_IMPORTED_MODULE_0__global__[\"b\" /* indicators */][global.key].format_short(data.properties[global.key].median[i]);\r\n\t\t})\r\n\t\tthis.circles_fill//.transition().duration(600).ease(d3.easeQuadOut)\r\n\t\t\t.attr('r', d => d.attributes.circle_radius)\r\n\t\t\t.style('fill', d => {\r\n\t\t\t\tlet c = d3.color(d.attributes.circle_color);\r\n\t\t\t\tc.opacity = d.attributes.circle_opacity;\r\n\t\t\t\treturn c;\r\n\t\t\t})\r\n\t\t\t.style('stroke', d => d.attributes.circle_color)\r\n\t\t\t.style('stroke-width', d => 1.25 * d.attributes.circle_zoom + 'px');\r\n\r\n\t\tthis.circles_crown//.transition().duration(600).ease(d3.easeQuadOut)\r\n\t\t\t.attr('r', d => d.attributes.circle_radius + 2.5 * d.attributes.circle_zoom)\r\n\t\t\t.style('stroke', d => d.attributes.circle_color)\r\n\t\t\t.style('stroke-width', d => 1.25 * d.attributes.circle_zoom + 'px');\r\n\r\n\t\tthis.circles_halo.transition().duration(600).ease(d3.easeQuadOut)\r\n\t\t\t.attr('r', d => {\r\n\t\t\t\tlet x = d.properties.transit ? 6 : 3;\r\n\t\t\t\treturn d.attributes.circle_radius + x * d.attributes.circle_zoom;\r\n\t\t\t})\r\n\t}\r\n\tredrawChartElements() {\r\n\t\tthis.chart_dots\r\n\t\t\t.attr('cx', d => d.attributes.dot_x)\r\n\t\t\t.attr('cy', d => d.attributes.dot_y)\r\n\t\t\t.style('fill', d => d.attributes.circle_color)\r\n\t\t\t.style('r', d => d.attributes.visible ? 1 : 0)\r\n\r\n\t\tthis.chart_crowns\r\n\t\t\t.attr('cx', d => d.attributes.dot_x)\r\n\t\t\t.attr('cy', d => d.attributes.dot_y)\r\n\t\t\t.style('fill', d => __WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].white)\r\n\t\t\t.style('stroke', d => d.properties.transit ? d.attributes.circle_color : null)\r\n\t\t\t.style('r', d => d.attributes.visible ? 2 : 0)\r\n\r\n\t\tthis.chart_line_x.transition().duration(300).ease(d3.easeQuadOut)\r\n\t\t\t.attr('y1', data.attributes.chart_axis_y ? -127.5 : 0.5)\r\n\t\t\t.attr('y2', data.attributes.chart_axis_y ? -127.5 : 0.5)\r\n\r\n\t\tthis.chart_line_y.transition().duration(300).ease(d3.easeQuadOut)\r\n\t\t\t.attr('x1', data.attributes.chart_axis_x ? 128.5 : 0.5)\r\n\t\t\t.attr('x2', data.attributes.chart_axis_x ? 128.5 : 0.5)\r\n\t}\r\n\tchartFilter() {\r\n\t\tthis.chart_dots.classed('filtred', d => d.attributes.filtred)\r\n\t\tthis.chart_crowns.classed('filtred', d => d.attributes.filtred)\r\n\r\n\t\tthis.chart_area\r\n\t\t\t.attr('x', data.attributes.chart_x === false ? 0 : data.attributes.chart_x)\r\n\t\t\t.attr('y', data.attributes.chart_y === false ? -256 : data.attributes.chart_y)\r\n\t\t\t.attr('width', data.attributes.chart_x_active ? 64 : 256)\r\n\t\t\t.attr('height', data.attributes.chart_y_active ? 64 : 256)\r\n\t\t\t.attr('transform', `translate(0, ${data.attributes.chart_y_active ? 0 : -192})`)\r\n\t\t\t.attr('rx', data.attributes.chart_x_active && data.attributes.chart_y_active ? 8 : 0)\r\n\t\t\t.attr('ry', data.attributes.chart_x_active && data.attributes.chart_y_active ? 8 : 0)\r\n\r\n\t\tthis.chart_labels\r\n\t\t\t.style('transform', d => `translate${d.toUpperCase()}(${data.attributes['chart_' + d] + 32}px)`)\r\n\t\t\t.style('opacity', d => data.attributes['chart_' + d + '_active'] ? 1 : 0)\r\n\t\t\t.selectAll('g')\r\n\t\t\t.style('transform', function(d, i) {\r\n\t\t\t\tlet type = this.parentNode.dataset.axis\r\n\t\t\t\tlet s = `translate${type.toUpperCase()}(${i ? 32 : -32}px)`\r\n\t\t\t\treturn s;\r\n\t\t\t})\r\n\r\n\t\tthis.chart_labels.selectAll('text')\r\n\t\t\t.text(function (d) {\r\n\t\t\t\tlet type = this.parentNode.parentNode.dataset.axis;\r\n\t\t\t\treturn data.attributes['chart_' + type + '_format'](\r\n\t\t\t\t\tdata.attributes['chart_' + type + '_value'][d]\r\n\t\t\t\t);\r\n\t\t\t})\r\n\t\t\t.style('transform', function(d, i) {\r\n\t\t\t\tlet type = this.parentNode.parentNode.dataset.axis;\r\n\t\t\t\tlet dir = type == 'x' ? 1 : -1\r\n\t\t\t\tif(d == 'max' && !data.attributes['chart_' + type + '_active']) {\r\n\t\t\t\t\treturn `translate${type.toUpperCase()}(${192 * dir}px)`;\r\n\t\t\t\t}\telse {\r\n\t\t\t\t\treturn `translate${type.toUpperCase()}(0)`;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\tthis.chart_labels.selectAll('line')\r\n\t\t\t.style('transform', function(d, i) {\r\n\t\t\t\tlet type = this.parentNode.parentNode.dataset.axis;\r\n\t\t\t\tlet dir = type == 'x' ? 1 : -1\r\n\t\t\t\tif(d == 'max' && !data.attributes['chart_' + type + '_active']) {\r\n\t\t\t\t\treturn `translate${type.toUpperCase()}(${192 * dir}px)`;\r\n\t\t\t\t}\telse {\r\n\t\t\t\t\treturn `translate${type.toUpperCase()}(0)`;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\tthis.circles.classed('filtred', d => d.attributes.filtred)\r\n\t}\r\n}\r\n\r\n\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9lbGVtZW50cy5qcz9iODNiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluZGljYXRvcnMsIGNvbG9yIH0gZnJvbSAnLi9nbG9iYWwnO1xyXG5sZXQgZGF0YSwgcm91dGVzLCBnbG9iYWw7XHJcblxyXG5jbGFzcyBTdmdNYXAge1xyXG5cdGNvbnN0cnVjdG9yKGJhc2VtYXBQcm9wcywgc3ZnTWFwLCBzdmdPcmlnaW4pIHtcclxuXHRcdG1hcGJveGdsLmFjY2Vzc1Rva2VuID0gJ3BrLmV5SjFJam9pZHpKbGF5SXNJbUVpT2lJNE0yWkxPRVZKSW4wLmcwQTB6Qlp5NXJKejAwQTFmVmdEVGcnO1xyXG5cdFx0dGhpcy5iYXNlbWFwID0gbmV3IG1hcGJveGdsLk1hcChiYXNlbWFwUHJvcHMpO1xyXG5cdFx0dGhpcy5zdmcgPSBkMy5zZWxlY3QodGhpcy5iYXNlbWFwLmdldENhbnZhc0NvbnRhaW5lcigpLmFwcGVuZENoaWxkKHN2Z01hcC5kb2N1bWVudEVsZW1lbnQpKVxyXG5cdFx0XHQuYXR0cignaWQnLCAnbWFwJyk7XHJcblx0XHR0aGlzLmNvbnRhaW5lciA9IHRoaXMuc3ZnLmFwcGVuZCgnZycpO1xyXG5cdFx0dGhpcy5jb250YWluZXIubG9uID0gc3ZnT3JpZ2luLmxvbjtcclxuXHRcdHRoaXMuY29udGFpbmVyLmxhdCA9IHN2Z09yaWdpbi5sYXQ7XHJcblx0XHR0aGlzLmNvbnRhaW5lci56ID0gc3ZnT3JpZ2luLno7XHJcblx0XHR0aGlzLmJhc2VtYXAub24oJ21vdmUnLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMubW92ZU1hcCgpO1xyXG5cdFx0fSk7XHJcblx0XHR0aGlzLmJhc2VtYXAub24oJ21vdXNlbW92ZScsIChlKSA9PiB7XHJcblx0XHRcdHRoaXMuYmFzZW1hcC5tb3VzZSA9IGUubG5nTGF0O1xyXG5cdFx0fSlcclxuXHR9XHJcblx0bW92ZU1hcCgpIHtcclxuXHRcdHRoaXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuXHRcdHRoaXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xyXG5cdFx0dGhpcy56ID0gTWF0aC5wb3coMiwgdGhpcy5iYXNlbWFwLmdldFpvb20oKSAtIHRoaXMuY29udGFpbmVyLnopO1xyXG5cdFx0dGhpcy5vZmZzZXQgPSBuZXcgT2JqZWN0KCk7XHJcblx0XHR0aGlzLm9mZnNldC54ID0gKHRoaXMucHJvamVjdCh0aGlzLmNvbnRhaW5lci5sb24sIHRoaXMuY29udGFpbmVyLmxhdCkpLng7XHJcblx0XHR0aGlzLm9mZnNldC55ID0gKHRoaXMucHJvamVjdCh0aGlzLmNvbnRhaW5lci5sb24sIHRoaXMuY29udGFpbmVyLmxhdCkpLnk7XHJcblx0XHR0aGlzLmNvbnRhaW5lci5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7dGhpcy5vZmZzZXQueH0sICR7dGhpcy5vZmZzZXQueX0pIHNjYWxlKCR7dGhpcy56fSlgKTtcclxuXHRcdGQzLnNlbGVjdCgnI3pvbmVfbWFzaycpLnNlbGVjdCgnZycpLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHt0aGlzLm9mZnNldC54fSwgJHt0aGlzLm9mZnNldC55fSkgc2NhbGUoJHt0aGlzLnp9KWApO1xyXG5cdH1cclxuXHRwcm9qZWN0KGxvbiwgbGF0KSB7XHJcblx0XHRyZXR1cm4gdGhpcy5iYXNlbWFwLnByb2plY3QoZnVuY3Rpb24gZ2V0TEwoKSB7XHJcblx0XHRcdHJldHVybiBuZXcgbWFwYm94Z2wuTG5nTGF0KGxvbiwgbGF0KVxyXG5cdFx0fSgpKTtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIE1hcCBleHRlbmRzIFN2Z01hcCB7XHJcblx0Y29uc3RydWN0b3IoaW5jb21pbmcpIHtcclxuXHRcdHN1cGVyKFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Y29udGFpbmVyOiAnYmFzZW1hcCcsXHJcblx0XHRcdFx0c3R5bGU6ICdtYXBib3g6Ly9zdHlsZXMvdzJlay9jamFjajN5dGo0Y3NhMnJwa2thMDRwZWZhJyxcclxuXHRcdFx0XHRjZW50ZXI6IFszNy42MiwgNTUuNzNdLFxyXG5cdFx0XHRcdHpvb206IDEwLjUsXHJcblx0XHRcdFx0c2Nyb2xsWm9vbTogZmFsc2VcclxuXHRcdFx0fSwgaW5jb21pbmcsIHtcdCdsb24nOiAzNy40NzAyNDUsICdsYXQnOiA1NS44NTgzMSwgJ3onOiAxMC41fVxyXG5cdFx0KTtcclxuXHRcdHRoaXMubW92ZU1hcCgpO1xyXG5cdH1cclxufVxyXG5jbGFzcyBTZWxlY3RvciB7XHJcblx0Y29uc3RydWN0b3IoYXJncykge1xyXG5cdFx0dGhpcy50aXRsZSA9IGFyZ3MudGl0bGU7XHJcblx0XHR0aGlzLmtleSA9IGFyZ3Mua2V5O1xyXG5cdFx0dGhpcy5pbmRpY2F0b3IgPSBhcmdzO1xyXG5cdFx0dGhpcy5jb250YWluZXIgPSBkMy5zZWxlY3QoJyNncmFwaHMnKS5hcHBlbmQoJ2RpdicpXHJcblx0XHR0aGlzLmlucHV0ID0gdGhpcy5jb250YWluZXIuYXBwZW5kKCdpbnB1dCcpXHJcblx0XHRcdC5kYXR1bSh0aGlzKVxyXG5cdFx0XHQuYXR0cigndHlwZScsICdyYWRpbycpXHJcblx0XHRcdC5hdHRyKCduYW1lJywgJ21vZGUnKVxyXG5cdFx0XHQuYXR0cigndmFsdWUnLCB0aGlzLmtleSlcclxuXHRcdFx0LmF0dHIoJ2lkJywgJ3NlbGVjdF8nICsgdGhpcy5rZXkpXHJcblx0XHRcdC5zdHlsZSgnZGlzcGxheScsICdub25lJylcclxuXHJcblx0XHR0aGlzLmNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLmFwcGVuZCgnbGFiZWwnKVxyXG5cdFx0XHQuYXR0cignZm9yJywgJ3NlbGVjdF8nICsgdGhpcy5rZXkpXHJcblxyXG5cdFx0dGhpcy5jb250YWluZXIuYXBwZW5kKCdkaXYnKVxyXG5cdFx0XHQuYXR0cignY2xhc3MnLCAnc2VsZWN0b3ItaGVhZGVyJylcclxuXHRcdFx0LmFwcGVuZCgnc3BhbicpXHJcblx0XHRcdC50ZXh0KHRoaXMudGl0bGUpXHJcblxyXG5cdFx0dGhpcy5zdmcgPSB0aGlzLmNvbnRhaW5lci5hcHBlbmQoJ2RpdicpXHJcblx0XHRcdC5hdHRyKCdjbGFzcycsICdzZWxlY3Rvci1jb250ZW50JylcclxuXHRcdFx0LmFwcGVuZCgnc3ZnJylcclxuXHRcdFx0LmFwcGVuZCgnZycpXHJcblx0XHRcdC5hdHRyKCdjbGFzcycsICdzZWxlY3Rvci1jb250YWluZXInKVxyXG5cclxuXHRcdHRoaXMuZ3VpZGVzID0gdGhpcy5zdmdcclxuXHRcdFx0LmFwcGVuZCgnZycpXHJcblx0XHRcdC5zZWxlY3RBbGwoJ2cnKVxyXG5cdFx0XHQuZGF0YShbXHJcblx0XHRcdFx0eyd4JzogMi41LCAndHlwZSc6ICdtaW4nfSxcclxuXHRcdFx0XHR7J3gnOiA2NC41LCAndHlwZSc6ICdRMSd9LFxyXG5cdFx0XHRcdHsneCc6IDEyOC41LCAndHlwZSc6ICdtZWRpYW4nfSxcclxuXHRcdFx0XHR7J3gnOiAxOTIuNSwgJ3R5cGUnOiAnUTMnfSxcclxuXHRcdFx0XHR7J3gnOiAyNTQuNSwgJ3R5cGUnOiAnbWF4J31cclxuXHRcdFx0XSlcclxuXHRcdFx0LmVudGVyKClcclxuXHRcdFx0LmFwcGVuZCgnZycpXHJcblx0XHRcdC5hdHRyKCdjbGFzcycsICdzZWxlY3Rvci1ndWlkZScpXHJcblx0XHRcdC5zdHlsZSgndHJhbnNmb3JtJywgZCA9PiBgdHJhbnNsYXRlWCgke2QueH1weClgKVxyXG5cclxuXHRcdHRoaXMuZ3VpZGVzLmFwcGVuZCgnbGluZScpXHJcblxyXG5cdFx0dGhpcy5ndWlkZXMuYXBwZW5kKCd0ZXh0JylcclxuXHRcdFx0LnRleHQoZCA9PiBkLnR5cGUpXHJcblx0XHRcdC5hdHRyKCd5JywgMTYpXHJcblxyXG5cdFx0dGhpcy5iYXJzID0gYXJncy5nZW5lcmF0ZSh0aGlzLnN2Zyk7XHJcblx0XHR0aGlzLm51bV9oYWxvID0gdGhpcy5zdmcuc2VsZWN0KCcuYmFyLWNvbnRhaW5lcicpXHJcblx0XHRcdC5hcHBlbmQoJ3RleHQnKVxyXG5cdFx0XHQuZGF0dW0odGhpcylcclxuXHRcdFx0LmF0dHIoJ2NsYXNzJywgJ3NlbGVjdG9yLW51bS1oYWxvJylcclxuXHRcdFx0LmF0dHIoJ3knLCAyKVxyXG5cdFx0XHQuYXR0cigneCcsIDEyOClcclxuXHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcclxuXHJcblx0XHR0aGlzLm51bSA9IHRoaXMuc3ZnLnNlbGVjdCgnLmJhci1jb250YWluZXInKVxyXG5cdFx0XHQuYXBwZW5kKCd0ZXh0JylcclxuXHRcdFx0LmRhdHVtKHRoaXMpXHJcblx0XHRcdC5hdHRyKCdjbGFzcycsICdzZWxlY3Rvci1udW0nKVxyXG5cdFx0XHQuYXR0cigneScsIDIpXHJcblx0XHRcdC5hdHRyKCd4JywgMTI4KVxyXG5cdFx0XHQuc3R5bGUoJ29wYWNpdHknLCAwKVxyXG5cdFx0dGhpcy5sZWdlbmQgPSB0aGlzLnN2Zy5hcHBlbmQoJ2cnKVxyXG5cdFx0XHQuYXR0cignY2xhc3MnLCAnc2VsZWN0b3ItbGVnZW5kJylcclxuXHJcblx0XHRpZih0aGlzLmluZGljYXRvci5sZWdlbmQpIHtcclxuXHRcdFx0bGV0IG5vZGUgPSB0aGlzLmxlZ2VuZC5zZWxlY3RBbGwoJ2cnKVxyXG5cdFx0XHRcdC5kYXRhKHRoaXMuaW5kaWNhdG9yLmxlZ2VuZClcclxuXHRcdFx0XHQuZW50ZXIoKVxyXG5cdFx0XHRcdC5hcHBlbmQoJ2cnKVxyXG5cdFx0XHRcdC5zdHlsZSgndHJhbnNmb3JtJywgKGQsIGkpID0+IGB0cmFuc2xhdGVYKCR7aSA/IDI1NC41IDogMi41IH1weClgKVxyXG5cdFx0XHRub2RlLmFwcGVuZCgnbGluZScpXHJcblx0XHRcdFx0LmF0dHIoJ3kyJywgLTcpXHJcblx0XHRcdFx0LnN0eWxlKCdzdHJva2UnLCAoZCwgaSkgPT4gaSA/IGNvbG9yLmNvbGQgOiBjb2xvci5ob3QpXHJcblxyXG5cdFx0XHRub2RlLmFwcGVuZCgndGV4dCcpXHJcblx0XHRcdFx0LnRleHQoZCA9PiBkKVxyXG5cclxuXHRcdH1cclxuXHRcdHRoaXMuem9uZSA9IHRoaXMuc3ZnLmFwcGVuZCgncmVjdCcpXHJcblx0XHQuYXR0cignY2xhc3MnLCAnc3ZnLWFyZWEnKVxyXG5cdFx0LmF0dHIoJ3dpZHRoJywgMjU2KVxyXG5cdFx0Ly8gaWYodGhpcy5pbmRpY2F0b3IuYWx0ZXJuYXRpdmUpIHtcclxuXHRcdC8vIFx0dGhpcy5sZWdlbmQuYXBwZW5kKCd0ZXh0JylcclxuXHRcdC8vIFx0XHQuc2VsZWN0QWxsKCd0c3BhbicpXHJcblx0XHQvLyBcdFx0LmRhdGEodGhpcy5pbmRpY2F0b3IuYWx0ZXJuYXRpdmUpXHJcblx0XHQvLyBcdFx0LmVudGVyKClcclxuXHRcdC8vIFx0XHQuYXBwZW5kKCd0c3BhbicpXHJcblx0XHQvLyBcdFx0LnRleHQoKGQsIGkpID0+IGkgPyAnIHwgJyArIGQudGl0bGUgOiBkLnRpdGxlKVxyXG5cdFx0Ly8gfVxyXG5cclxuXHJcblx0XHR0aGlzLnJlZHJhdygpO1xyXG5cdFx0dGhpcy5mb2xkKCk7XHJcblx0fVxyXG5cdHJlZHJhdygpIHtcclxuXHRcdHRoaXMuYmFycy50cmFuc2l0aW9uKCkuZGVsYXkoMTAwKS5kdXJhdGlvbigyMDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHRcdC5zdHlsZSgnc3Ryb2tlJywgKGQsIGkpID0+IGQucmFuZ2VbaV0pXHJcblx0fVxyXG5cdHVuZm9sZCgpIHtcclxuXHRcdHRoaXMuaW5wdXQuY2xhc3NlZCgnY2hlY2tlZCcsIHRydWUpXHJcblx0XHR0aGlzLmd1aWRlcy50cmFuc2l0aW9uKCkuZGVsYXkoMTAwKS5kdXJhdGlvbigyMDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHRcdC5zZWxlY3RBbGwoJ2xpbmUnKVxyXG5cdFx0XHQuYXR0cigneTInLCAtODkpXHJcblx0XHR0aGlzLmxlZ2VuZC5zdHlsZSgndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZVkoLTEwMHB4KScpXHJcblx0XHRcdC50cmFuc2l0aW9uKCkuZGVsYXkoMzAwKS5kdXJhdGlvbigyMDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHRcdC5zdHlsZSgnb3BhY2l0eScsIDEpXHJcblxyXG5cdFx0dGhpcy5iYXJzLmNhbGwodGhpcy5pbmRpY2F0b3IudW5mb2xkKVxyXG5cdH1cclxuXHRmb2xkKCkge1xyXG5cdFx0dGhpcy5pbnB1dC5jbGFzc2VkKCdjaGVja2VkJywgZmFsc2UpXHJcblx0XHR0aGlzLmd1aWRlcy50cmFuc2l0aW9uKCkuZGVsYXkoMTAwKS5kdXJhdGlvbigyMDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHRcdC5zZWxlY3RBbGwoJ2xpbmUnKVxyXG5cdFx0XHQuYXR0cigneTInLCAtNClcclxuXHRcdHRoaXMubGVnZW5kLnRyYW5zaXRpb24oKS5kZWxheSgxMDApLmR1cmF0aW9uKDIwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcclxuXHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcclxuXHRcdFx0Lm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0ZDMuc2VsZWN0KHRoaXMpLnN0eWxlKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlWSgwKScpXHJcblx0XHRcdH0pXHJcblxyXG5cdFx0dGhpcy5iYXJzLmNhbGwodGhpcy5pbmRpY2F0b3IuZm9sZClcclxuXHR9XHJcbn1cclxuY2xhc3MgRWxlbWVudHMge1xyXG5cdGNvbnN0cnVjdG9yKC4uLmluY29taW5nKSB7XHJcblx0XHRbZGF0YSwgZ2xvYmFsLCB0aGlzLm1hcCwgdGhpcy5nZW9QYXRoXSA9IGluY29taW5nO1xyXG5cclxuXHRcdHRoaXMubGF5ZXIgPSB0aGlzLm1hcC5jb250YWluZXJcclxuXHRcdHRoaXMuZGVmcyA9IHRoaXMubGF5ZXIuYXBwZW5kKCdkZWZzJyk7XHJcblxyXG5cdFx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cdFx0Ly8tLS0tLS0tWm9uZSBNYXNrLS0tLS0tLVxyXG5cdFx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cdFx0dGhpcy5kZWZzLmFwcGVuZCgnbWFzaycpXHJcblx0XHRcdC5hdHRyKCdpZCcsICd6b25lX21hc2snKVxyXG5cdFx0XHQuYXBwZW5kKCdyZWN0JylcclxuXHRcdFx0LmF0dHIoJ3gnLCAtNDAwMClcclxuXHRcdFx0LmF0dHIoJ3knLCAtNDAwMClcclxuXHRcdFx0LmF0dHIoJ3dpZHRoJywgNTEwLjEzICsgODAwMClcclxuXHRcdFx0LmF0dHIoJ2hlaWdodCcsIDgzOC44MSArIDgwMDApXHJcblx0XHRcdC5zdHlsZSgnZmlsbCcsICd3aGl0ZScpXHJcblxyXG5cdFx0dGhpcy56b25lcyA9IHRoaXMuZGVmcy5zZWxlY3QoJ21hc2snKVxyXG5cdFx0XHQuYXBwZW5kKCdnJylcclxuXHJcblx0XHR0aGlzLnBhdHRlcm4gPSB0aGlzLm1hcC5zdmcuaW5zZXJ0KCdkZWZzJywgJ2cnKVxyXG5cdFx0XHQuYXBwZW5kKCdwYXR0ZXJuJylcclxuXHRcdFx0LmF0dHIoJ2lkJywgJ3BhdHRlcm4tbWFwJylcclxuXHRcdFx0LmF0dHIoJ3dpZHRoJywgNilcclxuXHRcdFx0LmF0dHIoJ2hlaWdodCcsIDYpXHJcblx0XHRcdC5hdHRyKCdwYXR0ZXJuVW5pdHMnLCAndXNlclNwYWNlT25Vc2UnKVxyXG5cdFx0XHQuYXR0cigndmlld0JveCcsICcwIDAgNiA2JylcclxuXHRcdFx0Ly8gLmF0dHIoJ3BhdHRlcm5UcmFuc2Zvcm0nLCBgcm90YXRlKDQ1KSBzY2FsZSgwKWApO1xyXG5cdFx0XHQuYXR0cigncGF0dGVyblRyYW5zZm9ybScsICdyb3RhdGUoNDUpJyk7XHJcblxyXG5cdFx0dGhpcy5wYXR0ZXJuLmFwcGVuZCgnbGluZScpXHJcblx0XHRcdC5hdHRyKCd4MScsIDApXHJcblx0XHRcdC5hdHRyKCd5MScsIDAuNSlcclxuXHRcdFx0LmF0dHIoJ3gyJywgOClcclxuXHRcdFx0LmF0dHIoJ3kyJywgMC41KVxyXG5cdFx0XHQuYXR0cignc3R5bGUnLCBgb3BhY2l0eTogMDsgc3Ryb2tlLXdpZHRoOiAxcHg7IHN0cm9rZTogJHtjb2xvci5ncmV5fTsgc3Ryb2tlLWxpbmVjYXA6IHNxdWFyZTsgc2hhcGUtcmVuZGVyaW5nOiBjcmlzcEVkZ2VzYClcclxuXHJcblx0XHR0aGlzLm1hcC5zdmcuaW5zZXJ0KCdyZWN0JywgJ2cnKVxyXG5cdFx0XHQuYXR0cigneCcsIC00MDAwKVxyXG5cdFx0XHQuYXR0cigneScsIC00MDAwKVxyXG5cdFx0XHQuYXR0cignd2lkdGgnLCA1MTAuMTMgKyA4MDAwKVxyXG5cdFx0XHQuYXR0cignaGVpZ2h0JywgODM4LjgxICsgODAwMClcclxuXHRcdFx0LmF0dHIoJ2ZpbGwnLCAndXJsKCNwYXR0ZXJuLW1hcCknKVxyXG5cdFx0XHQuYXR0cignbWFzaycsICd1cmwoI3pvbmVfbWFzayknKVxyXG5cdFx0XHQuYXR0cignaWQnLCAnb3ZlcmxheScpXHJcblxyXG5cdFx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHRcdC8vLS0tLS0tLVJvdXRlcy0tLS0tLS1cclxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cdFx0Ly8gY29uc29sZS5sb2cocm91dGVzLmFyY3MpO1xyXG5cdFx0dGhpcy5yb3V0ZXMgPSB0aGlzLmxheWVyLmFwcGVuZCgnZycpXHJcblx0XHRcdC5hdHRyKCdpZCcsICdjaXJjbGVzLWNvbnRhaW5lcicpXHJcblx0XHRcdC5zZWxlY3RBbGwoJ2cnKVxyXG5cdFx0XHQuZGF0YShkYXRhLmZlYXR1cmVzKVxyXG5cdFx0XHQuZW50ZXIoKVxyXG5cdFx0XHQuYXBwZW5kKCdnJylcclxuXHRcdFx0Ly8gLnNlbGVjdEFsbCgncGF0aCcpXHJcblx0XHRcdC8vIC5kYXRhKHJvdXRlcy5hcmNzLm1hcCgoY29vcmRpbmF0ZXMsIGkpID0+IHR1cmYubGluZVN0cmluZyhjb29yZGluYXRlcywge1x0J2lkJzogaVx0fSkpKVxyXG5cdFx0XHQvLyAuZW50ZXIoKVxyXG5cdFx0XHQvLyAuYXBwZW5kKCdwYXRoJylcclxuXHRcdFx0Ly8gLmF0dHIoJ2NsYXNzJywgJ3JvdXRlIGZpbHRyZWQnKVxyXG5cdFx0XHQvLyAuYXR0cignZCcsIHRoaXMuZ2VvUGF0aClcclxuXHRcdFx0Ly8gLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKVxyXG5cclxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblx0XHQvLy0tLS0tLS1DaXJjbGVzLS0tLS0tLVxyXG5cdFx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHRcdHRoaXMuY2lyY2xlcyA9IHRoaXMubGF5ZXIuc2VsZWN0KCcjY2lyY2xlcy1jb250YWluZXInKVxyXG5cdFx0XHQuc2VsZWN0QWxsKG51bGwpXHJcblx0XHRcdC5kYXRhKGRhdGEuZmVhdHVyZXMpXHJcblx0XHRcdC5lbnRlcigpXHJcblx0XHRcdC5hcHBlbmQoJ2cnKVxyXG5cdFx0XHQuYXR0cignaWQnLCBkID0+ICdzdGF0aW9uXycgKyBkLnByb3BlcnRpZXMuaWQpXHJcblx0XHRcdC5hdHRyKCdjbGFzcycsICdjaXJjbGUtY29udGFpbmVyJylcclxuXHRcdFx0LmF0dHIoJ3RyYW5zZm9ybScsIGQgPT4gYHRyYW5zbGF0ZSgke2QuYXR0cmlidXRlcy5jaXJjbGVfY29vcmRpbmF0ZXMuam9pbignLCAnKX0pYCk7XHJcblxyXG5cdFx0dGhpcy5jaXJjbGVzX2ZpbGwgPSB0aGlzLmNpcmNsZXNcclxuXHRcdFx0LmFwcGVuZCgnY2lyY2xlJylcclxuXHRcdFx0LmF0dHIoJ2NsYXNzJywgJ2NpcmNsZS1maWxsJylcclxuXHRcdFx0LmF0dHIoJ3InLCAwKTtcclxuXHJcblx0XHR0aGlzLmNpcmNsZXNfY3Jvd24gPSB0aGlzLmNpcmNsZXMuZmlsdGVyKGQgPT4gZC5wcm9wZXJ0aWVzLnRyYW5zaXQpXHJcblx0XHRcdC5hcHBlbmQoJ2NpcmNsZScpXHJcblx0XHRcdC5hdHRyKCdjbGFzcycsICdjaXJjbGUtY3Jvd24nKVxyXG5cdFx0XHQuYXR0cigncicsIDApO1xyXG5cclxuXHRcdHRoaXMuY2lyY2xlc19oYWxvID0gdGhpcy56b25lcy5hcHBlbmQoJ2cnKVxyXG5cdFx0XHQuc2VsZWN0QWxsKCdjaXJjbGUnKVxyXG5cdFx0XHQuZGF0YShkYXRhLmZlYXR1cmVzKVxyXG5cdFx0XHQuZW50ZXIoKVxyXG5cdFx0XHQuYXBwZW5kKCdjaXJjbGUnKVxyXG5cdFx0XHQuYXR0cignY2xhc3MnLCAnY2lyY2xlLWhhbG8nKVxyXG5cdFx0XHQuYXR0cignY3gnLCBkID0+IGQuYXR0cmlidXRlcy5jaXJjbGVfY29vcmRpbmF0ZXNbMF0pXHJcblx0XHRcdC5hdHRyKCdjeScsIGQgPT4gZC5hdHRyaWJ1dGVzLmNpcmNsZV9jb29yZGluYXRlc1sxXSlcclxuXHRcdFx0LmF0dHIoJ3InLCAwKTtcclxuXHJcblx0XHR0aGlzLmNpcmNsZXMuc29ydChkID0+IGQucHJvcGVydGllcy50cmFuc2l0KVxyXG5cclxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHRcdC8vLS0tLS0tLUNoYXJ0cGxvdC0tLS0tLS1cclxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHRcdHRoaXMuY2hhcnQgPSBkMy5zZWxlY3QoJyNjaGFydHBsb3QnKVxyXG5cdFx0dGhpcy5jaGFydC5hcHBlbmQoJ2RlZnMnKS5ub2RlKClcclxuXHRcdFx0LmFwcGVuZENoaWxkKGQzLnNlbGVjdCgnI3BhdHRlcm4tbWFwJykubm9kZSgpLmNsb25lTm9kZSh0cnVlKSlcclxuXHJcblx0XHR0aGlzLmNoYXJ0LnNlbGVjdCgnI3BhdHRlcm4tbWFwJylcclxuXHRcdFx0LmF0dHIoJ2lkJywgJ3BhdHRlcm4tY2hhcnQnKVxyXG5cdFx0XHQuc2VsZWN0KCdsaW5lJykuc3R5bGUoJ29wYWNpdHknLCBudWxsKTtcclxuXHJcblx0XHR0aGlzLmNoYXJ0ID0gdGhpcy5jaGFydC5hcHBlbmQoJ2cnKVxyXG5cdFx0XHQuZGF0dW0oeydwaW5uZWQnOiBmYWxzZX0pXHJcblx0XHRcdC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsIDI1NiknKTtcclxuXHJcblx0XHR0aGlzLmNoYXJ0LmFwcGVuZCgncmVjdCcpXHJcblx0XHRcdC5hdHRyKCd4JywgLTMyKVxyXG5cdFx0XHQuYXR0cigneScsIC0yNTYpXHJcblx0XHRcdC5hdHRyKCd3aWR0aCcsIDI1NiArIDMyKVxyXG5cdFx0XHQuYXR0cignaGVpZ2h0JywgMjU2KVxyXG5cdFx0XHQuc3R5bGUoJ29wYWNpdHknLCAwKVxyXG5cclxuXHRcdHRoaXMuY2hhcnQuYXBwZW5kKCdyZWN0JylcclxuXHRcdFx0LmF0dHIoJ3knLCAtMjU2KVxyXG5cdFx0XHQuYXR0cignd2lkdGgnLCAyNTYpXHJcblx0XHRcdC5hdHRyKCdoZWlnaHQnLCAyNTYgKyAzMilcclxuXHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcclxuXHJcblx0XHR0aGlzLmNoYXJ0X2JhY2tncm91bmQgPSB0aGlzLmNoYXJ0XHJcblx0XHRcdC5hcHBlbmQoJ3JlY3QnKVxyXG5cdFx0XHQuYXR0cignaWQnLCAnY2hhcnQtYmFja2dyb3VuZCcpXHJcblx0XHRcdC5hdHRyKCd5JywgLTI1NilcclxuXHRcdFx0LmF0dHIoJ3dpZHRoJywgMjU2KVxyXG5cdFx0XHQuYXR0cignaGVpZ2h0JywgMjU2KVxyXG5cdFx0XHQuYXR0cignZmlsbCcsICd1cmwoI3BhdHRlcm4tY2hhcnQpJylcclxuXHRcdFx0LnN0eWxlKCdvcGFjaXR5JywgMClcclxuXHJcblx0XHR0aGlzLmNoYXJ0X2FyZWEgPSB0aGlzLmNoYXJ0XHJcblx0XHRcdC5hcHBlbmQoJ3JlY3QnKVxyXG5cdFx0XHQuYXR0cignaWQnLCAnY2hhcnQtYXJlYScpXHJcblx0XHRcdC5hdHRyKCd3aWR0aCcsIDY0KVxyXG5cdFx0XHQuYXR0cignaGVpZ2h0JywgNjQpXHJcblx0XHRcdC5zdHlsZSgnb3BhY2l0eScsIDApXHJcblx0XHRcdC5zdHlsZSgnZmlsbCcsIGNvbG9yLmdyZXkpXHJcblxyXG5cdFx0dGhpcy5jaGFydF9kb3RzID0gdGhpcy5jaGFydFxyXG5cdFx0XHQuYXBwZW5kKCdnJylcclxuXHRcdFx0LnNlbGVjdEFsbCgnY2lyY2xlJylcclxuXHRcdFx0LmRhdGEoZGF0YS5mZWF0dXJlcy5maWx0ZXIoZmVhdHVyZSA9PiAhZmVhdHVyZS5wcm9wZXJ0aWVzLnRyYW5zaXQpKVxyXG5cdFx0XHQuZW50ZXIoKVxyXG5cdFx0XHQuYXBwZW5kKCdjaXJjbGUnKVxyXG5cdFx0XHQuYXR0cignY2xhc3MnLCAnY2hhcnQtZG90JylcclxuXHRcdFx0LnN0eWxlKCdwb2ludGVyLWV2ZW50cycsICdub25lJylcclxuXHJcblx0XHR0aGlzLmNoYXJ0X2Nyb3ducyA9IHRoaXMuY2hhcnRcclxuXHRcdFx0LmFwcGVuZCgnZycpXHJcblx0XHRcdC5zZWxlY3RBbGwoJ2NpcmNsZScpXHJcblx0XHRcdC5kYXRhKGRhdGEuZmVhdHVyZXMuZmlsdGVyKGZlYXR1cmUgPT4gZmVhdHVyZS5wcm9wZXJ0aWVzLnRyYW5zaXQpKVxyXG5cdFx0XHQuZW50ZXIoKVxyXG5cdFx0XHQuYXBwZW5kKCdjaXJjbGUnKVxyXG5cdFx0XHQuYXR0cignY2xhc3MnLCAnY2hhcnQtY3Jvd24nKVxyXG5cdFx0XHQuc3R5bGUoJ3BvaW50ZXItZXZlbnRzJywgJ25vbmUnKVxyXG5cclxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHRcdC8vLS0tLS0tLUNoYXJ0IExhYmVscy0tLS0tLS1cclxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHRcdHRoaXMuY2hhcnRfbGFiZWxzID0gdGhpcy5jaGFydFxyXG5cdFx0XHQuc2VsZWN0QWxsKG51bGwpXHJcblx0XHRcdC5kYXRhKFsneCcsICd5J10pXHJcblx0XHRcdC5lbnRlcigpXHJcblx0XHRcdC5hcHBlbmQoJ2cnKVxyXG5cdFx0XHQuYXR0cignY2xhc3MnLCAnY2hhcnQtdGlja3MnKVxyXG5cdFx0XHQuYXR0cignZGF0YS1heGlzJywgZCA9PiBkKVxyXG5cdFx0XHQuc3R5bGUoJ29wYWNpdHknLCAwKVxyXG5cclxuXHRcdHRoaXMuY2hhcnRfbGFiZWxzLnNlbGVjdEFsbCgnZycpXHJcblx0XHRcdC5kYXRhKGQgPT4ge1xyXG5cdFx0XHRcdGxldCBhID0gWydtaW4nLCAnbWF4J107XHJcblx0XHRcdFx0aWYoZCA9PSAneScpIGEucmV2ZXJzZSgpO1xyXG5cdFx0XHRcdHJldHVybiBhO1xyXG5cdFx0XHR9KS5lbnRlcigpXHJcblx0XHRcdC5hcHBlbmQoJ2cnKTtcclxuXHRcdHRoaXMuY2hhcnRfbGFiZWxzLnNlbGVjdEFsbCgnZycpLmFwcGVuZCgnbGluZScpXHJcblx0XHRcdC5hdHRyKCdjbGFzcycsICdjaGFydC1heGlzJylcclxuXHRcdFx0LmVhY2goZnVuY3Rpb24gKGQsIGkpIHtcclxuXHRcdFx0XHRsZXQgbGluZSA9IGQzLnNlbGVjdCh0aGlzKTtcclxuXHRcdFx0XHRsZXQgdHlwZSA9IHRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlLmRhdGFzZXQuYXhpcztcclxuXHRcdFx0XHRsaW5lLmF0dHIoW3R5cGUgKyAnMSddLCAwLjUpXHJcblx0XHRcdFx0bGluZS5hdHRyKFt0eXBlICsgJzInXSwgMC41KVxyXG5cdFx0XHRcdGxldCBkaXIgPSB0eXBlID09ICd4JyA/IDEgOiAtMVxyXG5cdFx0XHRcdHR5cGUgPSB0eXBlID09ICd4JyA/ICd5JyA6ICd4J1xyXG5cdFx0XHRcdGxpbmUuYXR0cihbdHlwZSArICcyJ10sIDQgKiBkaXIpXHJcblx0XHRcdH0pXHJcblxyXG5cdFx0dGhpcy5jaGFydF9sYWJlbHMuc2VsZWN0QWxsKCdnJylcclxuXHRcdFx0LmFwcGVuZCgndGV4dCcpXHJcblx0XHRcdC50ZXh0KDApXHJcblx0XHRcdC5lYWNoKGZ1bmN0aW9uIChkLCBpKSB7XHJcblx0XHRcdFx0bGV0IHRleHQgPSBkMy5zZWxlY3QodGhpcyk7XHJcblx0XHRcdFx0bGV0IHR5cGUgPSB0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZS5kYXRhc2V0LmF4aXM7XHJcblx0XHRcdFx0bGV0IGRpciA9IHR5cGUgPT0gJ3gnID8gMSA6IC0xXHJcblx0XHRcdFx0dHlwZSA9IHR5cGUgPT0gJ3gnID8gJ3knIDogJ3gnXHJcblx0XHRcdFx0dGV4dC5hdHRyKHR5cGUsIDYgKiBkaXIpXHJcblx0XHRcdH0pXHJcblxyXG5cclxuXHRcdHRoaXMuY2hhcnRfbGluZV94ID0gdGhpcy5jaGFydC5hcHBlbmQoJ2xpbmUnKVxyXG5cdFx0XHQuYXR0cignY2xhc3MnLCAnY2hhcnQtYXhpcycpXHJcblx0XHRcdC5hdHRyKCd5MScsIDAuNSlcclxuXHRcdFx0LmF0dHIoJ3kyJywgMC41KVxyXG5cdFx0XHQuYXR0cigneDInLCAyNTYpXHJcblx0XHRcdC5zdHlsZSgncG9pbnRlci1ldmVudHMnLCAnbm9uZScpXHJcblxyXG5cdFx0dGhpcy5jaGFydF9saW5lX3kgPSB0aGlzLmNoYXJ0LmFwcGVuZCgnbGluZScpXHJcblx0XHRcdC5hdHRyKCdjbGFzcycsICdjaGFydC1heGlzJylcclxuXHRcdFx0LmF0dHIoJ3gxJywgMC41KVxyXG5cdFx0XHQuYXR0cigneDInLCAwLjUpXHJcblx0XHRcdC5hdHRyKCd5MicsIC0yNTYpXHJcblx0XHRcdC5zdHlsZSgncG9pbnRlci1ldmVudHMnLCAnbm9uZScpXHJcblxyXG5cdFx0dGhpcy5jaGFydF9zZWxlY3RvcnMgPSBkMy5zZWxlY3RBbGwoJy5heGlzLWxpc3QnKS5kYXRhKFsneCcsICd5J10pXHJcblx0XHR0aGlzLmNoYXJ0X3NlbGVjdG9ycy5zZWxlY3RBbGwoJ29wdGlvbicpXHJcblx0XHRcdC5kYXRhKGluZGljYXRvcnMuYXJyYXkpXHJcblx0XHRcdC5lbnRlcigpXHJcblx0XHRcdC5hcHBlbmQoJ29wdGlvbicpXHJcblx0XHRcdC5hdHRyKCd2YWx1ZScsIGQgPT4gZC5rZXkpXHJcblx0XHRcdC50ZXh0KGQgPT4gZC50aXRsZSlcclxuXHJcblx0XHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblx0XHQvLy0tLS0tLS1TZWxlY3RvcnMtLS0tLS0tXHJcblx0XHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblx0XHR0aGlzLnNlbGVjdG9ycyA9IGluZGljYXRvcnMuYXJyYXkuZmlsdGVyKG9iamVjdCA9PiBvYmplY3QuZ2VuZXJhdGUpLm1hcChvYmplY3QgPT4gbmV3IFNlbGVjdG9yKG9iamVjdCkpXHJcblxyXG5cdFx0dGhpcy5idXR0b25zID0gZDMuc2VsZWN0KCcjdGltZWxpbmUtY29udGFpbmVyJykuc2VsZWN0QWxsKCdzcGFuJylcclxuXHRcdFx0LmRhdGEoWzIwMTQsIDIwMTUsIDIwMTYsIDIwMTddKVxyXG5cclxuXHRcdHRoaXMuaW5pdGlhbGl6YXRpb24oKTtcclxuXHR9XHJcblx0aW5pdGlhbGl6YXRpb24oKSB7XHJcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0dGhpcy5yZWRyYXdNYXBFbGVtZW50cygpO1xyXG5cdFx0XHR0aGlzLnJlZHJhd0NoYXJ0RWxlbWVudHMoKTtcclxuXHRcdFx0dGhpcy5wYXR0ZXJuLnNlbGVjdCgnbGluZScpLnRyYW5zaXRpb24oKS5kdXJhdGlvbigxNTAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxyXG5cdFx0XHRcdC5zdHlsZSgnb3BhY2l0eScsIDEpXHJcblxyXG5cdFx0fSwgMTUwMClcclxuXHR9XHJcblx0cmVkcmF3TWFwRWxlbWVudHMoKSB7XHJcblx0XHR0aGlzLnJvdXRlcy50cmFuc2l0aW9uKCkuZHVyYXRpb24oNjAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxyXG5cdFx0XHQuc3R5bGUoJ3N0cm9rZS13aWR0aCcsIGRhdGEuYXR0cmlidXRlcy56b29tICogMSlcclxuXHRcdHRoaXMuYnV0dG9ucy50ZXh0KChkLCBpKSA9PiB7XHJcblx0XHRcdHJldHVybiBpbmRpY2F0b3JzW2dsb2JhbC5rZXldLmZvcm1hdF9zaG9ydChkYXRhLnByb3BlcnRpZXNbZ2xvYmFsLmtleV0ubWVkaWFuW2ldKTtcclxuXHRcdH0pXHJcblx0XHR0aGlzLmNpcmNsZXNfZmlsbC8vLnRyYW5zaXRpb24oKS5kdXJhdGlvbig2MDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHRcdC5hdHRyKCdyJywgZCA9PiBkLmF0dHJpYnV0ZXMuY2lyY2xlX3JhZGl1cylcclxuXHRcdFx0LnN0eWxlKCdmaWxsJywgZCA9PiB7XHJcblx0XHRcdFx0bGV0IGMgPSBkMy5jb2xvcihkLmF0dHJpYnV0ZXMuY2lyY2xlX2NvbG9yKTtcclxuXHRcdFx0XHRjLm9wYWNpdHkgPSBkLmF0dHJpYnV0ZXMuY2lyY2xlX29wYWNpdHk7XHJcblx0XHRcdFx0cmV0dXJuIGM7XHJcblx0XHRcdH0pXHJcblx0XHRcdC5zdHlsZSgnc3Ryb2tlJywgZCA9PiBkLmF0dHJpYnV0ZXMuY2lyY2xlX2NvbG9yKVxyXG5cdFx0XHQuc3R5bGUoJ3N0cm9rZS13aWR0aCcsIGQgPT4gMS4yNSAqIGQuYXR0cmlidXRlcy5jaXJjbGVfem9vbSArICdweCcpO1xyXG5cclxuXHRcdHRoaXMuY2lyY2xlc19jcm93bi8vLnRyYW5zaXRpb24oKS5kdXJhdGlvbig2MDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHRcdC5hdHRyKCdyJywgZCA9PiBkLmF0dHJpYnV0ZXMuY2lyY2xlX3JhZGl1cyArIDIuNSAqIGQuYXR0cmlidXRlcy5jaXJjbGVfem9vbSlcclxuXHRcdFx0LnN0eWxlKCdzdHJva2UnLCBkID0+IGQuYXR0cmlidXRlcy5jaXJjbGVfY29sb3IpXHJcblx0XHRcdC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgZCA9PiAxLjI1ICogZC5hdHRyaWJ1dGVzLmNpcmNsZV96b29tICsgJ3B4Jyk7XHJcblxyXG5cdFx0dGhpcy5jaXJjbGVzX2hhbG8udHJhbnNpdGlvbigpLmR1cmF0aW9uKDYwMCkuZWFzZShkMy5lYXNlUXVhZE91dClcclxuXHRcdFx0LmF0dHIoJ3InLCBkID0+IHtcclxuXHRcdFx0XHRsZXQgeCA9IGQucHJvcGVydGllcy50cmFuc2l0ID8gNiA6IDM7XHJcblx0XHRcdFx0cmV0dXJuIGQuYXR0cmlidXRlcy5jaXJjbGVfcmFkaXVzICsgeCAqIGQuYXR0cmlidXRlcy5jaXJjbGVfem9vbTtcclxuXHRcdFx0fSlcclxuXHR9XHJcblx0cmVkcmF3Q2hhcnRFbGVtZW50cygpIHtcclxuXHRcdHRoaXMuY2hhcnRfZG90c1xyXG5cdFx0XHQuYXR0cignY3gnLCBkID0+IGQuYXR0cmlidXRlcy5kb3RfeClcclxuXHRcdFx0LmF0dHIoJ2N5JywgZCA9PiBkLmF0dHJpYnV0ZXMuZG90X3kpXHJcblx0XHRcdC5zdHlsZSgnZmlsbCcsIGQgPT4gZC5hdHRyaWJ1dGVzLmNpcmNsZV9jb2xvcilcclxuXHRcdFx0LnN0eWxlKCdyJywgZCA9PiBkLmF0dHJpYnV0ZXMudmlzaWJsZSA/IDEgOiAwKVxyXG5cclxuXHRcdHRoaXMuY2hhcnRfY3Jvd25zXHJcblx0XHRcdC5hdHRyKCdjeCcsIGQgPT4gZC5hdHRyaWJ1dGVzLmRvdF94KVxyXG5cdFx0XHQuYXR0cignY3knLCBkID0+IGQuYXR0cmlidXRlcy5kb3RfeSlcclxuXHRcdFx0LnN0eWxlKCdmaWxsJywgZCA9PiBjb2xvci53aGl0ZSlcclxuXHRcdFx0LnN0eWxlKCdzdHJva2UnLCBkID0+IGQucHJvcGVydGllcy50cmFuc2l0ID8gZC5hdHRyaWJ1dGVzLmNpcmNsZV9jb2xvciA6IG51bGwpXHJcblx0XHRcdC5zdHlsZSgncicsIGQgPT4gZC5hdHRyaWJ1dGVzLnZpc2libGUgPyAyIDogMClcclxuXHJcblx0XHR0aGlzLmNoYXJ0X2xpbmVfeC50cmFuc2l0aW9uKCkuZHVyYXRpb24oMzAwKS5lYXNlKGQzLmVhc2VRdWFkT3V0KVxyXG5cdFx0XHQuYXR0cigneTEnLCBkYXRhLmF0dHJpYnV0ZXMuY2hhcnRfYXhpc195ID8gLTEyNy41IDogMC41KVxyXG5cdFx0XHQuYXR0cigneTInLCBkYXRhLmF0dHJpYnV0ZXMuY2hhcnRfYXhpc195ID8gLTEyNy41IDogMC41KVxyXG5cclxuXHRcdHRoaXMuY2hhcnRfbGluZV95LnRyYW5zaXRpb24oKS5kdXJhdGlvbigzMDApLmVhc2UoZDMuZWFzZVF1YWRPdXQpXHJcblx0XHRcdC5hdHRyKCd4MScsIGRhdGEuYXR0cmlidXRlcy5jaGFydF9heGlzX3ggPyAxMjguNSA6IDAuNSlcclxuXHRcdFx0LmF0dHIoJ3gyJywgZGF0YS5hdHRyaWJ1dGVzLmNoYXJ0X2F4aXNfeCA/IDEyOC41IDogMC41KVxyXG5cdH1cclxuXHRjaGFydEZpbHRlcigpIHtcclxuXHRcdHRoaXMuY2hhcnRfZG90cy5jbGFzc2VkKCdmaWx0cmVkJywgZCA9PiBkLmF0dHJpYnV0ZXMuZmlsdHJlZClcclxuXHRcdHRoaXMuY2hhcnRfY3Jvd25zLmNsYXNzZWQoJ2ZpbHRyZWQnLCBkID0+IGQuYXR0cmlidXRlcy5maWx0cmVkKVxyXG5cclxuXHRcdHRoaXMuY2hhcnRfYXJlYVxyXG5cdFx0XHQuYXR0cigneCcsIGRhdGEuYXR0cmlidXRlcy5jaGFydF94ID09PSBmYWxzZSA/IDAgOiBkYXRhLmF0dHJpYnV0ZXMuY2hhcnRfeClcclxuXHRcdFx0LmF0dHIoJ3knLCBkYXRhLmF0dHJpYnV0ZXMuY2hhcnRfeSA9PT0gZmFsc2UgPyAtMjU2IDogZGF0YS5hdHRyaWJ1dGVzLmNoYXJ0X3kpXHJcblx0XHRcdC5hdHRyKCd3aWR0aCcsIGRhdGEuYXR0cmlidXRlcy5jaGFydF94X2FjdGl2ZSA/IDY0IDogMjU2KVxyXG5cdFx0XHQuYXR0cignaGVpZ2h0JywgZGF0YS5hdHRyaWJ1dGVzLmNoYXJ0X3lfYWN0aXZlID8gNjQgOiAyNTYpXHJcblx0XHRcdC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKDAsICR7ZGF0YS5hdHRyaWJ1dGVzLmNoYXJ0X3lfYWN0aXZlID8gMCA6IC0xOTJ9KWApXHJcblx0XHRcdC5hdHRyKCdyeCcsIGRhdGEuYXR0cmlidXRlcy5jaGFydF94X2FjdGl2ZSAmJiBkYXRhLmF0dHJpYnV0ZXMuY2hhcnRfeV9hY3RpdmUgPyA4IDogMClcclxuXHRcdFx0LmF0dHIoJ3J5JywgZGF0YS5hdHRyaWJ1dGVzLmNoYXJ0X3hfYWN0aXZlICYmIGRhdGEuYXR0cmlidXRlcy5jaGFydF95X2FjdGl2ZSA/IDggOiAwKVxyXG5cclxuXHRcdHRoaXMuY2hhcnRfbGFiZWxzXHJcblx0XHRcdC5zdHlsZSgndHJhbnNmb3JtJywgZCA9PiBgdHJhbnNsYXRlJHtkLnRvVXBwZXJDYXNlKCl9KCR7ZGF0YS5hdHRyaWJ1dGVzWydjaGFydF8nICsgZF0gKyAzMn1weClgKVxyXG5cdFx0XHQuc3R5bGUoJ29wYWNpdHknLCBkID0+IGRhdGEuYXR0cmlidXRlc1snY2hhcnRfJyArIGQgKyAnX2FjdGl2ZSddID8gMSA6IDApXHJcblx0XHRcdC5zZWxlY3RBbGwoJ2cnKVxyXG5cdFx0XHQuc3R5bGUoJ3RyYW5zZm9ybScsIGZ1bmN0aW9uKGQsIGkpIHtcclxuXHRcdFx0XHRsZXQgdHlwZSA9IHRoaXMucGFyZW50Tm9kZS5kYXRhc2V0LmF4aXNcclxuXHRcdFx0XHRsZXQgcyA9IGB0cmFuc2xhdGUke3R5cGUudG9VcHBlckNhc2UoKX0oJHtpID8gMzIgOiAtMzJ9cHgpYFxyXG5cdFx0XHRcdHJldHVybiBzO1xyXG5cdFx0XHR9KVxyXG5cclxuXHRcdHRoaXMuY2hhcnRfbGFiZWxzLnNlbGVjdEFsbCgndGV4dCcpXHJcblx0XHRcdC50ZXh0KGZ1bmN0aW9uIChkKSB7XHJcblx0XHRcdFx0bGV0IHR5cGUgPSB0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZS5kYXRhc2V0LmF4aXM7XHJcblx0XHRcdFx0cmV0dXJuIGRhdGEuYXR0cmlidXRlc1snY2hhcnRfJyArIHR5cGUgKyAnX2Zvcm1hdCddKFxyXG5cdFx0XHRcdFx0ZGF0YS5hdHRyaWJ1dGVzWydjaGFydF8nICsgdHlwZSArICdfdmFsdWUnXVtkXVxyXG5cdFx0XHRcdCk7XHJcblx0XHRcdH0pXHJcblx0XHRcdC5zdHlsZSgndHJhbnNmb3JtJywgZnVuY3Rpb24oZCwgaSkge1xyXG5cdFx0XHRcdGxldCB0eXBlID0gdGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUuZGF0YXNldC5heGlzO1xyXG5cdFx0XHRcdGxldCBkaXIgPSB0eXBlID09ICd4JyA/IDEgOiAtMVxyXG5cdFx0XHRcdGlmKGQgPT0gJ21heCcgJiYgIWRhdGEuYXR0cmlidXRlc1snY2hhcnRfJyArIHR5cGUgKyAnX2FjdGl2ZSddKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gYHRyYW5zbGF0ZSR7dHlwZS50b1VwcGVyQ2FzZSgpfSgkezE5MiAqIGRpcn1weClgO1xyXG5cdFx0XHRcdH1cdGVsc2Uge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGB0cmFuc2xhdGUke3R5cGUudG9VcHBlckNhc2UoKX0oMClgO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSlcclxuXHJcblx0XHR0aGlzLmNoYXJ0X2xhYmVscy5zZWxlY3RBbGwoJ2xpbmUnKVxyXG5cdFx0XHQuc3R5bGUoJ3RyYW5zZm9ybScsIGZ1bmN0aW9uKGQsIGkpIHtcclxuXHRcdFx0XHRsZXQgdHlwZSA9IHRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlLmRhdGFzZXQuYXhpcztcclxuXHRcdFx0XHRsZXQgZGlyID0gdHlwZSA9PSAneCcgPyAxIDogLTFcclxuXHRcdFx0XHRpZihkID09ICdtYXgnICYmICFkYXRhLmF0dHJpYnV0ZXNbJ2NoYXJ0XycgKyB0eXBlICsgJ19hY3RpdmUnXSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGB0cmFuc2xhdGUke3R5cGUudG9VcHBlckNhc2UoKX0oJHsxOTIgKiBkaXJ9cHgpYDtcclxuXHRcdFx0XHR9XHRlbHNlIHtcclxuXHRcdFx0XHRcdHJldHVybiBgdHJhbnNsYXRlJHt0eXBlLnRvVXBwZXJDYXNlKCl9KDApYDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pXHJcblxyXG5cdFx0dGhpcy5jaXJjbGVzLmNsYXNzZWQoJ2ZpbHRyZWQnLCBkID0+IGQuYXR0cmlidXRlcy5maWx0cmVkKVxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IHtNYXAsIEVsZW1lbnRzfTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvZWxlbWVudHMuanNcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///3\n");

/***/ }),
/* 4 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__global__ = __webpack_require__(0);\n\r\nlet data, global;\r\n\r\nclass Controller {\r\n\tconstructor(...incoming) {\r\n\t\t[data, global] = incoming;\r\n\t\tthis.scale = {\r\n\t\t\t// 'color': d3.scaleQuantile().domain(data.features.map(feature => feature.properties[global.key][global.i])).range([color.hot, color.middle, color.cold]),\r\n\t\t\t'square': d3.scaleSqrt().range([0, 1]).domain([0, 75]),\r\n\t\t\t'zoom': (value) => { return value / Math.pow(2, global.z - 10.5) },\r\n\t\t\t'opacity': d3.scaleLinear().domain([12, 14, 16]).range([1, 0.5, 0.1]).clamp(true),\r\n\t\t\t'size': d3.scaleLinear().domain([10.5, 12.5, 16.5]).range([2.5, 8, 32]).clamp(true),\r\n\t\t\t'x': d3.scaleLinear().range([0, 256]),\r\n\t\t\t'y': d3.scaleLinear().range([0, -256])\r\n\t\t}\r\n\t\tthis.initialization();\r\n\t}\r\n\tinitialization() {\r\n\t\tdata.features.forEach(feature => {\r\n\t\t\tfeature.attributes.dot_x = 0;\r\n\t\t\tfeature.attributes.dot_y = 0;\r\n\t\t})\r\n\t\tthis.evaluateColorScales();\r\n\t\tthis.evaluateMapElements();\r\n\t\tthis.evaluateChartElements();\r\n\t}\r\n\tevaluateColorScales(key) {\r\n\t\tif(key) {\r\n\t\t\t// data.attributes.color[key] = method(key);\r\n\t\t}\telse {\r\n\t\t\t// data.attributes.color = new Object();\r\n\t\t\t__WEBPACK_IMPORTED_MODULE_0__global__[\"b\" /* indicators */].array.filter(element => element.generate).forEach((element, i) => {\r\n\t\t\t\t__WEBPACK_IMPORTED_MODULE_0__global__[\"b\" /* indicators */][element.key].color = method(element.key);\r\n\t\t\t\t// data.attributes.color[element.key] = method(element.key);\r\n\t\t\t})\r\n\t\t}\r\n\t\tfunction method(key) {\r\n\t\t\tlet array = data.features.map(feature => feature.properties[key][global.i]).filter(x => x !== null);\r\n\t\t\tarray.sort((a, b) => a - b);\r\n\t\t\tlet steps = d3.range(0, 1, 1 / 63).concat([1]);\r\n\t\t\tlet domain = steps.map(step => d3.quantile(array, step));\r\n\t\t\tlet first_half = 1;\r\n\t\t\tlet second_half = 1;\r\n\t\t\tfor(let i = 1; i < domain.length; i++) {\r\n\t\t\t\tif(domain[i - 1] != domain[i]) {\r\n\t\t\t\t\ti < domain.length / 2 ? first_half++ : second_half++\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet range = getRange([__WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].cold, __WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].middle, __WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].hot].reverse());\r\n\t\t\treturn {\r\n\t\t\t\t'scale': d3.scaleLinear().domain(domain).range(range),\r\n\t\t\t\t'domain': domain,\r\n\t\t\t\t'range': range,\r\n\t\t\t\t'median': d3.median(array),\r\n\t\t\t\t'size': d3.scaleLinear().domain([0, data.properties[key].max[global.i]])\r\n\t\t\t};\r\n\t\t\tfunction getRange(colors = [__WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].cold, __WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].middle, __WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].hot].reverse()) {\r\n\t\t\t\tlet length = domain.length / (colors.length - 1)\r\n\t\t\t\tlet range = new Array();\r\n\t\t\t\tlet answer = new Array();\r\n\t\t\t\tlet c = 0;\r\n\t\t\t\tfor(let i = 0; i < colors.length - 1; i++) {\r\n\t\t\t\t\trange = range.concat(cycle(i, i + 1));\r\n\t\t\t\t}\r\n\t\t\t\tfor(let i = 0; i < domain.length; i++) {\r\n\t\t\t\t\tanswer.push(range[c]);\r\n\t\t\t\t\tif(domain[i] != domain[i + 1]) c++;\r\n\t\t\t\t}\r\n\t\t\t\treturn answer;\r\n\t\t\t\tfunction cycle(start, end) {\r\n\t\t\t\t\tlet c = 1;\r\n\t\t\t\t\tfor(let i = start * length + 1; i < end * length; i++) {\r\n\t\t\t\t\t\tif(domain[i] != domain[i + 1]) c++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn chroma.bezier([colors[start], colors[end]]).scale().colors(c);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tevaluateMapElements() {\r\n\t\tdata.features.forEach(feature => {\r\n\t\t\tlet b = feature.properties.year[global.i] !== null;\r\n\t\t\tfeature.attributes.visible = b;\r\n\t\t\tfeature.attributes.circle_size = b ? this.scale.square(feature.properties.sum_all[global.i]) : 0\r\n\t\t\tfeature.attributes.circle_color = b ? __WEBPACK_IMPORTED_MODULE_0__global__[\"b\" /* indicators */][global.key].color.scale(feature.properties[global.key][global.i]) : __WEBPACK_IMPORTED_MODULE_0__global__[\"a\" /* color */].grey\r\n\t\t\tfeature.attributes.circle_indicators = new Object();\r\n\t\t\t__WEBPACK_IMPORTED_MODULE_0__global__[\"b\" /* indicators */].array.filter(object => object.generate).forEach(indicator => {\r\n\t\t\t\tfeature.attributes.circle_indicators[indicator.key] = {\r\n\t\t\t\t\t'value': feature.properties[indicator.key][global.i]\r\n\t\t\t\t}\r\n\t\t\t\tif(indicator.key != 'mean_all_interval') {\r\n\t\t\t\t\tfeature.attributes.circle_indicators[indicator.key].n = indicator.color.domain.findIndex(n => n >= feature.properties[indicator.key][global.i]);\r\n\t\t\t\t}\telse {\r\n\t\t\t\t\tfeature.attributes.circle_indicators[indicator.key].n = [...indicator.color.domain].reverse().findIndex(n => n <= feature.properties[indicator.key][global.i]);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t\tthis.modifyMapElements();\r\n\t}\r\n\tmodifyMapElements() {\r\n\t\tdata.attributes.zoom = this.scale.zoom(1);\r\n\t\tdata.features.forEach(feature => {\r\n\t\t\tlet b = feature.attributes.visible;\r\n\t\t\tfeature.attributes.circle_radius = b ? this.scale.zoom(feature.attributes.circle_size) * this.scale.size(global.z) : 0\r\n\t\t\tfeature.attributes.circle_zoom = b ? data.attributes.zoom : 0\r\n\t\t\tfeature.attributes.circle_opacity = this.scale.opacity(global.z);\r\n\t\t\t// console.log(feature.attributes.circle_zoom);\r\n\t\t})\r\n\t}\r\n\tevaluateChartElements(type) {\r\n\t\tif(type === undefined) {\r\n\t\t\ttype = 'x';\r\n\t\t\tthis.evaluateChartElements('y');\r\n\t\t}\r\n\t\tthis.scale[type].domain([data.properties[global[type]].min_abs, data.properties[global[type]].max_abs]);\r\n\r\n\t\tdata.attributes['chart_axis_' + type] = [\r\n\t\t\t'balance_all', 'balance_workday', 'balance_weekend',\r\n\t\t\t'subscribers_casual_all_ratio', 'subscribers_casual_workday_ratio', 'subscribers_casual_weekend_ratio',\r\n\t\t\t'workday_weekend_ratio'\r\n\t\t].some(key => key == global[type]);\r\n\t\tdata.attributes['chart_' + type + '_format'] = __WEBPACK_IMPORTED_MODULE_0__global__[\"b\" /* indicators */][global[type]].format_short;\r\n\t\tdata.features.forEach(feature => {\r\n\t\t\tlet b = feature.attributes.visible;\r\n\t\t\tfeature.attributes['dot_' + type] = b ? this.scale[type](feature.properties[global[type]][global.i]) : feature.attributes['dot_' + type]\r\n\t\t})\r\n\t}\r\n\tmodifyChartElements(args) {\r\n\t\tlet size = 32;\r\n\t\tlet checks = new Array();\r\n\t\tdata.attributes.chart_x = 0;\r\n\t\tdata.attributes.chart_y = size * -2;\r\n\t\tdata.attributes.chart_x_active = false;\r\n\t\tdata.attributes.chart_y_active = false;\r\n\t\t// data.attributes.chart_x_format = false;\r\n\t\tdata.attributes.chart_x_value = {\r\n\t\t\t'min': this.scale.x.invert(0),\r\n\t\t\t'max': this.scale.x.invert(256)\r\n\t\t};\r\n\t\tdata.attributes.chart_y_value = {\r\n\t\t\t'min': this.scale.y.invert(0),\r\n\t\t\t'max': this.scale.y.invert(-256)\r\n\t\t};\r\n\t\tObject.keys(args).forEach(type => {\r\n\t\t\tlet val = args[type];\r\n\t\t\tlet min = Math.min(256 - size * 2, Math.max(0, val - size));\r\n\t\t\tlet max = Math.max(size * 2, Math.min(256, val + size));\r\n\t\t\tif(type == 'y') {\r\n\t\t\t\tmin -= 256;\r\n\t\t\t\tmax -= 256;\r\n\t\t\t}\r\n\t\t\tdata.attributes['chart_' + type] = min;\r\n\t\t\tdata.attributes['chart_' + type + '_active'] = true;\r\n\t\t\tif(type == 'y') {\r\n\t\t\t\t[min, max] = [max, min];\r\n\t\t\t}\r\n\t\t\tdata.attributes['chart_' + type + '_value'].min = this.scale[type].invert(min);\r\n\t\t\tdata.attributes['chart_' + type + '_value'].max = this.scale[type].invert(max);\r\n\t\t\tchecks.push(\r\n\t\t\t\tfeature => feature.attributes.visible && feature.properties[global[type]][global.i] >= this.scale[type].invert(min),\r\n\t\t\t\tfeature => feature.attributes.visible && feature.properties[global[type]][global.i] <= this.scale[type].invert(max)\r\n\t\t\t)\r\n\t\t})\r\n\t\treturn this.filter(\r\n\t\t\tfeature => checks.every(check => check(feature))\r\n\t\t);\r\n\t}\r\n\tfilter(method) {\r\n\t\treturn data.features.filter(feature => {\r\n\t\t\tfeature.attributes.filtred = !method(feature);\r\n\t\t\treturn !feature.attributes.filtred;\r\n\t\t})\r\n\t}\r\n\tunfilter() {\r\n\t\treturn data.features.filter(feature => {\r\n\t\t\tfeature.attributes.filtred = false;\r\n\t\t\treturn feature.attributes.visible;\r\n\t\t})\r\n\t}\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"a\"] = (Controller);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9jb250cm9sbGVyLmpzPzQ3NjYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5kaWNhdG9ycywgY29sb3IgfSBmcm9tICcuL2dsb2JhbCc7XHJcbmxldCBkYXRhLCBnbG9iYWw7XHJcblxyXG5jbGFzcyBDb250cm9sbGVyIHtcclxuXHRjb25zdHJ1Y3RvciguLi5pbmNvbWluZykge1xyXG5cdFx0W2RhdGEsIGdsb2JhbF0gPSBpbmNvbWluZztcclxuXHRcdHRoaXMuc2NhbGUgPSB7XHJcblx0XHRcdC8vICdjb2xvcic6IGQzLnNjYWxlUXVhbnRpbGUoKS5kb21haW4oZGF0YS5mZWF0dXJlcy5tYXAoZmVhdHVyZSA9PiBmZWF0dXJlLnByb3BlcnRpZXNbZ2xvYmFsLmtleV1bZ2xvYmFsLmldKSkucmFuZ2UoW2NvbG9yLmhvdCwgY29sb3IubWlkZGxlLCBjb2xvci5jb2xkXSksXHJcblx0XHRcdCdzcXVhcmUnOiBkMy5zY2FsZVNxcnQoKS5yYW5nZShbMCwgMV0pLmRvbWFpbihbMCwgNzVdKSxcclxuXHRcdFx0J3pvb20nOiAodmFsdWUpID0+IHsgcmV0dXJuIHZhbHVlIC8gTWF0aC5wb3coMiwgZ2xvYmFsLnogLSAxMC41KSB9LFxyXG5cdFx0XHQnb3BhY2l0eSc6IGQzLnNjYWxlTGluZWFyKCkuZG9tYWluKFsxMiwgMTQsIDE2XSkucmFuZ2UoWzEsIDAuNSwgMC4xXSkuY2xhbXAodHJ1ZSksXHJcblx0XHRcdCdzaXplJzogZDMuc2NhbGVMaW5lYXIoKS5kb21haW4oWzEwLjUsIDEyLjUsIDE2LjVdKS5yYW5nZShbMi41LCA4LCAzMl0pLmNsYW1wKHRydWUpLFxyXG5cdFx0XHQneCc6IGQzLnNjYWxlTGluZWFyKCkucmFuZ2UoWzAsIDI1Nl0pLFxyXG5cdFx0XHQneSc6IGQzLnNjYWxlTGluZWFyKCkucmFuZ2UoWzAsIC0yNTZdKVxyXG5cdFx0fVxyXG5cdFx0dGhpcy5pbml0aWFsaXphdGlvbigpO1xyXG5cdH1cclxuXHRpbml0aWFsaXphdGlvbigpIHtcclxuXHRcdGRhdGEuZmVhdHVyZXMuZm9yRWFjaChmZWF0dXJlID0+IHtcclxuXHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLmRvdF94ID0gMDtcclxuXHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLmRvdF95ID0gMDtcclxuXHRcdH0pXHJcblx0XHR0aGlzLmV2YWx1YXRlQ29sb3JTY2FsZXMoKTtcclxuXHRcdHRoaXMuZXZhbHVhdGVNYXBFbGVtZW50cygpO1xyXG5cdFx0dGhpcy5ldmFsdWF0ZUNoYXJ0RWxlbWVudHMoKTtcclxuXHR9XHJcblx0ZXZhbHVhdGVDb2xvclNjYWxlcyhrZXkpIHtcclxuXHRcdGlmKGtleSkge1xyXG5cdFx0XHQvLyBkYXRhLmF0dHJpYnV0ZXMuY29sb3Jba2V5XSA9IG1ldGhvZChrZXkpO1xyXG5cdFx0fVx0ZWxzZSB7XHJcblx0XHRcdC8vIGRhdGEuYXR0cmlidXRlcy5jb2xvciA9IG5ldyBPYmplY3QoKTtcclxuXHRcdFx0aW5kaWNhdG9ycy5hcnJheS5maWx0ZXIoZWxlbWVudCA9PiBlbGVtZW50LmdlbmVyYXRlKS5mb3JFYWNoKChlbGVtZW50LCBpKSA9PiB7XHJcblx0XHRcdFx0aW5kaWNhdG9yc1tlbGVtZW50LmtleV0uY29sb3IgPSBtZXRob2QoZWxlbWVudC5rZXkpO1xyXG5cdFx0XHRcdC8vIGRhdGEuYXR0cmlidXRlcy5jb2xvcltlbGVtZW50LmtleV0gPSBtZXRob2QoZWxlbWVudC5rZXkpO1xyXG5cdFx0XHR9KVxyXG5cdFx0fVxyXG5cdFx0ZnVuY3Rpb24gbWV0aG9kKGtleSkge1xyXG5cdFx0XHRsZXQgYXJyYXkgPSBkYXRhLmZlYXR1cmVzLm1hcChmZWF0dXJlID0+IGZlYXR1cmUucHJvcGVydGllc1trZXldW2dsb2JhbC5pXSkuZmlsdGVyKHggPT4geCAhPT0gbnVsbCk7XHJcblx0XHRcdGFycmF5LnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcclxuXHRcdFx0bGV0IHN0ZXBzID0gZDMucmFuZ2UoMCwgMSwgMSAvIDYzKS5jb25jYXQoWzFdKTtcclxuXHRcdFx0bGV0IGRvbWFpbiA9IHN0ZXBzLm1hcChzdGVwID0+IGQzLnF1YW50aWxlKGFycmF5LCBzdGVwKSk7XHJcblx0XHRcdGxldCBmaXJzdF9oYWxmID0gMTtcclxuXHRcdFx0bGV0IHNlY29uZF9oYWxmID0gMTtcclxuXHRcdFx0Zm9yKGxldCBpID0gMTsgaSA8IGRvbWFpbi5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGlmKGRvbWFpbltpIC0gMV0gIT0gZG9tYWluW2ldKSB7XHJcblx0XHRcdFx0XHRpIDwgZG9tYWluLmxlbmd0aCAvIDIgPyBmaXJzdF9oYWxmKysgOiBzZWNvbmRfaGFsZisrXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGxldCByYW5nZSA9IGdldFJhbmdlKFtjb2xvci5jb2xkLCBjb2xvci5taWRkbGUsIGNvbG9yLmhvdF0ucmV2ZXJzZSgpKTtcclxuXHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHQnc2NhbGUnOiBkMy5zY2FsZUxpbmVhcigpLmRvbWFpbihkb21haW4pLnJhbmdlKHJhbmdlKSxcclxuXHRcdFx0XHQnZG9tYWluJzogZG9tYWluLFxyXG5cdFx0XHRcdCdyYW5nZSc6IHJhbmdlLFxyXG5cdFx0XHRcdCdtZWRpYW4nOiBkMy5tZWRpYW4oYXJyYXkpLFxyXG5cdFx0XHRcdCdzaXplJzogZDMuc2NhbGVMaW5lYXIoKS5kb21haW4oWzAsIGRhdGEucHJvcGVydGllc1trZXldLm1heFtnbG9iYWwuaV1dKVxyXG5cdFx0XHR9O1xyXG5cdFx0XHRmdW5jdGlvbiBnZXRSYW5nZShjb2xvcnMgPSBbY29sb3IuY29sZCwgY29sb3IubWlkZGxlLCBjb2xvci5ob3RdLnJldmVyc2UoKSkge1xyXG5cdFx0XHRcdGxldCBsZW5ndGggPSBkb21haW4ubGVuZ3RoIC8gKGNvbG9ycy5sZW5ndGggLSAxKVxyXG5cdFx0XHRcdGxldCByYW5nZSA9IG5ldyBBcnJheSgpO1xyXG5cdFx0XHRcdGxldCBhbnN3ZXIgPSBuZXcgQXJyYXkoKTtcclxuXHRcdFx0XHRsZXQgYyA9IDA7XHJcblx0XHRcdFx0Zm9yKGxldCBpID0gMDsgaSA8IGNvbG9ycy5sZW5ndGggLSAxOyBpKyspIHtcclxuXHRcdFx0XHRcdHJhbmdlID0gcmFuZ2UuY29uY2F0KGN5Y2xlKGksIGkgKyAxKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGZvcihsZXQgaSA9IDA7IGkgPCBkb21haW4ubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRcdGFuc3dlci5wdXNoKHJhbmdlW2NdKTtcclxuXHRcdFx0XHRcdGlmKGRvbWFpbltpXSAhPSBkb21haW5baSArIDFdKSBjKys7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBhbnN3ZXI7XHJcblx0XHRcdFx0ZnVuY3Rpb24gY3ljbGUoc3RhcnQsIGVuZCkge1xyXG5cdFx0XHRcdFx0bGV0IGMgPSAxO1xyXG5cdFx0XHRcdFx0Zm9yKGxldCBpID0gc3RhcnQgKiBsZW5ndGggKyAxOyBpIDwgZW5kICogbGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRcdFx0aWYoZG9tYWluW2ldICE9IGRvbWFpbltpICsgMV0pIGMrKztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJldHVybiBjaHJvbWEuYmV6aWVyKFtjb2xvcnNbc3RhcnRdLCBjb2xvcnNbZW5kXV0pLnNjYWxlKCkuY29sb3JzKGMpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRldmFsdWF0ZU1hcEVsZW1lbnRzKCkge1xyXG5cdFx0ZGF0YS5mZWF0dXJlcy5mb3JFYWNoKGZlYXR1cmUgPT4ge1xyXG5cdFx0XHRsZXQgYiA9IGZlYXR1cmUucHJvcGVydGllcy55ZWFyW2dsb2JhbC5pXSAhPT0gbnVsbDtcclxuXHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLnZpc2libGUgPSBiO1xyXG5cdFx0XHRmZWF0dXJlLmF0dHJpYnV0ZXMuY2lyY2xlX3NpemUgPSBiID8gdGhpcy5zY2FsZS5zcXVhcmUoZmVhdHVyZS5wcm9wZXJ0aWVzLnN1bV9hbGxbZ2xvYmFsLmldKSA6IDBcclxuXHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLmNpcmNsZV9jb2xvciA9IGIgPyBpbmRpY2F0b3JzW2dsb2JhbC5rZXldLmNvbG9yLnNjYWxlKGZlYXR1cmUucHJvcGVydGllc1tnbG9iYWwua2V5XVtnbG9iYWwuaV0pIDogY29sb3IuZ3JleVxyXG5cdFx0XHRmZWF0dXJlLmF0dHJpYnV0ZXMuY2lyY2xlX2luZGljYXRvcnMgPSBuZXcgT2JqZWN0KCk7XHJcblx0XHRcdGluZGljYXRvcnMuYXJyYXkuZmlsdGVyKG9iamVjdCA9PiBvYmplY3QuZ2VuZXJhdGUpLmZvckVhY2goaW5kaWNhdG9yID0+IHtcclxuXHRcdFx0XHRmZWF0dXJlLmF0dHJpYnV0ZXMuY2lyY2xlX2luZGljYXRvcnNbaW5kaWNhdG9yLmtleV0gPSB7XHJcblx0XHRcdFx0XHQndmFsdWUnOiBmZWF0dXJlLnByb3BlcnRpZXNbaW5kaWNhdG9yLmtleV1bZ2xvYmFsLmldXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGluZGljYXRvci5rZXkgIT0gJ21lYW5fYWxsX2ludGVydmFsJykge1xyXG5cdFx0XHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLmNpcmNsZV9pbmRpY2F0b3JzW2luZGljYXRvci5rZXldLm4gPSBpbmRpY2F0b3IuY29sb3IuZG9tYWluLmZpbmRJbmRleChuID0+IG4gPj0gZmVhdHVyZS5wcm9wZXJ0aWVzW2luZGljYXRvci5rZXldW2dsb2JhbC5pXSk7XHJcblx0XHRcdFx0fVx0ZWxzZSB7XHJcblx0XHRcdFx0XHRmZWF0dXJlLmF0dHJpYnV0ZXMuY2lyY2xlX2luZGljYXRvcnNbaW5kaWNhdG9yLmtleV0ubiA9IFsuLi5pbmRpY2F0b3IuY29sb3IuZG9tYWluXS5yZXZlcnNlKCkuZmluZEluZGV4KG4gPT4gbiA8PSBmZWF0dXJlLnByb3BlcnRpZXNbaW5kaWNhdG9yLmtleV1bZ2xvYmFsLmldKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pXHJcblx0XHR9KVxyXG5cdFx0dGhpcy5tb2RpZnlNYXBFbGVtZW50cygpO1xyXG5cdH1cclxuXHRtb2RpZnlNYXBFbGVtZW50cygpIHtcclxuXHRcdGRhdGEuYXR0cmlidXRlcy56b29tID0gdGhpcy5zY2FsZS56b29tKDEpO1xyXG5cdFx0ZGF0YS5mZWF0dXJlcy5mb3JFYWNoKGZlYXR1cmUgPT4ge1xyXG5cdFx0XHRsZXQgYiA9IGZlYXR1cmUuYXR0cmlidXRlcy52aXNpYmxlO1xyXG5cdFx0XHRmZWF0dXJlLmF0dHJpYnV0ZXMuY2lyY2xlX3JhZGl1cyA9IGIgPyB0aGlzLnNjYWxlLnpvb20oZmVhdHVyZS5hdHRyaWJ1dGVzLmNpcmNsZV9zaXplKSAqIHRoaXMuc2NhbGUuc2l6ZShnbG9iYWwueikgOiAwXHJcblx0XHRcdGZlYXR1cmUuYXR0cmlidXRlcy5jaXJjbGVfem9vbSA9IGIgPyBkYXRhLmF0dHJpYnV0ZXMuem9vbSA6IDBcclxuXHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLmNpcmNsZV9vcGFjaXR5ID0gdGhpcy5zY2FsZS5vcGFjaXR5KGdsb2JhbC56KTtcclxuXHRcdFx0Ly8gY29uc29sZS5sb2coZmVhdHVyZS5hdHRyaWJ1dGVzLmNpcmNsZV96b29tKTtcclxuXHRcdH0pXHJcblx0fVxyXG5cdGV2YWx1YXRlQ2hhcnRFbGVtZW50cyh0eXBlKSB7XHJcblx0XHRpZih0eXBlID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0dHlwZSA9ICd4JztcclxuXHRcdFx0dGhpcy5ldmFsdWF0ZUNoYXJ0RWxlbWVudHMoJ3knKTtcclxuXHRcdH1cclxuXHRcdHRoaXMuc2NhbGVbdHlwZV0uZG9tYWluKFtkYXRhLnByb3BlcnRpZXNbZ2xvYmFsW3R5cGVdXS5taW5fYWJzLCBkYXRhLnByb3BlcnRpZXNbZ2xvYmFsW3R5cGVdXS5tYXhfYWJzXSk7XHJcblxyXG5cdFx0ZGF0YS5hdHRyaWJ1dGVzWydjaGFydF9heGlzXycgKyB0eXBlXSA9IFtcclxuXHRcdFx0J2JhbGFuY2VfYWxsJywgJ2JhbGFuY2Vfd29ya2RheScsICdiYWxhbmNlX3dlZWtlbmQnLFxyXG5cdFx0XHQnc3Vic2NyaWJlcnNfY2FzdWFsX2FsbF9yYXRpbycsICdzdWJzY3JpYmVyc19jYXN1YWxfd29ya2RheV9yYXRpbycsICdzdWJzY3JpYmVyc19jYXN1YWxfd2Vla2VuZF9yYXRpbycsXHJcblx0XHRcdCd3b3JrZGF5X3dlZWtlbmRfcmF0aW8nXHJcblx0XHRdLnNvbWUoa2V5ID0+IGtleSA9PSBnbG9iYWxbdHlwZV0pO1xyXG5cdFx0ZGF0YS5hdHRyaWJ1dGVzWydjaGFydF8nICsgdHlwZSArICdfZm9ybWF0J10gPSBpbmRpY2F0b3JzW2dsb2JhbFt0eXBlXV0uZm9ybWF0X3Nob3J0O1xyXG5cdFx0ZGF0YS5mZWF0dXJlcy5mb3JFYWNoKGZlYXR1cmUgPT4ge1xyXG5cdFx0XHRsZXQgYiA9IGZlYXR1cmUuYXR0cmlidXRlcy52aXNpYmxlO1xyXG5cdFx0XHRmZWF0dXJlLmF0dHJpYnV0ZXNbJ2RvdF8nICsgdHlwZV0gPSBiID8gdGhpcy5zY2FsZVt0eXBlXShmZWF0dXJlLnByb3BlcnRpZXNbZ2xvYmFsW3R5cGVdXVtnbG9iYWwuaV0pIDogZmVhdHVyZS5hdHRyaWJ1dGVzWydkb3RfJyArIHR5cGVdXHJcblx0XHR9KVxyXG5cdH1cclxuXHRtb2RpZnlDaGFydEVsZW1lbnRzKGFyZ3MpIHtcclxuXHRcdGxldCBzaXplID0gMzI7XHJcblx0XHRsZXQgY2hlY2tzID0gbmV3IEFycmF5KCk7XHJcblx0XHRkYXRhLmF0dHJpYnV0ZXMuY2hhcnRfeCA9IDA7XHJcblx0XHRkYXRhLmF0dHJpYnV0ZXMuY2hhcnRfeSA9IHNpemUgKiAtMjtcclxuXHRcdGRhdGEuYXR0cmlidXRlcy5jaGFydF94X2FjdGl2ZSA9IGZhbHNlO1xyXG5cdFx0ZGF0YS5hdHRyaWJ1dGVzLmNoYXJ0X3lfYWN0aXZlID0gZmFsc2U7XHJcblx0XHQvLyBkYXRhLmF0dHJpYnV0ZXMuY2hhcnRfeF9mb3JtYXQgPSBmYWxzZTtcclxuXHRcdGRhdGEuYXR0cmlidXRlcy5jaGFydF94X3ZhbHVlID0ge1xyXG5cdFx0XHQnbWluJzogdGhpcy5zY2FsZS54LmludmVydCgwKSxcclxuXHRcdFx0J21heCc6IHRoaXMuc2NhbGUueC5pbnZlcnQoMjU2KVxyXG5cdFx0fTtcclxuXHRcdGRhdGEuYXR0cmlidXRlcy5jaGFydF95X3ZhbHVlID0ge1xyXG5cdFx0XHQnbWluJzogdGhpcy5zY2FsZS55LmludmVydCgwKSxcclxuXHRcdFx0J21heCc6IHRoaXMuc2NhbGUueS5pbnZlcnQoLTI1NilcclxuXHRcdH07XHJcblx0XHRPYmplY3Qua2V5cyhhcmdzKS5mb3JFYWNoKHR5cGUgPT4ge1xyXG5cdFx0XHRsZXQgdmFsID0gYXJnc1t0eXBlXTtcclxuXHRcdFx0bGV0IG1pbiA9IE1hdGgubWluKDI1NiAtIHNpemUgKiAyLCBNYXRoLm1heCgwLCB2YWwgLSBzaXplKSk7XHJcblx0XHRcdGxldCBtYXggPSBNYXRoLm1heChzaXplICogMiwgTWF0aC5taW4oMjU2LCB2YWwgKyBzaXplKSk7XHJcblx0XHRcdGlmKHR5cGUgPT0gJ3knKSB7XHJcblx0XHRcdFx0bWluIC09IDI1NjtcclxuXHRcdFx0XHRtYXggLT0gMjU2O1xyXG5cdFx0XHR9XHJcblx0XHRcdGRhdGEuYXR0cmlidXRlc1snY2hhcnRfJyArIHR5cGVdID0gbWluO1xyXG5cdFx0XHRkYXRhLmF0dHJpYnV0ZXNbJ2NoYXJ0XycgKyB0eXBlICsgJ19hY3RpdmUnXSA9IHRydWU7XHJcblx0XHRcdGlmKHR5cGUgPT0gJ3knKSB7XHJcblx0XHRcdFx0W21pbiwgbWF4XSA9IFttYXgsIG1pbl07XHJcblx0XHRcdH1cclxuXHRcdFx0ZGF0YS5hdHRyaWJ1dGVzWydjaGFydF8nICsgdHlwZSArICdfdmFsdWUnXS5taW4gPSB0aGlzLnNjYWxlW3R5cGVdLmludmVydChtaW4pO1xyXG5cdFx0XHRkYXRhLmF0dHJpYnV0ZXNbJ2NoYXJ0XycgKyB0eXBlICsgJ192YWx1ZSddLm1heCA9IHRoaXMuc2NhbGVbdHlwZV0uaW52ZXJ0KG1heCk7XHJcblx0XHRcdGNoZWNrcy5wdXNoKFxyXG5cdFx0XHRcdGZlYXR1cmUgPT4gZmVhdHVyZS5hdHRyaWJ1dGVzLnZpc2libGUgJiYgZmVhdHVyZS5wcm9wZXJ0aWVzW2dsb2JhbFt0eXBlXV1bZ2xvYmFsLmldID49IHRoaXMuc2NhbGVbdHlwZV0uaW52ZXJ0KG1pbiksXHJcblx0XHRcdFx0ZmVhdHVyZSA9PiBmZWF0dXJlLmF0dHJpYnV0ZXMudmlzaWJsZSAmJiBmZWF0dXJlLnByb3BlcnRpZXNbZ2xvYmFsW3R5cGVdXVtnbG9iYWwuaV0gPD0gdGhpcy5zY2FsZVt0eXBlXS5pbnZlcnQobWF4KVxyXG5cdFx0XHQpXHJcblx0XHR9KVxyXG5cdFx0cmV0dXJuIHRoaXMuZmlsdGVyKFxyXG5cdFx0XHRmZWF0dXJlID0+IGNoZWNrcy5ldmVyeShjaGVjayA9PiBjaGVjayhmZWF0dXJlKSlcclxuXHRcdCk7XHJcblx0fVxyXG5cdGZpbHRlcihtZXRob2QpIHtcclxuXHRcdHJldHVybiBkYXRhLmZlYXR1cmVzLmZpbHRlcihmZWF0dXJlID0+IHtcclxuXHRcdFx0ZmVhdHVyZS5hdHRyaWJ1dGVzLmZpbHRyZWQgPSAhbWV0aG9kKGZlYXR1cmUpO1xyXG5cdFx0XHRyZXR1cm4gIWZlYXR1cmUuYXR0cmlidXRlcy5maWx0cmVkO1xyXG5cdFx0fSlcclxuXHR9XHJcblx0dW5maWx0ZXIoKSB7XHJcblx0XHRyZXR1cm4gZGF0YS5mZWF0dXJlcy5maWx0ZXIoZmVhdHVyZSA9PiB7XHJcblx0XHRcdGZlYXR1cmUuYXR0cmlidXRlcy5maWx0cmVkID0gZmFsc2U7XHJcblx0XHRcdHJldHVybiBmZWF0dXJlLmF0dHJpYnV0ZXMudmlzaWJsZTtcclxuXHRcdH0pXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb250cm9sbGVyO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9jb250cm9sbGVyLmpzXG4vLyBtb2R1bGUgaWQgPSA0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///4\n");

/***/ })
/******/ ]);